{"version":3,"file":"socialPane.js","names":["UI","_interopRequireWildcard","require","_solidLogicJss","$rdf","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","socialPane","exports","icon","icons","originalIconBase","name","label","subject","context","kb","session","store","types","findTypeURIs","ns","foaf","uri","vcard","render","s","dom","common","x","y","both","length","j","sameTerm","push","people","res","say","str","console","log","p","createElement","textContent","tips","appendChild","link","contents","a","setAttribute","text","createTextNode","buildCheckboxForm","lab","statement","state","input","tx","className","boxHandler","_e","checked","outliner","UserInput","sparqler","insert_statement","success","errorBody","alert","add","predicate","object","why","error","delete_statement","removeMany","addEventListener","oneFriend","friend","_confirmed","widgets","personTR","getOutliner","div","navBlockStyle","mainBlockStyle","foafPicStyle","structure","tr","left","middle","right","tools","style","cssText","mainTable","src","any","img","anyValue","h3","me","authn","currentUser","meUri","loginOutButton","login","loginStatusBox","webIdUri","sym","refreshTree","thisIsYou","sameThings","knows","familiar","friends","each","profile","editable","incoming","outgoing","works","undefined","message","whether","rdf","utils","escapeForXML","cme","canon","outgoingSt","statementsMatching","youAndThem","Statement","myFriends","mutualFriends","attachmentList","doc","modify","noun","_triageFriends","confirmed","unconfirmed","requests","found","cases","thisCase","htr","items","j9","sort","last","fr","j7","preds","i6","pred","sts","uris","j5","st","last2","lab2","k","hostlabel","l","indexOf","r2","lastIndexOf","slice","d","preds2","i2","sts2","appendPropertyTRs","_pred"],"sources":["../src/socialPane.js"],"sourcesContent":["/*   Social Pane\n **\n **  This outline pane provides social network functions\n **  Using for example the FOAF ontology.\n **  Goal:  A *distributed* version of facebook, advogato, etc etc\n **  - Similarly easy user interface, but data storage distributed\n **  - Read and write both user-private (address book) and public data clearly\n **  -- todo: use common code to get username and load profile and set 'me'\n */\n\nimport * as UI from 'solid-ui-jss'\nimport { authn } from 'solid-logic-jss'\nimport * as $rdf from 'rdflib'\n\nexport const socialPane = {\n  icon: UI.icons.originalIconBase + 'foaf/foafTiny.gif',\n\n  name: 'social',\n\n  label: function (subject, context) {\n    const kb = context.session.store\n    const types = kb.findTypeURIs(subject)\n    if (\n      types[UI.ns.foaf('Person').uri] ||\n      types[UI.ns.vcard('Individual').uri]\n    ) {\n      return 'Friends'\n    }\n    return null\n  },\n\n  render: function (s, context) {\n    const dom = context.dom\n    const common = function (x, y) {\n      // Find common members of two lists\n      const both = []\n      for (let i = 0; i < x.length; i++) {\n        for (let j = 0; j < y.length; j++) {\n          if (y[j].sameTerm(x[i])) {\n            both.push(y[j])\n            break\n          }\n        }\n      }\n      return both\n    }\n\n    const people = function (n) {\n      let res = ' '\n      res += n || 'no'\n      if (n === 1) return res + ' person'\n      return res + ' people'\n    }\n    const say = function (str) {\n      console.log(str)\n      const p = dom.createElement('p')\n      p.textContent = str\n      tips.appendChild(p)\n    }\n\n    const link = function (contents, uri) {\n      if (!uri) return contents\n      const a = dom.createElement('a')\n      a.setAttribute('href', uri)\n      a.appendChild(contents)\n      return a\n    }\n\n    const text = function (str) {\n      return dom.createTextNode(str)\n    }\n\n    const buildCheckboxForm = function (lab, statement, state) {\n      const f = dom.createElement('form')\n      const input = dom.createElement('input')\n      f.appendChild(input)\n      const tx = dom.createTextNode(lab)\n      tx.className = 'question'\n      f.appendChild(tx)\n      input.setAttribute('type', 'checkbox')\n      const boxHandler = function (_e) {\n        tx.className = 'pendingedit'\n        // alert('Should be greyed out')\n        if (this.checked) {\n          // Add link\n          try {\n            outliner.UserInput.sparqler.insert_statement(statement, function (\n              uri,\n              success,\n              errorBody\n            ) {\n              tx.className = 'question'\n              if (!success) {\n                UI.log.alert(\n                  null,\n                  'Message',\n                  'Error occurs while inserting ' +\n                    statement +\n                    '\\n\\n' +\n                    errorBody\n                )\n                input.checked = false // rollback UI\n                return\n              }\n              kb.add(\n                statement.subject,\n                statement.predicate,\n                statement.object,\n                statement.why\n              )\n            })\n          } catch (e) {\n            UI.log.error('Data write fails:' + e)\n            UI.log.alert('Data write fails:' + e)\n            input.checked = false // rollback UI\n            tx.className = 'question'\n          }\n        } else {\n          // Remove link\n          try {\n            outliner.UserInput.sparqler.delete_statement(statement, function (\n              uri,\n              success,\n              errorBody\n            ) {\n              tx.className = 'question'\n              if (!success) {\n                UI.log.alert(\n                  'Error occurs while deleting ' +\n                    statement +\n                    '\\n\\n' +\n                    errorBody\n                )\n                this.checked = true // Rollback UI\n              } else {\n                kb.removeMany(\n                  statement.subject,\n                  statement.predicate,\n                  statement.object,\n                  statement.why\n                )\n              }\n            })\n          } catch (e) {\n            UI.log.alert('Delete fails:' + e)\n            this.checked = true // Rollback UI\n            // return\n          }\n        }\n      }\n      input.checked = state\n      input.addEventListener('click', boxHandler, false)\n      return f\n    }\n\n    const oneFriend = function (friend, _confirmed) {\n      return UI.widgets.personTR(dom, UI.ns.foaf('knows'), friend, {})\n    }\n\n    // ////////// Body of render():\n\n    const outliner = context.getOutliner(dom)\n    const kb = context.session.store\n    const div = dom.createElement('div')\n    div.setAttribute('class', 'socialPane')\n    const foaf = UI.ns.foaf\n    const vcard = UI.ns.vcard\n\n    // extracted from tabbedtab.css 2017-03-21\n    const navBlockStyle =\n      'background-color: #eee; width: 25%; border: 0; padding: 0.5em; margin: 0;'\n    const mainBlockStyle =\n      'background-color: #fff; color: #000; width: 46%; margin: 0; border-left: 1px solid #ccc; border-right: 1px solid #ccc; border-bottom: 1px solid #ccc; padding: 0;'\n    const foafPicStyle = ' width: 100% ; border: none; margin: 0; padding: 0;'\n\n    const structure = div.appendChild(dom.createElement('table'))\n    const tr = structure.appendChild(dom.createElement('tr'))\n    const left = tr.appendChild(dom.createElement('td'))\n    const middle = tr.appendChild(dom.createElement('td'))\n    const right = tr.appendChild(dom.createElement('td'))\n\n    const tools = left\n    tools.style.cssText = navBlockStyle\n    const mainTable = middle.appendChild(dom.createElement('table'))\n    mainTable.style.cssText = mainBlockStyle\n    const tips = right\n    tips.style.cssText = navBlockStyle\n\n    // Image top left\n    const src = kb.any(s, foaf('img')) || kb.any(s, foaf('depiction'))\n    if (src) {\n      const img = dom.createElement('IMG')\n      img.setAttribute('src', src.uri) // w640 h480\n      // img.className = 'foafPic'\n      img.style.cssText = foafPicStyle\n      tools.appendChild(img)\n    }\n    const name = kb.anyValue(s, foaf('name')) || '???'\n    let h3 = dom.createElement('H3')\n    h3.appendChild(dom.createTextNode(name))\n\n    let me = authn.currentUser()\n    const meUri = me ? me.uri : null\n\n    // @@ Add: event handler to redraw the stuff below when me changes.\n    const loginOutButton = UI.login.loginStatusBox(dom, webIdUri => {\n      me = kb.sym(webIdUri)\n      // @@ To be written:   redraw as a function the new me\n      // @@ refresh the sidebars\n      UI.widgets.refreshTree(div) // this refreshes the middle at least\n    })\n\n    tips.appendChild(loginOutButton)\n\n    const thisIsYou = me && kb.sameThings(me, s)\n\n    const knows = foaf('knows')\n    //        var givenName = kb.sym('http://www.w3.org/2000/10/swap/pim/contact#givenName')\n    const familiar =\n      kb.anyValue(s, foaf('givenname')) ||\n      kb.anyValue(s, foaf('firstName')) ||\n      kb.anyValue(s, foaf('nick')) ||\n      kb.anyValue(s, foaf('name')) ||\n      kb.anyValue(s, vcard('fn'))\n    const friends = kb.each(s, knows)\n\n    // Do I have a public profile document?\n    let profile = null // This could be  SPARQL { ?me foaf:primaryTopic [ a foaf:PersonalProfileDocument ] }\n    let editable = false\n    let incoming\n    let outgoing\n    if (me) {\n      // The definition of FAF personal profile document is ..\n      const works = kb.each(undefined, foaf('primaryTopic'), me) // having me as primary topic\n      let message = ''\n      for (let i = 0; i < works.length; i++) {\n        if (\n          kb.whether(\n            works[i],\n            UI.ns.rdf('type'),\n            foaf('PersonalProfileDocument')\n          )\n        ) {\n          editable = outliner.UserInput.sparqler.editable(works[i].uri, kb)\n          if (!editable) {\n            message +=\n              'Your profile <' +\n              UI.utils.escapeForXML(works[i].uri) +\n              '> is not remotely editable.'\n          } else {\n            profile = works[i]\n            break\n          }\n        }\n      }\n\n      if (!profile) {\n        say(\n          message + '\\nI couldn\\'t find your editable personal profile document.'\n        )\n      } else {\n        say('Editing your profile ' + profile + '.')\n        // Do I have an EDITABLE profile?\n        editable = outliner.UserInput.sparqler.editable(profile.uri, kb)\n      }\n\n      if (thisIsYou) {\n        // This is about me\n        // pass... @@\n      } else {\n        // This is about someone else\n        // My relationship with this person\n\n        h3 = dom.createElement('h3')\n        h3.appendChild(dom.createTextNode('You and ' + familiar))\n        tools.appendChild(h3)\n\n        const cme = kb.canon(me)\n        incoming = kb.whether(s, knows, cme)\n        outgoing = false\n        const outgoingSt = kb.statementsMatching(cme, knows, s)\n        if (outgoingSt.length) {\n          outgoing = true\n          if (!profile) profile = outgoingSt[0].why\n        }\n\n        const tr = dom.createElement('tr')\n        tools.appendChild(tr)\n\n        const youAndThem = function () {\n          tr.appendChild(link(text('You'), meUri))\n          tr.appendChild(text(' and '))\n          tr.appendChild(link(text(familiar), s.uri))\n        }\n\n        if (!incoming) {\n          if (!outgoing) {\n            youAndThem()\n            tr.appendChild(text(' have not said you know each other.'))\n          } else {\n            tr.appendChild(link(text('You'), meUri))\n            tr.appendChild(text(' know '))\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text(' (unconfirmed)'))\n          }\n        } else {\n          if (!outgoing) {\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text(' knows '))\n            tr.appendChild(link(text('you'), meUri))\n            tr.appendChild(text(' (unconfirmed).')) // @@\n            tr.appendChild(text(' confirm you know '))\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text('.'))\n          } else {\n            youAndThem()\n            tr.appendChild(text(' say you know each other.'))\n          }\n        }\n\n        if (editable) {\n          const f = buildCheckboxForm(\n            'You know ' + familiar,\n            new $rdf.Statement(me, knows, s, profile),\n            outgoing\n          )\n          tools.appendChild(f)\n        } // editable\n\n        // //////////////// Mutual friends\n        if (friends) {\n          const myFriends = kb.each(me, foaf('knows'))\n          if (myFriends.length) {\n            const mutualFriends = common(friends, myFriends)\n            const tr = dom.createElement('tr')\n            tools.appendChild(tr)\n            tr.appendChild(\n              dom.createTextNode(\n                'You' +\n                  (familiar ? ' and ' + familiar : '') +\n                  ' know' +\n                  people(mutualFriends.length) +\n                  ' found in common'\n              )\n            )\n            if (mutualFriends) {\n              for (let i = 0; i < mutualFriends.length; i++) {\n                tr.appendChild(\n                  dom.createTextNode(',  ' + UI.utils.label(mutualFriends[i]))\n                )\n              }\n            }\n          }\n          const tr = dom.createElement('tr')\n          tools.appendChild(tr)\n        } // friends\n      } // About someone else\n    } // me is defined\n    // End of you and s\n\n    // div.appendChild(dom.createTextNode(plural(friends.length, 'acquaintance') +'. '))\n\n    // /////////////////////////////////////////////  Main block\n    //\n    // Should: Find the intersection and difference sets\n\n    // List all x such that s knows x.\n    UI.widgets.attachmentList(dom, s, mainTable, {\n      doc: profile,\n      modify: !!editable,\n      predicate: foaf('knows'),\n      noun: 'friend'\n    })\n\n    // Figure out which are reciprocated:\n    // @@ Does not look up profiles\n    // Does distinguish reciprocated from unreciprocated friendships\n    //\n    function _triageFriends (s) {\n      outgoing = kb.each(s, foaf('knows'))\n      incoming = kb.each(undefined, foaf('knows'), s) // @@ have to load the friends\n      const confirmed = []\n      const unconfirmed = []\n      const requests = []\n\n      for (let i = 0; i < outgoing.length; i++) {\n        const friend = outgoing[i]\n        let found = false\n        for (let j = 0; j < incoming.length; j++) {\n          if (incoming[j].sameTerm(friend)) {\n            found = true\n            break\n          }\n        }\n        if (found) confirmed.push(friend)\n        else unconfirmed.push(friend)\n      } // outgoing\n\n      for (let i = 0; i < incoming.length; i++) {\n        const friend = incoming[i]\n        // var lab = UI.utils.label(friend)\n        let found = false\n        for (let j = 0; j < outgoing.length; j++) {\n          if (outgoing[j].sameTerm(friend)) {\n            found = true\n            break\n          }\n        }\n        if (!found) requests.push(friend)\n      } // incoming\n\n      const cases = [\n        ['Acquaintances', outgoing],\n        ['Mentioned as acquaintances by: ', requests]\n      ]\n      for (let i = 0; i < cases.length; i++) {\n        const thisCase = cases[i]\n        const friends = thisCase[1]\n        if (friends.length === 0) continue // Skip empty sections (sure?)\n\n        const h3 = dom.createElement('h3')\n        h3.textContent = thisCase[0]\n        const htr = dom.createElement('tr')\n        htr.appendChild(h3)\n        mainTable.appendChild(htr)\n\n        const items = []\n        for (let j9 = 0; j9 < friends.length; j9++) {\n          items.push([UI.utils.label(friends[j9]), friends[j9]])\n        }\n        items.sort()\n        let last = null\n        let fr\n        for (let j7 = 0; j7 < items.length; j7++) {\n          fr = items[j7][1]\n          if (fr.sameTerm(last)) continue // unique\n          last = fr\n          if (UI.utils.label(fr) !== '...') {\n            // This check is to avoid bnodes with no labels attached\n            // appearing in the friends list with \"...\" - Oshani\n            mainTable.appendChild(oneFriend(fr))\n          }\n        }\n      }\n    }\n    /* if ($rdf.keepThisCodeForLaterButDisableFerossConstantConditionPolice) {\n      triageFriends(s)\n    } */\n    // //////////////////////////////////// Basic info on left\n\n    h3 = dom.createElement('h3')\n    h3.appendChild(dom.createTextNode('Basic Information'))\n    tools.appendChild(h3)\n\n    // For each home page like thing make a label which will\n    // make sense and add the domain (like \"w3.org blog\") if there are more than one of the same type\n    //\n    const preds = [\n      UI.ns.foaf('homepage'),\n      UI.ns.foaf('weblog'),\n      UI.ns.foaf('workplaceHomepage'),\n      UI.ns.foaf('schoolHomepage')\n    ]\n    for (let i6 = 0; i6 < preds.length; i6++) {\n      const pred = preds[i6]\n      const sts = kb.statementsMatching(s, pred)\n      if (sts.length === 0) {\n        // if (editable) say(\"No home page set. Use the blue + icon at the bottom of the main view to add information.\")\n      } else {\n        const uris = []\n        for (let j5 = 0; j5 < sts.length; j5++) {\n          const st = sts[j5]\n          if (st.object.uri) uris.push(st.object.uri) // Ignore if not symbol\n        }\n        uris.sort()\n        let last2 = ''\n        let lab2\n        for (let k = 0; k < uris.length; k++) {\n          const uri = uris[k]\n          if (uri === last2) continue // uniques only\n          last2 = uri\n          let hostlabel = ''\n          lab2 = UI.utils.label(pred)\n          if (uris.length > 1) {\n            const l = uri.indexOf('//')\n            if (l > 0) {\n              let r = uri.indexOf('/', l + 2)\n              const r2 = uri.lastIndexOf('.', r)\n              if (r2 > 0) r = r2\n              hostlabel = uri.slice(l + 2, r)\n            }\n          }\n          if (hostlabel) lab2 = hostlabel + ' ' + lab2 // disambiguate\n          const t = dom.createTextNode(lab2)\n          const a = dom.createElement('a')\n          a.appendChild(t)\n          a.setAttribute('href', uri)\n          const d = dom.createElement('div')\n          // d.className = 'social_linkButton'\n          d.style.cssText =\n            'width: 80%; background-color: #fff; border: solid 0.05em #ccc;  margin-top: 0.1em; margin-bottom: 0.1em; padding: 0.1em; text-align: center;'\n          d.appendChild(a)\n          tools.appendChild(d)\n        }\n      }\n    }\n\n    const preds2 = [UI.ns.foaf('openid'), UI.ns.foaf('nick')]\n    for (let i2 = 0; i2 < preds2.length; i2++) {\n      const pred = preds2[i2]\n      const sts2 = kb.statementsMatching(s, pred)\n      if (sts2.length === 0) {\n        // if (editable) say(\"No home page set. Use the blue + icon at the bottom of the main view to add information.\")\n      } else {\n        outliner.appendPropertyTRs(tools, sts2, false, function (_pred) {\n          return true\n        })\n      }\n    }\n\n    return div\n  } // render()\n} //\n// ends\n"],"mappings":"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","ignoreList":[]}