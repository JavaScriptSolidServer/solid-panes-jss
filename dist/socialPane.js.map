{"version":3,"file":"socialPane.js","names":["UI","authn","$rdf","socialPane","icon","icons","originalIconBase","name","label","subject","context","kb","session","store","types","findTypeURIs","ns","foaf","uri","vcard","render","s","dom","common","x","y","both","i","length","j","sameTerm","push","people","n","res","say","str","console","log","p","createElement","textContent","tips","appendChild","link","contents","a","setAttribute","text","createTextNode","buildCheckboxForm","lab","statement","state","f","input","tx","className","boxHandler","_e","checked","outliner","UserInput","sparqler","insert_statement","success","errorBody","alert","add","predicate","object","why","e","error","delete_statement","removeMany","addEventListener","oneFriend","friend","_confirmed","widgets","personTR","getOutliner","div","navBlockStyle","mainBlockStyle","foafPicStyle","structure","tr","left","middle","right","tools","style","cssText","mainTable","src","any","img","anyValue","h3","me","currentUser","meUri","loginOutButton","login","loginStatusBox","webIdUri","sym","refreshTree","thisIsYou","sameThings","knows","familiar","friends","each","profile","editable","incoming","outgoing","works","undefined","message","whether","rdf","utils","escapeForXML","cme","canon","outgoingSt","statementsMatching","youAndThem","Statement","myFriends","mutualFriends","attachmentList","doc","modify","noun","_triageFriends","confirmed","unconfirmed","requests","found","cases","thisCase","htr","items","j9","sort","last","fr","j7","preds","i6","pred","sts","uris","j5","st","last2","lab2","k","hostlabel","l","indexOf","r","r2","lastIndexOf","slice","t","d","preds2","i2","sts2","appendPropertyTRs","_pred"],"sources":["../src/socialPane.js"],"sourcesContent":["/*   Social Pane\n **\n **  This outline pane provides social network functions\n **  Using for example the FOAF ontology.\n **  Goal:  A *distributed* version of facebook, advogato, etc etc\n **  - Similarly easy user interface, but data storage distributed\n **  - Read and write both user-private (address book) and public data clearly\n **  -- todo: use common code to get username and load profile and set 'me'\n */\n\nimport * as UI from 'solid-ui-jss'\nimport { authn } from 'solid-logic-jss'\nimport * as $rdf from 'rdflib'\n\nexport const socialPane = {\n  icon: UI.icons.originalIconBase + 'foaf/foafTiny.gif',\n\n  name: 'social',\n\n  label: function (subject, context) {\n    const kb = context.session.store\n    const types = kb.findTypeURIs(subject)\n    if (\n      types[UI.ns.foaf('Person').uri] ||\n      types[UI.ns.vcard('Individual').uri]\n    ) {\n      return 'Friends'\n    }\n    return null\n  },\n\n  render: function (s, context) {\n    const dom = context.dom\n    const common = function (x, y) {\n      // Find common members of two lists\n      const both = []\n      for (let i = 0; i < x.length; i++) {\n        for (let j = 0; j < y.length; j++) {\n          if (y[j].sameTerm(x[i])) {\n            both.push(y[j])\n            break\n          }\n        }\n      }\n      return both\n    }\n\n    const people = function (n) {\n      let res = ' '\n      res += n || 'no'\n      if (n === 1) return res + ' person'\n      return res + ' people'\n    }\n    const say = function (str) {\n      console.log(str)\n      const p = dom.createElement('p')\n      p.textContent = str\n      tips.appendChild(p)\n    }\n\n    const link = function (contents, uri) {\n      if (!uri) return contents\n      const a = dom.createElement('a')\n      a.setAttribute('href', uri)\n      a.appendChild(contents)\n      return a\n    }\n\n    const text = function (str) {\n      return dom.createTextNode(str)\n    }\n\n    const buildCheckboxForm = function (lab, statement, state) {\n      const f = dom.createElement('form')\n      const input = dom.createElement('input')\n      f.appendChild(input)\n      const tx = dom.createTextNode(lab)\n      tx.className = 'question'\n      f.appendChild(tx)\n      input.setAttribute('type', 'checkbox')\n      const boxHandler = function (_e) {\n        tx.className = 'pendingedit'\n        // alert('Should be greyed out')\n        if (this.checked) {\n          // Add link\n          try {\n            outliner.UserInput.sparqler.insert_statement(statement, function (\n              uri,\n              success,\n              errorBody\n            ) {\n              tx.className = 'question'\n              if (!success) {\n                UI.log.alert(\n                  null,\n                  'Message',\n                  'Error occurs while inserting ' +\n                    statement +\n                    '\\n\\n' +\n                    errorBody\n                )\n                input.checked = false // rollback UI\n                return\n              }\n              kb.add(\n                statement.subject,\n                statement.predicate,\n                statement.object,\n                statement.why\n              )\n            })\n          } catch (e) {\n            UI.log.error('Data write fails:' + e)\n            UI.log.alert('Data write fails:' + e)\n            input.checked = false // rollback UI\n            tx.className = 'question'\n          }\n        } else {\n          // Remove link\n          try {\n            outliner.UserInput.sparqler.delete_statement(statement, function (\n              uri,\n              success,\n              errorBody\n            ) {\n              tx.className = 'question'\n              if (!success) {\n                UI.log.alert(\n                  'Error occurs while deleting ' +\n                    statement +\n                    '\\n\\n' +\n                    errorBody\n                )\n                this.checked = true // Rollback UI\n              } else {\n                kb.removeMany(\n                  statement.subject,\n                  statement.predicate,\n                  statement.object,\n                  statement.why\n                )\n              }\n            })\n          } catch (e) {\n            UI.log.alert('Delete fails:' + e)\n            this.checked = true // Rollback UI\n            // return\n          }\n        }\n      }\n      input.checked = state\n      input.addEventListener('click', boxHandler, false)\n      return f\n    }\n\n    const oneFriend = function (friend, _confirmed) {\n      return UI.widgets.personTR(dom, UI.ns.foaf('knows'), friend, {})\n    }\n\n    // ////////// Body of render():\n\n    const outliner = context.getOutliner(dom)\n    const kb = context.session.store\n    const div = dom.createElement('div')\n    div.setAttribute('class', 'socialPane')\n    const foaf = UI.ns.foaf\n    const vcard = UI.ns.vcard\n\n    // extracted from tabbedtab.css 2017-03-21\n    const navBlockStyle =\n      'background-color: #eee; width: 25%; border: 0; padding: 0.5em; margin: 0;'\n    const mainBlockStyle =\n      'background-color: #fff; color: #000; width: 46%; margin: 0; border-left: 1px solid #ccc; border-right: 1px solid #ccc; border-bottom: 1px solid #ccc; padding: 0;'\n    const foafPicStyle = ' width: 100% ; border: none; margin: 0; padding: 0;'\n\n    const structure = div.appendChild(dom.createElement('table'))\n    const tr = structure.appendChild(dom.createElement('tr'))\n    const left = tr.appendChild(dom.createElement('td'))\n    const middle = tr.appendChild(dom.createElement('td'))\n    const right = tr.appendChild(dom.createElement('td'))\n\n    const tools = left\n    tools.style.cssText = navBlockStyle\n    const mainTable = middle.appendChild(dom.createElement('table'))\n    mainTable.style.cssText = mainBlockStyle\n    const tips = right\n    tips.style.cssText = navBlockStyle\n\n    // Image top left\n    const src = kb.any(s, foaf('img')) || kb.any(s, foaf('depiction'))\n    if (src) {\n      const img = dom.createElement('IMG')\n      img.setAttribute('src', src.uri) // w640 h480\n      // img.className = 'foafPic'\n      img.style.cssText = foafPicStyle\n      tools.appendChild(img)\n    }\n    const name = kb.anyValue(s, foaf('name')) || '???'\n    let h3 = dom.createElement('H3')\n    h3.appendChild(dom.createTextNode(name))\n\n    let me = authn.currentUser()\n    const meUri = me ? me.uri : null\n\n    // @@ Add: event handler to redraw the stuff below when me changes.\n    const loginOutButton = UI.login.loginStatusBox(dom, webIdUri => {\n      me = kb.sym(webIdUri)\n      // @@ To be written:   redraw as a function the new me\n      // @@ refresh the sidebars\n      UI.widgets.refreshTree(div) // this refreshes the middle at least\n    })\n\n    tips.appendChild(loginOutButton)\n\n    const thisIsYou = me && kb.sameThings(me, s)\n\n    const knows = foaf('knows')\n    //        var givenName = kb.sym('http://www.w3.org/2000/10/swap/pim/contact#givenName')\n    const familiar =\n      kb.anyValue(s, foaf('givenname')) ||\n      kb.anyValue(s, foaf('firstName')) ||\n      kb.anyValue(s, foaf('nick')) ||\n      kb.anyValue(s, foaf('name')) ||\n      kb.anyValue(s, vcard('fn'))\n    const friends = kb.each(s, knows)\n\n    // Do I have a public profile document?\n    let profile = null // This could be  SPARQL { ?me foaf:primaryTopic [ a foaf:PersonalProfileDocument ] }\n    let editable = false\n    let incoming\n    let outgoing\n    if (me) {\n      // The definition of FAF personal profile document is ..\n      const works = kb.each(undefined, foaf('primaryTopic'), me) // having me as primary topic\n      let message = ''\n      for (let i = 0; i < works.length; i++) {\n        if (\n          kb.whether(\n            works[i],\n            UI.ns.rdf('type'),\n            foaf('PersonalProfileDocument')\n          )\n        ) {\n          editable = outliner.UserInput.sparqler.editable(works[i].uri, kb)\n          if (!editable) {\n            message +=\n              'Your profile <' +\n              UI.utils.escapeForXML(works[i].uri) +\n              '> is not remotely editable.'\n          } else {\n            profile = works[i]\n            break\n          }\n        }\n      }\n\n      if (!profile) {\n        say(\n          message + '\\nI couldn\\'t find your editable personal profile document.'\n        )\n      } else {\n        say('Editing your profile ' + profile + '.')\n        // Do I have an EDITABLE profile?\n        editable = outliner.UserInput.sparqler.editable(profile.uri, kb)\n      }\n\n      if (thisIsYou) {\n        // This is about me\n        // pass... @@\n      } else {\n        // This is about someone else\n        // My relationship with this person\n\n        h3 = dom.createElement('h3')\n        h3.appendChild(dom.createTextNode('You and ' + familiar))\n        tools.appendChild(h3)\n\n        const cme = kb.canon(me)\n        incoming = kb.whether(s, knows, cme)\n        outgoing = false\n        const outgoingSt = kb.statementsMatching(cme, knows, s)\n        if (outgoingSt.length) {\n          outgoing = true\n          if (!profile) profile = outgoingSt[0].why\n        }\n\n        const tr = dom.createElement('tr')\n        tools.appendChild(tr)\n\n        const youAndThem = function () {\n          tr.appendChild(link(text('You'), meUri))\n          tr.appendChild(text(' and '))\n          tr.appendChild(link(text(familiar), s.uri))\n        }\n\n        if (!incoming) {\n          if (!outgoing) {\n            youAndThem()\n            tr.appendChild(text(' have not said you know each other.'))\n          } else {\n            tr.appendChild(link(text('You'), meUri))\n            tr.appendChild(text(' know '))\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text(' (unconfirmed)'))\n          }\n        } else {\n          if (!outgoing) {\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text(' knows '))\n            tr.appendChild(link(text('you'), meUri))\n            tr.appendChild(text(' (unconfirmed).')) // @@\n            tr.appendChild(text(' confirm you know '))\n            tr.appendChild(link(text(familiar), s.uri))\n            tr.appendChild(text('.'))\n          } else {\n            youAndThem()\n            tr.appendChild(text(' say you know each other.'))\n          }\n        }\n\n        if (editable) {\n          const f = buildCheckboxForm(\n            'You know ' + familiar,\n            new $rdf.Statement(me, knows, s, profile),\n            outgoing\n          )\n          tools.appendChild(f)\n        } // editable\n\n        // //////////////// Mutual friends\n        if (friends) {\n          const myFriends = kb.each(me, foaf('knows'))\n          if (myFriends.length) {\n            const mutualFriends = common(friends, myFriends)\n            const tr = dom.createElement('tr')\n            tools.appendChild(tr)\n            tr.appendChild(\n              dom.createTextNode(\n                'You' +\n                  (familiar ? ' and ' + familiar : '') +\n                  ' know' +\n                  people(mutualFriends.length) +\n                  ' found in common'\n              )\n            )\n            if (mutualFriends) {\n              for (let i = 0; i < mutualFriends.length; i++) {\n                tr.appendChild(\n                  dom.createTextNode(',  ' + UI.utils.label(mutualFriends[i]))\n                )\n              }\n            }\n          }\n          const tr = dom.createElement('tr')\n          tools.appendChild(tr)\n        } // friends\n      } // About someone else\n    } // me is defined\n    // End of you and s\n\n    // div.appendChild(dom.createTextNode(plural(friends.length, 'acquaintance') +'. '))\n\n    // /////////////////////////////////////////////  Main block\n    //\n    // Should: Find the intersection and difference sets\n\n    // List all x such that s knows x.\n    UI.widgets.attachmentList(dom, s, mainTable, {\n      doc: profile,\n      modify: !!editable,\n      predicate: foaf('knows'),\n      noun: 'friend'\n    })\n\n    // Figure out which are reciprocated:\n    // @@ Does not look up profiles\n    // Does distinguish reciprocated from unreciprocated friendships\n    //\n    function _triageFriends (s) {\n      outgoing = kb.each(s, foaf('knows'))\n      incoming = kb.each(undefined, foaf('knows'), s) // @@ have to load the friends\n      const confirmed = []\n      const unconfirmed = []\n      const requests = []\n\n      for (let i = 0; i < outgoing.length; i++) {\n        const friend = outgoing[i]\n        let found = false\n        for (let j = 0; j < incoming.length; j++) {\n          if (incoming[j].sameTerm(friend)) {\n            found = true\n            break\n          }\n        }\n        if (found) confirmed.push(friend)\n        else unconfirmed.push(friend)\n      } // outgoing\n\n      for (let i = 0; i < incoming.length; i++) {\n        const friend = incoming[i]\n        // var lab = UI.utils.label(friend)\n        let found = false\n        for (let j = 0; j < outgoing.length; j++) {\n          if (outgoing[j].sameTerm(friend)) {\n            found = true\n            break\n          }\n        }\n        if (!found) requests.push(friend)\n      } // incoming\n\n      const cases = [\n        ['Acquaintances', outgoing],\n        ['Mentioned as acquaintances by: ', requests]\n      ]\n      for (let i = 0; i < cases.length; i++) {\n        const thisCase = cases[i]\n        const friends = thisCase[1]\n        if (friends.length === 0) continue // Skip empty sections (sure?)\n\n        const h3 = dom.createElement('h3')\n        h3.textContent = thisCase[0]\n        const htr = dom.createElement('tr')\n        htr.appendChild(h3)\n        mainTable.appendChild(htr)\n\n        const items = []\n        for (let j9 = 0; j9 < friends.length; j9++) {\n          items.push([UI.utils.label(friends[j9]), friends[j9]])\n        }\n        items.sort()\n        let last = null\n        let fr\n        for (let j7 = 0; j7 < items.length; j7++) {\n          fr = items[j7][1]\n          if (fr.sameTerm(last)) continue // unique\n          last = fr\n          if (UI.utils.label(fr) !== '...') {\n            // This check is to avoid bnodes with no labels attached\n            // appearing in the friends list with \"...\" - Oshani\n            mainTable.appendChild(oneFriend(fr))\n          }\n        }\n      }\n    }\n    /* if ($rdf.keepThisCodeForLaterButDisableFerossConstantConditionPolice) {\n      triageFriends(s)\n    } */\n    // //////////////////////////////////// Basic info on left\n\n    h3 = dom.createElement('h3')\n    h3.appendChild(dom.createTextNode('Basic Information'))\n    tools.appendChild(h3)\n\n    // For each home page like thing make a label which will\n    // make sense and add the domain (like \"w3.org blog\") if there are more than one of the same type\n    //\n    const preds = [\n      UI.ns.foaf('homepage'),\n      UI.ns.foaf('weblog'),\n      UI.ns.foaf('workplaceHomepage'),\n      UI.ns.foaf('schoolHomepage')\n    ]\n    for (let i6 = 0; i6 < preds.length; i6++) {\n      const pred = preds[i6]\n      const sts = kb.statementsMatching(s, pred)\n      if (sts.length === 0) {\n        // if (editable) say(\"No home page set. Use the blue + icon at the bottom of the main view to add information.\")\n      } else {\n        const uris = []\n        for (let j5 = 0; j5 < sts.length; j5++) {\n          const st = sts[j5]\n          if (st.object.uri) uris.push(st.object.uri) // Ignore if not symbol\n        }\n        uris.sort()\n        let last2 = ''\n        let lab2\n        for (let k = 0; k < uris.length; k++) {\n          const uri = uris[k]\n          if (uri === last2) continue // uniques only\n          last2 = uri\n          let hostlabel = ''\n          lab2 = UI.utils.label(pred)\n          if (uris.length > 1) {\n            const l = uri.indexOf('//')\n            if (l > 0) {\n              let r = uri.indexOf('/', l + 2)\n              const r2 = uri.lastIndexOf('.', r)\n              if (r2 > 0) r = r2\n              hostlabel = uri.slice(l + 2, r)\n            }\n          }\n          if (hostlabel) lab2 = hostlabel + ' ' + lab2 // disambiguate\n          const t = dom.createTextNode(lab2)\n          const a = dom.createElement('a')\n          a.appendChild(t)\n          a.setAttribute('href', uri)\n          const d = dom.createElement('div')\n          // d.className = 'social_linkButton'\n          d.style.cssText =\n            'width: 80%; background-color: #fff; border: solid 0.05em #ccc;  margin-top: 0.1em; margin-bottom: 0.1em; padding: 0.1em; text-align: center;'\n          d.appendChild(a)\n          tools.appendChild(d)\n        }\n      }\n    }\n\n    const preds2 = [UI.ns.foaf('openid'), UI.ns.foaf('nick')]\n    for (let i2 = 0; i2 < preds2.length; i2++) {\n      const pred = preds2[i2]\n      const sts2 = kb.statementsMatching(s, pred)\n      if (sts2.length === 0) {\n        // if (editable) say(\"No home page set. Use the blue + icon at the bottom of the main view to add information.\")\n      } else {\n        outliner.appendPropertyTRs(tools, sts2, false, function (_pred) {\n          return true\n        })\n      }\n    }\n\n    return div\n  } // render()\n} //\n// ends\n"],"mappings":"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","ignoreList":[]}