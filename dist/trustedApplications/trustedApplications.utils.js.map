{"version":3,"file":"trustedApplications.utils.js","names":["BlankNode","st","sym","getStatementsToDelete","origin","person","kb","ns","applicationStatements","statementsMatching","acl","statementsToDelete","reduce","memo","concat","subject","getStatementsToAdd","nodeName","modes","application","doc","map","mode","generateRandomString","Math","random","toString","substr"],"sources":["../../src/trustedApplications/trustedApplications.utils.ts"],"sourcesContent":["import { BlankNode, IndexedFormula, NamedNode, st, Literal, sym, Statement } from 'rdflib'\nimport { Namespaces } from 'solid-namespace'\n\nexport function getStatementsToDelete (\n  origin: NamedNode | Literal,\n  person: NamedNode,\n  kb: IndexedFormula,\n  ns: Namespaces\n): any {\n  const applicationStatements = kb.statementsMatching(\n    null,\n    ns.acl('origin'),\n    origin\n  )\n  const statementsToDelete = applicationStatements.reduce(\n    (memo, st) => {\n      return memo\n        .concat(\n          kb.statementsMatching(\n            person,\n            ns.acl('trustedApp'),\n            st.subject as NamedNode\n          )\n        )\n        .concat(kb.statementsMatching(st.subject))\n    },\n    [] as Array<Statement>\n  )\n  return statementsToDelete\n}\n\nexport function getStatementsToAdd (\n  origin: NamedNode,\n  nodeName: string,\n  modes: string[],\n  person: NamedNode,\n  ns: Namespaces\n): any {\n  const application = new BlankNode(`bn_${nodeName}`) // NamedNode(`${person.doc().uri}#${nodeName}`)\n  return [\n    st(person, ns.acl('trustedApp'), application, person.doc()),\n    st(application, ns.acl('origin'), origin, person.doc()),\n    ...modes\n      .map(mode => sym(mode))\n      .map(mode => st(application, ns.acl('mode'), mode, person.doc()))\n  ]\n}\n\nexport function generateRandomString () {\n  return Math.random().toString(36).substr(2, 5)\n}\n"],"mappings":"AAAA,SAASA,SAAS,EAA6BC,EAAE,EAAWC,GAAG,QAAmB,QAAQ;AAG1F,OAAO,SAASC,qBAAqBA,CACnCC,MAA2B,EAC3BC,MAAiB,EACjBC,EAAkB,EAClBC,EAAc,EACT;EACL,MAAMC,qBAAqB,GAAGF,EAAE,CAACG,kBAAkB,CACjD,IAAI,EACJF,EAAE,CAACG,GAAG,CAAC,QAAQ,CAAC,EAChBN,MACF,CAAC;EACD,MAAMO,kBAAkB,GAAGH,qBAAqB,CAACI,MAAM,CACrD,CAACC,IAAI,EAAEZ,EAAE,KAAK;IACZ,OAAOY,IAAI,CACRC,MAAM,CACLR,EAAE,CAACG,kBAAkB,CACnBJ,MAAM,EACNE,EAAE,CAACG,GAAG,CAAC,YAAY,CAAC,EACpBT,EAAE,CAACc,OACL,CACF,CAAC,CACAD,MAAM,CAACR,EAAE,CAACG,kBAAkB,CAACR,EAAE,CAACc,OAAO,CAAC,CAAC;EAC9C,CAAC,EACD,EACF,CAAC;EACD,OAAOJ,kBAAkB;AAC3B;AAEA,OAAO,SAASK,kBAAkBA,CAChCZ,MAAiB,EACjBa,QAAgB,EAChBC,KAAe,EACfb,MAAiB,EACjBE,EAAc,EACT;EACL,MAAMY,WAAW,GAAG,IAAInB,SAAS,CAAC,MAAMiB,QAAQ,EAAE,CAAC,EAAC;EACpD,OAAO,CACLhB,EAAE,CAACI,MAAM,EAAEE,EAAE,CAACG,GAAG,CAAC,YAAY,CAAC,EAAES,WAAW,EAAEd,MAAM,CAACe,GAAG,CAAC,CAAC,CAAC,EAC3DnB,EAAE,CAACkB,WAAW,EAAEZ,EAAE,CAACG,GAAG,CAAC,QAAQ,CAAC,EAAEN,MAAM,EAAEC,MAAM,CAACe,GAAG,CAAC,CAAC,CAAC,EACvD,GAAGF,KAAK,CACLG,GAAG,CAACC,IAAI,IAAIpB,GAAG,CAACoB,IAAI,CAAC,CAAC,CACtBD,GAAG,CAACC,IAAI,IAAIrB,EAAE,CAACkB,WAAW,EAAEZ,EAAE,CAACG,GAAG,CAAC,MAAM,CAAC,EAAEY,IAAI,EAAEjB,MAAM,CAACe,GAAG,CAAC,CAAC,CAAC,CAAC,CACpE;AACH;AAEA,OAAO,SAASG,oBAAoBA,CAAA,EAAI;EACtC,OAAOC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC;AAChD","ignoreList":[]}