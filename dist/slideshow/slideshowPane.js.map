{"version":3,"file":"slideshowPane.js","names":["UI","_interopRequireWildcard","require","_betterSimpleSlideshow","_interopRequireDefault","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","ns","slideshowPane","exports","icon","icons","iconBase","name","audience","solid","label","subject","context","store","session","findTypeURIs","ldp","uri","contents","each","count","forEach","file","widgets","isImage","render","dom","styleSheet","addStyleSheet","div","createElement","setAttribute","predicate","images","sort","length","figure","appendChild","img","fetcher","_fetch","then","response","blob","myBlob","objectURL","URL","createObjectURL","options","setTimeout","makeBSS"],"sources":["../../src/slideshow/slideshowPane.js"],"sourcesContent":["/*   slideshow Pane\n **\n */\nimport * as UI from 'solid-ui-jss'\n\nimport makeBSS from '@solid/better-simple-slideshow'\nconst ns = UI.ns\n\nexport const slideshowPane = {\n  icon: UI.icons.iconBase + 'noun_138712.svg',\n\n  name: 'slideshow',\n\n  audience: [ns.solid('PowerUser')],\n\n  // Does the subject deserve an slideshow pane?\n  label: function (subject, context) {\n    const store = context.session.store\n    const ns = UI.ns\n    const t = store.findTypeURIs(subject)\n    if (t[ns.ldp('Container').uri] || t[ns.ldp('BasicContainer').uri]) {\n      const contents = store.each(subject, ns.ldp('contains'))\n      let count = 0\n      contents.forEach(function (file) {\n        if (UI.widgets.isImage(file)) count++\n      })\n      return count > 0 ? 'Slideshow' : null\n    }\n    return null\n  },\n\n  // See https://github.com/leemark/better-simple-slideshow\n  // and follow instructions there\n  render: function (subject, context) {\n    const dom = context.dom\n    const styleSheet =\n      'https://leemark.github.io/better-simple-slideshow/css/simple-slideshow-styles.css'\n    UI.widgets.addStyleSheet(dom, styleSheet)\n\n    const store = context.session.store\n    const ns = UI.ns\n    const div = dom.createElement('div')\n    div.setAttribute('class', 'bss-slides')\n\n    const t = store.findTypeURIs(subject)\n    let predicate\n    if (t[ns.ldp('BasicContainer').uri] || t[ns.ldp('Container').uri]) {\n      predicate = ns.ldp('contains')\n    }\n    const images = store.each(subject, predicate) // @@ random order?\n    // @@ Ideally: sort by embedded time of image\n    images.sort() // Sort for now by URI\n    for (let i = 0; i < images.length; i++) {\n      if (!UI.widgets.isImage(images[i])) continue\n      const figure = div.appendChild(dom.createElement('figure'))\n      const img = figure.appendChild(dom.createElement('img'))\n\n      // get image with authenticated fetch\n      store.fetcher._fetch(images[i].uri)\n        .then(function (response) {\n          return response.blob()\n        })\n        .then(function (myBlob) {\n          const objectURL = URL.createObjectURL(myBlob)\n          img.setAttribute('src', objectURL) // w640 h480 //\n        })\n      img.setAttribute('width', '100%')\n      figure.appendChild(dom.createElement('figcaption'))\n    }\n    const options = { dom }\n\n    setTimeout(function () {\n      makeBSS('.bss-slides', options)\n    }, 1000) // Must run after the code which called this\n\n    return div\n  }\n}\n\n// ends\n"],"mappings":"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","ignoreList":[]}