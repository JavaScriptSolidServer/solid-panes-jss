{"version":3,"file":"pane.js","names":["UI","_interopRequireWildcard","require","$rdf","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","ns","_default","exports","icon","icons","iconBase","name","audience","solid","label","subject","context","kb","session","store","findTypeURIs","any","qu","render","dom","fetcher","Q","Namespace","TRIP","div","createElement","setAttribute","mention","message","style","undefined","pre","appendChild","createTextNode","complain","plist","statementsMatching","qlist","predicateURIsDone","donePredicate","pred","uri","setPaneStyle","account","mystyle","backgroundColor","ui","value","d2","s","indexOf","split","slice","numericCell","amount","suppressZero","td","textContent","headerCell","str","oderByDate","x","y","dx","dy","insertedPane","paneName","p","paneRegistry","byName","d","expandAfterRow","row","solo","siblings","parentNode","children","j","length","expanded","removeChild","tr","cols","nextSibling","insertBefore","expandAfterRowOrCollapse","transactionTable","list","filter","table","transactionRow","setTRStyle","c0","date","c1","payee","a1","c3","addEventListener","shiftKey","list2","sort","rdf","statement","nav","navLink","obj","a","utils","preds","map","inner","labelForXML","join","innerHTML","complainIfBad","ok","body","nowOrWhenFetched","calendarYear","renderCatgorySelectors","widgets","makeSelectForNestedCategory","rdfs","Classified","load","then","_xhrs","each","catch","console","log","makeDescription","trips","st","object","trips2","concat","sortedBy","reverse","l2","key","pair","cal","makeSelectForOptions","multiple","nullLabel","mint","mintClass","mintStatementsFun","trip","is","push","doc","outliner","getOutliner","attachmentList","wf","appendPropertyTRs","_inverse","calculations","total","yearTotal","yearCategoryTotal","trans","bankStatements","forEach","the","year","ty","tyuri","lit","parseFloat","types","grandTotal","years","prototype","ny","cell","header","z","cat","sym","tab"],"sources":["../../src/transaction/pane.js"],"sourcesContent":["/*   Financial Transaction Pane\n **\n **  This outline pane allows a user to interact with a transaction\n **  downloaded from a bank statement, annotting it with classes and comments,\n ** trips, etc\n */\n\nimport * as UI from 'solid-ui-jss'\nimport * as $rdf from 'rdflib'\nconst ns = UI.ns\n\nexport default {\n  // icon:  (module.__dirname || __dirname) + '22-pixel-068010-3d-transparent-glass-icon-alphanumeric-dollar-sign.png',\n  icon: UI.icons.iconBase + 'noun_106746.svg',\n\n  name: 'transaction',\n\n  audience: [ns.solid('PowerUser')],\n\n  // Does the subject deserve this pane?\n  label: function (subject, context) {\n    const kb = context.session.store\n    const t = kb.findTypeURIs(subject)\n    if (t['http://www.w3.org/2000/10/swap/pim/qif#Transaction']) return '$$'\n    if (kb.any(subject, UI.ns.qu('amount'))) return '$$$' // In case schema not picked up\n\n    // if (t['http://www.w3.org/2000/10/swap/pim/qif#Period']) return \"period $\"\n\n    if (t['http://www.w3.org/ns/pim/trip#Trip']) return 'Trip $'\n\n    return null // No under other circumstances (while testing at least!)\n  },\n\n  render: function (subject, context) {\n    const dom = context.dom\n    const kb = context.session.store\n    const fetcher = kb.fetcher\n    const Q = $rdf.Namespace('http://www.w3.org/2000/10/swap/pim/qif#')\n    const TRIP = $rdf.Namespace('http://www.w3.org/ns/pim/trip#')\n\n    const div = dom.createElement('div')\n    div.setAttribute('class', 'transactionPane')\n\n    const mention = function mention (message, style) {\n      if (style === undefined) style = 'color: grey'\n      const pre = dom.createElement('pre')\n      pre.setAttribute('style', style)\n      div.appendChild(pre)\n      pre.appendChild(dom.createTextNode(message))\n    }\n    const complain = function complain (message) {\n      return mention(message, 'color: #100; background-color: #fee')\n    }\n\n    /*\n    var thisPane = this\n    var rerender = function (div) {\n      var parent = div.parentNode\n      var div2 = thisPane.render(subject, dom)\n      parent.replaceChild(div2, div)\n    }\n    */\n    // //////////////////////////////////////////////////////////////////////////////\n\n    const plist = kb.statementsMatching(subject)\n    const qlist = kb.statementsMatching(undefined, undefined, subject)\n\n    const t = kb.findTypeURIs(subject)\n\n    // var me = authn.currentUser()\n    const predicateURIsDone = {}\n    const donePredicate = function (pred) {\n      predicateURIsDone[pred.uri] = true\n    }\n\n    const setPaneStyle = function (account) {\n      let mystyle = 'padding: 0.5em 1.5em 1em 1.5em; '\n      if (account) {\n        const backgroundColor = kb.any(account, UI.ns.ui('backgroundColor'))\n        if (backgroundColor) {\n          mystyle += 'background-color: ' + backgroundColor.value + '; '\n        }\n      }\n      div.setAttribute('style', mystyle)\n    }\n    // setPaneStyle()\n\n    // Functions for displaying lists of transactions\n    // Click on the transaction line to expand it into a pane\n    // Shift-click to expand without collapsing others\n\n    const d2 = function (n) {\n      if (n === undefined) return ''\n      const s = '' + n\n      if (s.indexOf('.') >= 0) {\n        return s.split('.')[0] + '.' + (s.split('.')[1] + '00').slice(0, 2)\n      }\n      return s + '.00'\n    }\n\n    const numericCell = function numericCell (amount, suppressZero) {\n      const td = dom.createElement('td')\n      if (!(0.0 + amount === 0.0 && suppressZero)) {\n        td.textContent = d2(amount)\n      }\n      td.setAttribute('style', 'width: 6em; text-align: right; ')\n      return td\n    }\n\n    const headerCell = function headerCell (str) {\n      const td = dom.createElement('th')\n      td.textContent = str\n      td.setAttribute('style', 'text-align: right; ')\n      return td\n    }\n\n    const oderByDate = function (x, y) {\n      const dx = kb.any(x, ns.qu('date'))\n      const dy = kb.any(y, ns.qu('date'))\n      if (dx !== undefined && dy !== undefined) {\n        if (dx.value < dy.value) return -1\n        if (dx.value > dy.value) return 1\n      }\n      if (x.uri < y.uri) return -1 // Arbitrary but repeatable\n      if (x.uri > y.uri) return 1\n      return 0\n    }\n\n    const insertedPane = function (context, subject, paneName) {\n      const p = context.session.paneRegistry.byName(paneName)\n      const d = p.render(subject, context)\n      d.setAttribute('style', 'border: 0.1em solid green;')\n      return d\n    }\n\n    const expandAfterRow = function (dom, row, subject, paneName, solo) {\n      const siblings = row.parentNode.children\n      if (solo) {\n        for (let j = siblings.length - 1; j >= 0; j--) {\n          if (siblings[j].expanded) {\n            siblings[j].parentNode.removeChild(siblings[j].expanded)\n            siblings[j].expanded = false\n          }\n        }\n      }\n      const tr = dom.createElement('tr')\n      const td = tr.appendChild(dom.createElement('td'))\n      td.setAttribute(\n        'style',\n        'width: 98%; padding: 1em; border: 0.1em solid grey;'\n      )\n      const cols = row.children.length\n      if (row.nextSibling) {\n        row.parentNode.insertBefore(tr, row.nextSibling)\n      } else {\n        row.parentNode.appendChild(tr)\n      }\n      row.expanded = tr\n      td.setAttribute('colspan', '' + cols)\n      td.appendChild(insertedPane(context, subject, paneName))\n    }\n\n    const expandAfterRowOrCollapse = function (\n      dom,\n      row,\n      subject,\n      paneName,\n      solo\n    ) {\n      if (row.expanded) {\n        row.parentNode.removeChild(row.expanded)\n        row.expanded = false\n      } else {\n        expandAfterRow(dom, row, subject, paneName, solo)\n      }\n    }\n\n    const transactionTable = function (dom, list, filter) {\n      const table = dom.createElement('table')\n      table.setAttribute(\n        'style',\n        'padding-left: 0.5em; padding-right: 0.5em; font-size: 9pt; width: 85%;'\n      )\n      const transactionRow = function (dom, x) {\n        const tr = dom.createElement('tr')\n\n        const setTRStyle = function (tr, account) {\n          // var mystyle = \"padding: 0.5em 1.5em 1em 1.5em; \"\n          let mystyle =\n            '\\'padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.1em;'\n          if (account) {\n            const backgroundColor = kb.any(account, UI.ns.ui('backgroundColor'))\n            if (backgroundColor) {\n              mystyle += 'background-color: ' + backgroundColor.value + '; '\n            }\n          }\n          tr.setAttribute('style', mystyle)\n        }\n\n        const account = kb.any(x, ns.qu('toAccount'))\n        setTRStyle(tr, account)\n\n        const c0 = tr.appendChild(dom.createElement('td'))\n        const date = kb.any(x, ns.qu('date'))\n        c0.textContent = date ? date.value.slice(0, 10) : '???'\n        c0.setAttribute('style', 'width: 7em;')\n\n        const c1 = tr.appendChild(dom.createElement('td'))\n        c1.setAttribute('style', 'width: 36em;')\n        const payee = kb.any(x, ns.qu('payee'))\n        c1.textContent = payee ? payee.value : '???'\n        const a1 = c1.appendChild(dom.createElement('a'))\n        a1.textContent = ' âžœ'\n        a1.setAttribute('href', x.uri)\n\n        const c3 = tr.appendChild(dom.createElement('td'))\n        const amount = kb.any(x, ns.qu('in_USD'))\n        c3.textContent = amount ? d2(amount.value) : '???'\n        c3.setAttribute('style', 'width: 6em; text-align: right; ') // @@ decimal alignment?\n        tr.addEventListener(\n          'click',\n          function (e) {\n            // solo unless shift key\n            expandAfterRowOrCollapse(dom, tr, x, 'transaction', !e.shiftKey)\n          },\n          false\n        )\n\n        return tr\n      }\n\n      const list2 = filter ? list.filter(filter) : list.slice() // don't sort a paramater passed in place\n      list2.sort(oderByDate)\n\n      for (let i = 0; i < list2.length; i++) {\n        table.appendChild(transactionRow(dom, list2[i]))\n      }\n      return table\n    }\n\n    //              Render a single transaction\n\n    // This works only if enough metadata about the properties can drive the RDFS\n    // (or actual type statements whichtypically are NOT there on)\n    if (\n      t['http://www.w3.org/2000/10/swap/pim/qif#Transaction'] ||\n      kb.any(subject, ns.qu('toAccount'))\n    ) {\n      // var trip = kb.any(subject, WF('trip'))\n      donePredicate(ns.rdf('type'))\n\n      const account = kb.any(subject, UI.ns.qu('toAccount'))\n      setPaneStyle(account)\n      if (!account) {\n        complain(\n          '(Error: There is no bank account known for this transaction <' +\n            subject.uri +\n            '>,\\n -- every transaction needs one.)'\n        )\n      }\n\n      let store = null\n      const statement = kb.any(subject, UI.ns.qu('accordingTo'))\n      if (statement === undefined) {\n        complain(\n          '(Error: There is no back link to the original data source foir this transaction <' +\n            subject.uri +\n            '>,\\nso I can\\'t tell how to annotate it.)'\n        )\n      } else {\n        store =\n          statement !== undefined\n            ? kb.any(statement, UI.ns.qu('annotationStore'))\n            : null\n        if (store === undefined) {\n          complain(\n            '(There is no annotation document for this statement\\n<' +\n              statement.uri +\n              '>,\\nso you cannot classify this transaction.)'\n          )\n        }\n      }\n\n      const nav = dom.createElement('div')\n      nav.setAttribute('style', 'float:right')\n      div.appendChild(nav)\n\n      const navLink = function (pred, label) {\n        donePredicate(pred)\n        const obj = kb.any(subject, pred)\n        if (!obj) return\n        const a = dom.createElement('a')\n        a.setAttribute('href', obj.uri)\n        a.setAttribute('style', 'float:right')\n        nav.appendChild(a).textContent = label || UI.utils.label(obj)\n        nav.appendChild(dom.createElement('br'))\n      }\n\n      navLink(UI.ns.qu('toAccount'))\n      navLink(UI.ns.qu('accordingTo'), 'Statement')\n      navLink(TRIP('trip'))\n\n      // Basic data:\n      const table = dom.createElement('table')\n      div.appendChild(table)\n      const preds = ['date', 'payee', 'amount', 'in_USD', 'currency'].map(Q)\n      const inner = preds\n        .map(function (p) {\n          donePredicate(p)\n          const value = kb.any(subject, p)\n          const s = value ? UI.utils.labelForXML(value) : ''\n          return (\n            '<tr><td style=\"text-align: right; padding-right: 0.6em\">' +\n            UI.utils.labelForXML(p) +\n            '</td><td style=\"font-weight: bold;\">' +\n            s +\n            '</td></tr>'\n          )\n        })\n        .join('\\n')\n      table.innerHTML = inner\n\n      const complainIfBad = function (ok, body) {\n        if (ok) {\n          // setModifiedDate(store, kb, store)\n          // rerender(div) // deletes the new trip form\n        } else complain('Sorry, failed to save your change:\\n' + body)\n      }\n\n      // What trips do we know about?\n\n      // Classify:\n      if (store) {\n        kb.fetcher.nowOrWhenFetched(store.uri, subject, function (ok, body) {\n          if (!ok) complain('Cannot load store ' + store + ' ' + body)\n\n          const calendarYear = kb.any(store, ns.qu('calendarYear'))\n\n          const renderCatgorySelectors = function () {\n            div.insertBefore(\n              UI.widgets.makeSelectForNestedCategory(\n                dom,\n                kb,\n                subject,\n                UI.ns.qu('Classified'),\n                store,\n                complainIfBad\n              ),\n              table.nextSibling\n            )\n          }\n\n          if (kb.any(undefined, ns.rdfs('subClassOf'), ns.qu.Classified)) {\n            renderCatgorySelectors()\n          } else if (calendarYear) {\n            fetcher\n              .load(calendarYear)\n              .then(function (_xhrs) {\n                fetcher\n                  .load(kb.each(calendarYear, ns.rdfs('seeAlso')))\n                  .then(function () {\n                    renderCatgorySelectors()\n                  })\n                  .catch(function (e) {\n                    console.log('Error loading background data: ' + e)\n                  })\n              })\n              .catch(function (e) {\n                console.log('Error loading calendarYear: ' + e)\n              })\n          } else {\n            console.log('Can\\'t get categories, because no calendarYear')\n          }\n          div.appendChild(\n            UI.widgets.makeDescription(\n              dom,\n              kb,\n              subject,\n              UI.ns.rdfs('comment'),\n              store,\n              complainIfBad\n            )\n          )\n\n          let trips = kb\n            .statementsMatching(undefined, TRIP('trip'), undefined, store)\n            .map(function (st) {\n              return st.object\n            }) // @@ Use rdfs\n          const trips2 = kb.each(undefined, UI.ns.rdf('type'), TRIP('Trip'))\n          trips = trips.concat(trips2).sort() // @@ Unique\n\n          const sortedBy = function (kb, list, pred, reverse) {\n            const l2 = list.map(function (x) {\n              let key = kb.any(x, pred)\n              key = key ? key.value : '9999-12-31'\n              return [key, x]\n            })\n            l2.sort()\n            if (reverse) l2.reverse()\n            return l2.map(function (pair) {\n              return pair[1]\n            })\n          }\n\n          trips = sortedBy(kb, trips, UI.ns.cal('dtstart'), true) // Reverse chron\n\n          if (trips.length > 1) {\n            div.appendChild(\n              UI.widgets.makeSelectForOptions(\n                dom,\n                kb,\n                subject,\n                TRIP('trip'),\n                trips,\n                {\n                  multiple: false,\n                  nullLabel: '-- what trip? --',\n                  mint: 'New Trip *',\n                  mintClass: TRIP('Trip'),\n                  mintStatementsFun: function (trip) {\n                    const is = []\n                    is.push(\n                      $rdf.st(trip, UI.ns.rdf('type'), TRIP('Trip'), trip.doc())\n                    )\n                    return is\n                  }\n                },\n                store,\n                complainIfBad\n              )\n            )\n          }\n\n          div.appendChild(dom.createElement('br'))\n\n          // Add in simple comments about the transaction\n\n          const outliner = context.getOutliner(dom)\n\n          donePredicate(ns.rdfs('comment')) // Done above\n\n          UI.widgets.attachmentList(dom, subject, div)\n          donePredicate(ns.wf('attachment'))\n\n          div\n            .appendChild(dom.createElement('tr'))\n            .setAttribute('style', 'height: 1em') // spacer\n\n          // Remaining properties\n          outliner.appendPropertyTRs(div, plist, false, function (\n            pred,\n            _inverse\n          ) {\n            return !(pred.uri in predicateURIsDone)\n          })\n          outliner.appendPropertyTRs(div, qlist, true, function (\n            pred,\n            _inverse\n          ) {\n            return !(pred.uri in predicateURIsDone)\n          })\n        }) // fetch\n      }\n      // end of render tranasaction instance\n\n      // ////////////////////////////////////////////////////////////////////\n      //\n      //      Render the transactions in a Trip\n      //\n    } else if (t['http://www.w3.org/ns/pim/trip#Trip']) {\n      /*\n          var query = new $rdf.Query(UI.utils.label(subject))\n          var vars =  [ 'date', 'transaction', 'comment', 'type',  'in_USD']\n          var v = {}\n          vars.map(function(x){query.vars.push(v[x]=$rdf.variable(x))}) // Only used by UI\n          query.pat.add(v['transaction'], TRIP('trip'), subject)\n\n          var opt = kb.formula()\n          opt.add(v['transaction'], ns.rdf('type'), v['type']); // Issue: this will get stored supertypes too\n          query.pat.optional.push(opt)\n\n          query.pat.add(v['transaction'], UI.ns.qu('date'), v['date'])\n\n          var opt = kb.formula()\n          opt.add(v['transaction'], ns.rdfs('comment'), v['comment'])\n          query.pat.optional.push(opt)\n\n          //opt = kb.formula()\n          query.pat.add(v['transaction'], UI.ns.qu('in_USD'), v['in_USD'])\n\n          //query.pat.optional.push(opt)\n\n          var tableDiv = UI.widgets.renderTableViewPane(dom, {'query': query, 'onDone': calculations} )\n          div.appendChild(tableDiv)\n\n*/\n      const calculations = function () {\n        const total = {}\n        const yearTotal = {}\n        const yearCategoryTotal = {}\n        const trans = kb.each(undefined, TRIP('trip'), subject)\n        const bankStatements = trans.map(function (t) {\n          return t.doc()\n        })\n        kb.fetcher\n          .load(bankStatements)\n          .then(function () {\n            trans.forEach(function (t) {\n              const date = kb.the(t, ns.qu('date'))\n              const year = date ? ('' + date.value).slice(0, 4) : '????'\n              let ty = kb.the(t, ns.rdf('type')) // @@ find most specific type\n              // complain(\" -- one trans: \"+t.uri + ' -> '+kb.any(t, UI.ns.qu('in_USD')))\n              if (!ty) ty = UI.ns.qu('ErrorNoType')\n              if (ty && ty.uri) {\n                const tyuri = ty.uri\n                if (!yearTotal[year]) yearTotal[year] = 0.0\n                if (!yearCategoryTotal[year]) yearCategoryTotal[year] = {}\n                if (!total[tyuri]) total[tyuri] = 0.0\n                if (!yearCategoryTotal[year][tyuri]) {\n                  yearCategoryTotal[year][tyuri] = 0.0\n                }\n\n                const lit = kb.any(t, UI.ns.qu('in_USD'))\n                if (!lit) {\n                  complain('@@ No amount in USD: ' + lit + ' for ' + t)\n                }\n                if (lit) {\n                  const amount = parseFloat(lit.value)\n                  total[tyuri] += amount\n                  yearCategoryTotal[year][tyuri] += amount\n                  yearTotal[year] += amount\n                }\n              }\n            })\n\n            const types = []\n            let grandTotal = 0.0\n            const years = []\n            let i\n\n            for (const y in yearCategoryTotal) {\n              // @@ TODO: Write away the need for exception on next line\n\n              if (Object.prototype.hasOwnProperty.call(yearCategoryTotal, y)) {\n                years.push(y)\n              }\n            }\n            years.sort()\n            const ny = years.length\n            let cell\n\n            const table = div.appendChild(dom.createElement('table'))\n            table.setAttribute(\n              'style',\n              'font-size: 120%; margin-left:auto; margin-right:1em; margin-top: 1em; border: 0.05em solid gray; padding: 1em;'\n            )\n\n            if (ny > 1) {\n              const header = table.appendChild(dom.createElement('tr'))\n              header.appendChild(headerCell(''))\n              for (i = 0; i < ny; i++) {\n                header.appendChild(headerCell(years[i]))\n              }\n              header.appendChild(headerCell('total'))\n            }\n\n            for (const uri in total) {\n              // @@ TODO: Write away the need for exception on next line\n\n              if (Object.prototype.hasOwnProperty.call(total, uri)) {\n                types.push(uri)\n                grandTotal += total[uri]\n              }\n            }\n            types.sort()\n            let row, label, z\n            for (let j = 0; j < types.length; j++) {\n              const cat = kb.sym(types[j])\n              row = table.appendChild(dom.createElement('tr'))\n              label = row.appendChild(dom.createElement('td'))\n              label.textContent = UI.utils.label(cat)\n              if (ny > 1) {\n                for (i = 0; i < ny; i++) {\n                  z = yearCategoryTotal[years[i]][types[j]]\n                  cell = row.appendChild(numericCell(z, true))\n                }\n              }\n              row.appendChild(numericCell(total[types[j]], true))\n            }\n\n            // Trailing totals\n            if (types.length > 1) {\n              row = table.appendChild(dom.createElement('tr'))\n              row.appendChild(headerCell('total'))\n              if (ny > 1) {\n                for (i = 0; i < ny; i++) {\n                  z = yearTotal[years[i]]\n                  cell = row.appendChild(numericCell(z ? d2(z) : ''))\n                }\n              }\n              cell = row.appendChild(numericCell(grandTotal))\n              cell.setAttribute(\n                'style',\n                'font-weight: bold; text-align: right;'\n              )\n            }\n\n            const tab = transactionTable(dom, trans)\n            tab.setAttribute(\n              'style',\n              'margin-left:auto; margin-right:1em; margin-top: 1em; border: padding: 1em;'\n            )\n            div.appendChild(tab)\n\n            UI.widgets.attachmentList(dom, subject, div)\n          })\n          .catch(function (e) {\n            complain('Error loading transactions: ' + e)\n          })\n      }\n      calculations()\n    } // if\n\n    return div\n  }\n}\n\n// ends\n"],"mappings":"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","ignoreList":[]}