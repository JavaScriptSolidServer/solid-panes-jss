{"version":3,"file":"manager.js","names":["paneRegistry","$rdf","UI","authn","authSession","store","propertyViews","outlineIcons","UserInput","queryByExample","context","dom","document","labeller","LanguagePreference","outline","thisOutline","selection","ancestor","utils","sparql","UpdateManager","kb","sf","fetcher","qs","QuerySource","clipboardAddress","clipboardInit","outlineElement","init","table","getOutlineContainer","benchmark","lastkbsize","f","args","i","arguments","length","begin","Date","getTime","returnValue","apply","end","log","info","statements","appendRemoveIcon","node","subject","removeNode","image","AJARImage","src","icon_remove_node","undefined","addEventListener","removeNodeIconMouseDownListener","setAttribute","toNT","style","marginLeft","marginRight","appendChild","appendAccessIcons","obj","termType","uris","sort","last","appendAccessIcon","uri","docuri","docpart","slice","state","getState","icon","alt","listener","icon_unrequested","unrequestedIconMouseDownListener","icon_requested","failedIconMouseDownListener","icon_fetched","fetchedIconMouseDownListener","icon_failed","error","img","tooltips","replace","addButtonCallbacks","outlineObjectTD","view","deleteNode","statement","td","createElement","theClass","value","icons","originalIconBase","expandMouseDownListener","whether","ns","rdf","link","className","viewAsBoringDefault","tabulatorSelect","setSelected","tabulatorDeselect","selectableTDClickListener","outlinePredicateTD","predicate","newTr","inverse","internal","predicateTD","lab","predicateLabelForXML","elements","toUpperCase","labelTD","createTextNode","width","termWidget","construct","w","termWidgets","AJAR_statement","filter","addIcon","globalAppTabs","options","console","div","me","currentUser","alert","Error","items","getDashboardItems","renderTab","item","dataset","globalPaneName","tabName","paneName","textContent","label","renderMain","containerDiv","pane","byName","innerHTML","GotoSubject","tabs","tabWidget","ordered","orientation","backgroundColor","selectedTab","onClose","getDashboard","books","pods","Promise","all","getAddressBooks","getPods","iconBase","concat","addPodStorage","pod","loadContainerRepresentation","holds","space","doc","push","addPodStorageFromUrl","url","podStorage","URL","pathStorage","pathname","substring","lastIndexOf","sym","origin","load","err","each","map","window","location","href","searchParams","get","podUrl","uniques","nodes","uniqueNodes","forEach","find","uniqueNode","equals","index","split","startsWith","login","findAppInstances","vcard","instances","book","showDashboard","dashboardContainer","getDashboardContainer","outlineContainer","childNodes","display","tab","querySelector","click","warn","dashboard","closeDashboard","events","on","getOrCreateContainer","id","getElementById","mainContainer","body","any","ldp","response","webOperation","initFetchOptions","headers","accept","containerTurtle","responseText","parse","getRelevantPanes","endsWith","panes","session","relevantPanes","list","global","filteredPanes","filterAvailablePanes","firstRelevantPaneIndex","indexOf","firstFilteredPaneIndex","getPane","shouldGetFocus","expandedHeaderTR","requiredPane","renderPaneIconTray","paneShownStyle","paneHiddenStyle","paneIconTray","hideList","tr","firstPane","paneNumber","ico","listen","event","containingTable","parentNode","nodeName","removePanes","specific","d","firstChild","nextSibling","paneButton","removeAndRefresh","requireQueryButton","numberOfPanesRequiringQueryButton","renderPane","name","second","row","cell","handleRendered","paneDiv","removeAttribute","handleError","e","errorDiv","pre","stackString","result","render","then","loading","removeChild","catch","insertBefore","getAttribute","shiftKey","hover","header","showHeader","solo","collapseMouseDownListener","strong","widgets","makeDraggable","par","placeholder","replaceChild","propertyTable","debug","canon","tr1","propertyTR","st","AJAR_inverse","appendPropertyTRs","parent","plist","predicateFilter","sel","j","k","x","RDFComparePredicateSubject","object","RDFComparePredicateObject","max","s","defaultpropview","views","defaults","dups","langTagged","myLang","sameTerm","lang","showNobj","n","predDups","show","showLaterArray","l","displayed","trObj","colspan","moreTR","moreTD","small","predToggle","current","toggleObj","stopPropagation","showAllobj","iconTD","tooltip","parseInt","removeIcon","baseURI","elt","eltSrc","relativeIconSrc","join","replaceIcon","oldIcon","newIcon","QueryObj","pat","formula","vars","queries","target","fireOn","makeIconCallback","IconCallback","req","title","addCallback","selected","a","optOnIconMouseDownListener","targetOf","p","optOn","optOff","optOffIconMouseDownListener","setSelectedParent","inc","onIcon","offIcon","num","previousSibling","statusBarClick","getTarget","content","showURI","about","showSource","sourceWidget","sources","source","why","highlight","getSelection","newValue","cla","getTerm","editable","updater","addTri","deselectAll","srcElement","nodeType","walk","directionCode","inputTd","selectedTd","newSelTd","lastChild","tagName","newSelected","evaluate","XPathResult","FIRST_ORDERED_NODE_TYPE","singleNodeValue","OutlinerKeypressPanel","keyCode","setSelectedAfterward","_uri","getAbout","focusTd","removeCallback","Enter","Keypress","preventDefault","Delete","titleTd","outlineCollapse","outlineExpand","charCode","ctrlKey","copyToClipboard","pasteFromClipboard","PosY","findPos","clientHeight","scrollY","innerHeight","getEyeFocus","OutlinerMouseclickPanel","_tabulatorMode","TabulatorMousedown","Click","altKey","outlineRefocus","immediate","fetch","force","refresh","clearInputAndSave","detail","tname","clearMenu","lastModified","backOut","icon_show_choices","icon_add_triple","setUrlBarAndTitle","site","subject1","already","newTable","emptyNode","seeAlsoWhat","rdfs","lookUpThing","expand","cursubj","docTerm","relevant","as","rd","HTTPRedirects","anyStatementMatching","success","status","returnConditions","returnCode","isAudio","isVideo","nowOrWhenFetched","ok","message","level","myview","replaceTD","newTd","replacedTd","reselect","outer","GotoFormURI_enterKey","GotoFormURI","_e","GotoURI","GotoURIinit","referrer","GotoSubjectDefault","verticalAlign","defaultView","history","stateObj","pushState","rep","styles","integer","decimal","double","datatype","xsd","anchor","icon_telephone","linkIcon","numcell","statementsAsTables","createTabURI"],"sources":["../../src/outline/manager.js"],"sourcesContent":["/* istanbul ignore file */\n/* -*- coding: utf-8-dos -*-\n   Outline Mode Manager\n*/\nimport * as paneRegistry from 'pane-registry'\nimport * as $rdf from 'rdflib'\nimport * as UI from 'solid-ui-jss'\nimport { authn, authSession, store } from 'solid-logic-jss'\nimport { propertyViews } from './propertyViews'\nimport { outlineIcons } from './outlineIcons.js' // @@ chec\nimport { UserInput } from './userInput.js'\nimport * as queryByExample from './queryByExample.js'\n\n/* global alert XPathResult sourceWidget */\n// XPathResult?\n\n// const iconHeight = '24px'\n\nexport default function (context) {\n  const dom = context.dom\n\n  this.document = context.dom\n  this.outlineIcons = outlineIcons\n  this.labeller = this.labeller || {}\n  this.labeller.LanguagePreference = '' // for now\n  const outline = this // Kenny: do we need this?\n  const thisOutline = this\n  let selection = []\n  this.selection = selection\n  this.ancestor = UI.utils.ancestor // make available as outline.ancestor in callbacks\n  this.sparql = $rdf.UpdateManager\n  this.kb = store\n  const kb = store\n  const sf = store.fetcher\n  dom.outline = this\n  this.qs = new queryByExample.QuerySource() // Track queries in queryByExample\n\n  // var selection = []  // Array of statements which have been selected\n  // this.focusTd // the <td> that is being observed\n  this.UserInput = new UserInput(this)\n  this.clipboardAddress = 'tabulator:clipboard' // Weird\n  this.UserInput.clipboardInit(this.clipboardAddress)\n  const outlineElement = this.outlineElement\n\n  this.init = function () {\n    const table = getOutlineContainer()\n    table.outline = this\n  }\n\n  /** benchmark a function **/\n  benchmark.lastkbsize = 0\n\n  function benchmark (f) {\n    const args = []\n    for (let i = arguments.length - 1; i > 0; i--) args[i - 1] = arguments[i]\n    // UI.log.debug('BENCHMARK: args=' + args.join());\n    const begin = new Date().getTime()\n    const returnValue = f.apply(f, args)\n    const end = new Date().getTime()\n    UI.log.info(\n      'BENCHMARK: kb delta: ' +\n        (kb.statements.length - benchmark.lastkbsize) +\n        ', time elapsed for ' +\n        f +\n        ' was ' +\n        (end - begin) +\n        'ms'\n    )\n    benchmark.lastkbsize = kb.statements.length\n    return returnValue\n  } // benchmark\n\n  // / ////////////////////// Representing data\n\n  //  Represent an object in summary form as a table cell\n\n  function appendRemoveIcon (node, subject, removeNode) {\n    const image = UI.utils.AJARImage(\n      outlineIcons.src.icon_remove_node,\n      'remove',\n      undefined,\n      dom\n    )\n    image.addEventListener('click', removeNodeIconMouseDownListener)\n    // image.setAttribute('align', 'right')  Causes icon to be moved down\n    image.node = removeNode\n    image.setAttribute('about', subject.toNT())\n    image.style.marginLeft = '5px'\n    image.style.marginRight = '10px'\n    // image.style.border='solid #777 1px';\n    node.appendChild(image)\n    return image\n  }\n\n  this.appendAccessIcons = function (kb, node, obj) {\n    if (obj.termType !== 'NamedNode') return\n    const uris = kb.uris(obj)\n    uris.sort()\n    let last = null\n    for (let i = 0; i < uris.length; i++) {\n      if (uris[i] === last) continue\n      last = uris[i]\n      thisOutline.appendAccessIcon(node, last)\n    }\n  }\n\n  this.appendAccessIcon = function (node, uri) {\n    if (!uri) return ''\n    const docuri = $rdf.uri.docpart(uri)\n    if (docuri.slice(0, 5) !== 'http:') return ''\n    const state = sf.getState(docuri)\n    let icon, alt, listener\n    switch (state) {\n      case 'unrequested':\n        icon = outlineIcons.src.icon_unrequested\n        alt = 'fetch'\n        listener = unrequestedIconMouseDownListener\n        break\n      case 'requested':\n        icon = outlineIcons.src.icon_requested\n        alt = 'fetching'\n        listener = failedIconMouseDownListener // new: can retry yello blob\n        break\n      case 'fetched':\n        icon = outlineIcons.src.icon_fetched\n        listener = fetchedIconMouseDownListener\n        alt = 'loaded'\n        break\n      case 'failed':\n        icon = outlineIcons.src.icon_failed\n        alt = 'failed'\n        listener = failedIconMouseDownListener\n        break\n      case 'unpermitted':\n        icon = outlineIcons.src.icon_failed\n        listener = failedIconMouseDownListener\n        alt = 'no perm'\n        break\n      case 'unfetchable':\n        icon = outlineIcons.src.icon_failed\n        listener = failedIconMouseDownListener\n        alt = 'cannot fetch'\n        break\n      default:\n        UI.log.error('?? state = ' + state)\n        break\n    } // switch\n    const img = UI.utils.AJARImage(\n      icon,\n      alt,\n      outlineIcons.tooltips[icon].replace(/[Tt]his resource/, docuri),\n      dom\n    )\n    img.setAttribute('uri', uri)\n    img.addEventListener('click', listener) // @@ seemed to be missing 2017-08\n    addButtonCallbacks(img, docuri)\n    node.appendChild(img)\n    return img\n  } // appendAccessIcon\n\n  /** make the td for an object (grammatical object)\n   *  @param obj - an RDF term\n   *  @param view - a VIEW function (rather than a bool asImage)\n   **/\n\n  this.outlineObjectTD = function outlineObjectTD (\n    obj,\n    view,\n    deleteNode,\n    statement\n  ) {\n    const td = dom.createElement('td')\n    td.setAttribute(\n      'style',\n      'margin: 0.2em; border: none; padding: 0; vertical-align: top;'\n    )\n    td.setAttribute('notSelectable', 'false')\n    const theClass = 'obj'\n\n    // set about and put 'expand' icon\n    if (\n      obj.termType === 'NamedNode' ||\n      obj.termType === 'BlankNode' ||\n      (obj.termType === 'Literal' &&\n        obj.value.slice &&\n        (obj.value.slice(0, 6) === 'ftp://' ||\n          obj.value.slice(0, 8) === 'https://' ||\n          obj.value.slice(0, 7) === 'http://'))\n    ) {\n      td.setAttribute('about', obj.toNT())\n      td.appendChild(\n        UI.utils.AJARImage(\n          UI.icons.originalIconBase + 'tbl-expand-trans.png',\n          'expand',\n          undefined,\n          dom\n        )\n      ).addEventListener('click', expandMouseDownListener)\n    }\n    td.setAttribute('class', theClass) // this is how you find an object\n    // @@ TAKE CSS OUT OF STYLE SHEET\n    if (kb.whether(obj, UI.ns.rdf('type'), UI.ns.link('Request'))) {\n      td.className = 'undetermined'\n    } // @@? why-timbl\n\n    if (!view) {\n      // view should be a function pointer\n      view = viewAsBoringDefault\n    }\n    td.appendChild(view(obj))\n    if (deleteNode) {\n      appendRemoveIcon(td, obj, deleteNode)\n    }\n\n    // set DOM methods\n    td.tabulatorSelect = function () {\n      setSelected(this, true)\n    }\n    td.tabulatorDeselect = function () {\n      setSelected(this, false)\n    }\n\n    td.addEventListener('click', selectableTDClickListener)\n    return td\n  } // outlineObjectTD\n\n  this.outlinePredicateTD = function outlinePredicateTD (\n    predicate,\n    newTr,\n    inverse,\n    internal\n  ) {\n    const predicateTD = dom.createElement('TD')\n    predicateTD.setAttribute('about', predicate.toNT())\n    predicateTD.setAttribute('class', internal ? 'pred internal' : 'pred')\n\n    let lab\n    switch (predicate.termType) {\n      case 'BlankNode': // TBD\n        predicateTD.className = 'undetermined'\n        break\n      case 'NamedNode':\n        lab = UI.utils.predicateLabelForXML(predicate, inverse)\n        break\n      case 'Collection': // some choices of predicate\n        lab = UI.utils.predicateLabelForXML(predicate.elements[0], inverse)\n    }\n    lab = lab.slice(0, 1).toUpperCase() + lab.slice(1)\n    // if (kb.statementsMatching(predicate,rdf('type'), UI.ns.link('Request')).length) predicateTD.className='undetermined';\n\n    const labelTD = dom.createElement('TD')\n    labelTD.setAttribute(\n      'style',\n      'margin: 0.2em; border: none; padding: 0; vertical-align: top;'\n    )\n    labelTD.setAttribute('notSelectable', 'true')\n    labelTD.appendChild(dom.createTextNode(lab))\n    predicateTD.appendChild(labelTD)\n    labelTD.style.width = '100%'\n    predicateTD.appendChild(termWidget.construct(dom)) // termWidget is global???\n    for (const w in outlineIcons.termWidgets) {\n      if (!newTr || !newTr.AJAR_statement) break // case for TBD as predicate\n      // alert(Icon.termWidgets[w]+'   '+Icon.termWidgets[w].filter)\n      if (\n        outlineIcons.termWidgets[w].filter &&\n        outlineIcons.termWidgets[w].filter(\n          newTr.AJAR_statement,\n          'pred',\n          inverse\n        )\n      ) {\n        termWidget.addIcon(predicateTD, outlineIcons.termWidgets[w])\n      }\n    }\n\n    // set DOM methods\n    predicateTD.tabulatorSelect = function () {\n      setSelected(this, true)\n    }\n    predicateTD.tabulatorDeselect = function () {\n      setSelected(this, false)\n    }\n    predicateTD.addEventListener('click', selectableTDClickListener)\n    return predicateTD\n  } // outlinePredicateTD\n\n  /**\n   * Render Tabbed set of home app panes\n   *\n   * @param {Object} [options] A set of options you can provide\n   * @param {string} [options.selectedTab] To open a specific dashboard pane\n   * @param {Function} [options.onClose] If given, will present an X for the dashboard, and call this method when clicked\n   * @returns Promise<{Element}> - the div that holds the dashboard\n   */\n  async function globalAppTabs (options = {}) {\n    console.log('globalAppTabs @@')\n    const div = dom.createElement('div')\n    const me = authn.currentUser()\n    if (!me) {\n      alert('Must be logged in for this')\n      throw new Error('Not logged in')\n    }\n    const items = await getDashboardItems()\n\n    function renderTab (div, item) {\n      div.dataset.globalPaneName = item.tabName || item.paneName\n      div.textContent = item.label\n    }\n\n    function renderMain (containerDiv, item) {\n      // Items are pane names\n      const pane = paneRegistry.byName(item.paneName) // 20190701\n      containerDiv.innerHTML = ''\n      const table = containerDiv.appendChild(dom.createElement('table'))\n      const me = authn.currentUser()\n      thisOutline.GotoSubject(\n        item.subject || me,\n        true,\n        pane,\n        false,\n        undefined,\n        table\n      )\n    }\n\n    div.appendChild(\n      UI.tabs.tabWidget({\n        dom,\n        subject: me,\n        items,\n        renderMain,\n        renderTab,\n        ordered: true,\n        orientation: 0,\n        backgroundColor: '#eeeeee', // black?\n        selectedTab: options.selectedTab,\n        onClose: options.onClose\n      })\n    )\n    return div\n  }\n  this.getDashboard = globalAppTabs\n\n  async function getDashboardItems () {\n    const me = authn.currentUser()\n    if (!me) return []\n    const div = dom.createElement('div')\n    const [books, pods] = await Promise.all([getAddressBooks(), getPods()])\n    return [\n      {\n        paneName: 'home',\n        label: 'Your stuff',\n        icon: UI.icons.iconBase + 'noun_547570.svg'\n      },\n      {\n        paneName: 'basicPreferences',\n        label: 'Preferences',\n        icon: UI.icons.iconBase + 'noun_Sliders_341315_00000.svg'\n      },\n      {\n        paneName: 'profile',\n        label: 'Your Profile',\n        icon: UI.icons.iconBase + 'noun_15059.svg'\n      },\n      {\n        paneName: 'editProfile',\n        label: 'Edit your Profile',\n        icon: UI.icons.iconBase + 'noun_492246.svg'\n      }\n    ]\n      .concat(books)\n      .concat(pods)\n\n    async function getPods () {\n      async function addPodStorage (pod) { // namedNode\n        await loadContainerRepresentation(pod)\n        if (kb.holds(pod, ns.rdf('type'), ns.space('Storage'), pod.doc())) {\n          pods.push(pod)\n          return true\n        }\n        return false\n      }\n      async function addPodStorageFromUrl (url) {\n        const podStorage = new URL(url)\n        // check for predicate pim:Storage in containers up the path tree\n        let pathStorage = podStorage.pathname\n        while (pathStorage.length) {\n          pathStorage = pathStorage.substring(0, pathStorage.lastIndexOf('/'))\n          if (await addPodStorage(kb.sym(`${podStorage.origin}${pathStorage}/`))) return\n        }\n        // TODO should url.origin be added to pods list when there are no pim:Storage ???\n      }\n\n      try {\n        // need to make sure that profile is loaded\n        await kb.fetcher.load(me.doc())\n      } catch (err) {\n        console.error('Unable to load profile', err)\n        return []\n      }\n      // load pod's storages from profile\n      let pods = kb.each(me, ns.space('storage'), null, me.doc())\n      pods.map(async (pod) => {\n        // TODO use addPodStorageFromUrl(pod.uri) to check for pim:Storage ???\n        await loadContainerRepresentation(pod)\n      })\n\n      try {\n        // if uri then SolidOS is a browse.html web app\n        const uri = (new URL(window.location.href)).searchParams.get('uri')\n        const podUrl = uri || window.location.href\n        await addPodStorageFromUrl(podUrl)\n      } catch (err) {\n        console.error('cannot load container', err)\n      }\n      // remove namedNodes duplicates\n      function uniques (nodes) {\n        const uniqueNodes = []\n        nodes.forEach(node => {\n          if (!uniqueNodes.find(uniqueNode => uniqueNode.equals(node))) uniqueNodes.push(node)\n        })\n        return uniqueNodes\n      }\n      pods = uniques(pods)\n      if (!pods.length) return []\n      return pods.map((pod, index) => {\n        function split (item) { return item.uri.split('//')[1].slice(0, -1) }\n        const label = split(me).startsWith(split(pod)) ? 'Your storage' : split(pod)\n        return {\n          paneName: 'folder',\n          tabName: `folder-${index}`,\n          label,\n          subject: pod,\n          icon: UI.icons.iconBase + 'noun_Cabinet_251723.svg'\n        }\n      })\n    }\n\n    async function getAddressBooks () {\n      try {\n        const context = await UI.login.findAppInstances(\n          { me, div, dom },\n          ns.vcard('AddressBook')\n        )\n        return (context.instances || []).map((book, index) => ({\n          paneName: 'contact',\n          tabName: `contact-${index}`,\n          label: 'Contacts',\n          subject: book,\n          icon: UI.icons.iconBase + 'noun_15695.svg'\n        }))\n      } catch (err) {\n        console.error('oops in globalAppTabs AddressBook')\n      }\n      return []\n    }\n  }\n  this.getDashboardItems = getDashboardItems\n\n  /**\n   * Call this method to show the global dashboard.\n   *\n   * @param {Object} [options] A set of options that can be passed\n   * @param {string} [options.pane] To open a specific dashboard pane\n   * @returns {Promise<void>}\n   */\n  async function showDashboard (options = {}) {\n    const dashboardContainer = getDashboardContainer()\n    const outlineContainer = getOutlineContainer()\n    // reuse dashboard if already children already is inserted\n    if (dashboardContainer.childNodes.length > 0 && options.pane) {\n      outlineContainer.style.display = 'none'\n      dashboardContainer.style.display = 'inherit'\n      const tab = dashboardContainer.querySelector(\n        `[data-global-pane-name=\"${options.pane}\"]`\n      )\n      if (tab) {\n        tab.click()\n        return\n      }\n      console.warn(\n        'Did not find the referred tab in global dashboard, will open first one'\n      )\n    }\n\n    // create a new dashboard if not already present\n    const dashboard = await globalAppTabs({\n      selectedTab: options.pane,\n      onClose: closeDashboard\n    })\n\n    // close the dashboard if user log out\n    authSession.events.on('logout', closeDashboard)\n\n    // finally - switch to showing dashboard\n    outlineContainer.style.display = 'none'\n    dashboardContainer.appendChild(dashboard)\n    const tab = dashboardContainer.querySelector(\n      `[data-global-pane-name=\"${options.pane}\"]`\n    )\n    if (tab) {\n      tab.click()\n    }\n\n    function closeDashboard () {\n      dashboardContainer.style.display = 'none'\n      outlineContainer.style.display = 'inherit'\n    }\n  }\n  this.showDashboard = showDashboard\n\n  function getDashboardContainer () {\n    return getOrCreateContainer('GlobalDashboard')\n  }\n\n  function getOutlineContainer () {\n    return getOrCreateContainer('outline')\n  }\n\n  /**\n   * Get element with id or create a new on the fly with that id\n   *\n   * @param {string} id The ID of the element you want to get or create\n   * @returns {HTMLElement}\n   */\n  function getOrCreateContainer (id) {\n    return (\n      document.getElementById(id) ||\n      (() => {\n        const dashboardContainer = document.createElement('div')\n        dashboardContainer.id = id\n        const mainContainer =\n          document.querySelector('[role=\"main\"]') || document.body\n        return mainContainer.appendChild(dashboardContainer)\n      })()\n    )\n  }\n\n  async function loadContainerRepresentation (subject) {\n    // force reload for index.html with RDFa\n    if (!kb.any(subject, ns.ldp('contains'), undefined, subject.doc())) {\n      const response = await kb.fetcher.webOperation('GET', subject.uri, kb.fetcher.initFetchOptions(subject.uri, { headers: { accept: 'text/turtle' } }))\n      const containerTurtle = response.responseText\n      $rdf.parse(containerTurtle, kb, subject.uri, 'text/turtle')\n    }\n  }\n\n  async function getRelevantPanes (subject, context) {\n    // make sure container representation is loaded (when server returns index.html)\n    if (subject.uri.endsWith('/')) { await loadContainerRepresentation(subject) }\n    const panes = context.session.paneRegistry\n    const relevantPanes = panes.list.filter(\n      pane => pane.label(subject, context) && !pane.global\n    )\n    if (relevantPanes.length === 0) {\n      // there are no relevant panes, simply return default pane (which ironically is internalPane)\n      return [panes.byName('internal')]\n    }\n    const filteredPanes = await UI.login.filterAvailablePanes(relevantPanes)\n    if (filteredPanes.length === 0) {\n      // if no relevant panes are available panes because of user role, we still allow for the most relevant pane to be viewed\n      return [relevantPanes[0]]\n    }\n    const firstRelevantPaneIndex = panes.list.indexOf(relevantPanes[0])\n    const firstFilteredPaneIndex = panes.list.indexOf(filteredPanes[0])\n    // if the first relevant pane is loaded before the panes available wrt role, we still want to offer the most relevant pane\n    return firstRelevantPaneIndex < firstFilteredPaneIndex\n      ? [relevantPanes[0]].concat(filteredPanes)\n      : filteredPanes\n  }\n\n  function getPane (relevantPanes, subject) {\n    return (\n      relevantPanes.find(\n        pane => pane.shouldGetFocus && pane.shouldGetFocus(subject)\n      ) || relevantPanes[0]\n    )\n  }\n\n  async function expandedHeaderTR (subject, requiredPane, options) {\n    async function renderPaneIconTray (td, options = {}) {\n      const paneShownStyle =\n        'width: 24px; border-radius: 0.5em; border-top: solid #222 1px; border-left: solid #222 0.1em; border-bottom: solid #eee 0.1em; border-right: solid #eee 0.1em; margin-left: 1em; padding: 3px; background-color:   #ffd;'\n      const paneHiddenStyle =\n        'width: 24px; border-radius: 0.5em; margin-left: 1em; padding: 3px'\n      const paneIconTray = td.appendChild(dom.createElement('nav'))\n      paneIconTray.style =\n        'display:flex; justify-content: flex-start; align-items: center;'\n\n      const relevantPanes = options.hideList\n        ? []\n        : await getRelevantPanes(subject, context)\n      tr.firstPane = requiredPane || getPane(relevantPanes, subject)\n      const paneNumber = relevantPanes.indexOf(tr.firstPane)\n\n      if (relevantPanes.length !== 1) {\n        // if only one, simplify interface\n        relevantPanes.forEach((pane, index) => {\n          const label = pane.label(subject, context)\n          const ico = UI.utils.AJARImage(pane.icon, label, label, dom)\n          ico.style = pane === tr.firstPane ? paneShownStyle : paneHiddenStyle // init to something at least\n          // ico.setAttribute('align','right');   @@ Should be better, but ffox bug pushes them down\n          // ico.style.width = iconHeight\n          // ico.style.height = iconHeight\n          const listen = function (ico, pane) {\n            // Freeze scope for event time\n            ico.addEventListener(\n              'click',\n              function (event) {\n                let containingTable\n                // Find the containing table for this subject\n                for (containingTable = td; containingTable.parentNode; containingTable = containingTable.parentNode) {\n                  if (containingTable.nodeName === 'TABLE') break\n                }\n                if (containingTable.nodeName !== 'TABLE') {\n                  throw new Error('outline: internal error.')\n                }\n                const removePanes = function (specific) {\n                  for (let d = containingTable.firstChild; d; d = d.nextSibling) {\n                    if (typeof d.pane !== 'undefined') {\n                      if (!specific || d.pane === specific) {\n                        if (d.paneButton) {\n                          d.paneButton.setAttribute('class', 'paneHidden')\n                          d.paneButton.style = paneHiddenStyle\n                        }\n                        removeAndRefresh(d)\n                        // If we just delete the node d, ffox doesn't refresh the display properly.\n                        // state = 'paneHidden';\n                        if (\n                          d.pane.requireQueryButton &&\n                          containingTable.parentNode.className /* outer table */ &&\n                          numberOfPanesRequiringQueryButton === 1 &&\n                          dom.getElementById('queryButton')\n                        ) {\n                          dom\n                            .getElementById('queryButton')\n                            .setAttribute('style', 'display:none;')\n                        }\n                      }\n                    }\n                  }\n                }\n                const renderPane = function (pane) {\n                  UI.log.info('outline: Rendering pane (2): ' + pane.name)\n\n                  const second = containingTable.firstChild.nextSibling\n                  const row = dom.createElement('tr')\n                  const cell = row.appendChild(dom.createElement('td'))\n\n                  // Helper to handle the rendered result\n                  const handleRendered = (paneDiv) => {\n                    cell.appendChild(paneDiv)\n                    if (\n                      pane.requireQueryButton &&\n                      dom.getElementById('queryButton')\n                    ) {\n                      dom.getElementById('queryButton').removeAttribute('style')\n                    }\n                  }\n\n                  // Helper for errors\n                  const handleError = (e) => {\n                    const errorDiv = dom.createElement('div')\n                    errorDiv.setAttribute('class', 'exceptionPane')\n                    const pre = dom.createElement('pre')\n                    errorDiv.appendChild(pre)\n                    pre.appendChild(dom.createTextNode(UI.utils.stackString(e)))\n                    return errorDiv\n                  }\n\n                  try {\n                    const result = pane.render(subject, context, options)\n                    // Handle async render (returns Promise)\n                    if (result && typeof result.then === 'function') {\n                      const loading = dom.createElement('div')\n                      loading.textContent = 'Loading ' + pane.name + '...'\n                      cell.appendChild(loading)\n                      result.then(paneDiv => {\n                        cell.removeChild(loading)\n                        handleRendered(paneDiv)\n                      }).catch(e => {\n                        cell.removeChild(loading)\n                        handleRendered(handleError(e))\n                      })\n                    } else {\n                      handleRendered(result)\n                    }\n                  } catch (e) {\n                    handleRendered(handleError(e))\n                  }\n\n                  if (second) containingTable.insertBefore(row, second)\n                  else containingTable.appendChild(row)\n                  row.pane = pane\n                  row.paneButton = ico\n                }\n                const state = ico.getAttribute('class')\n                if (state === 'paneHidden') {\n                  if (!event.shiftKey) {\n                    // shift means multiple select\n                    removePanes()\n                  }\n                  renderPane(pane)\n                  ico.setAttribute('class', 'paneShown')\n                  ico.style = paneShownStyle\n                } else {\n                  removePanes(pane)\n                  ico.setAttribute('class', 'paneHidden')\n                  ico.style = paneHiddenStyle\n                }\n\n                let numberOfPanesRequiringQueryButton = 0\n                for (let d = containingTable.firstChild; d; d = d.nextSibling) {\n                  if (d.pane && d.pane.requireQueryButton) {\n                    numberOfPanesRequiringQueryButton++\n                  }\n                }\n              },\n              false\n            )\n          } // listen\n\n          listen(ico, pane)\n          ico.setAttribute(\n            'class',\n            index !== paneNumber ? 'paneHidden' : 'paneShown'\n          )\n          if (index === paneNumber) tr.paneButton = ico\n          paneIconTray.appendChild(ico)\n        })\n      }\n      return paneIconTray\n    } // renderPaneIconTray\n\n    // Body of expandedHeaderTR\n    const tr = dom.createElement('tr')\n    if (options.hover) {\n      // By default no hide till hover as community deems it confusing\n      tr.setAttribute('class', 'hoverControl')\n    }\n    const td = tr.appendChild(dom.createElement('td'))\n    td.setAttribute(\n      'style',\n      'margin: 0.2em; border: none; padding: 0; vertical-align: top;' +\n        'display:flex; justify-content: space-between; flex-direction: row;'\n    )\n    td.setAttribute('notSelectable', 'true')\n    td.setAttribute('about', subject.toNT())\n    td.setAttribute('colspan', '2')\n\n    // Stuff at the right about the subject\n    const header = td.appendChild(dom.createElement('div'))\n    header.style =\n      'display:flex; justify-content: flex-start; align-items: center; flex-wrap: wrap;'\n\n    const showHeader = !!requiredPane\n\n    if (!options.solo && !showHeader) {\n      const icon = header.appendChild(\n        UI.utils.AJARImage(\n          UI.icons.originalIconBase + 'tbl-collapse.png',\n          'collapse',\n          undefined,\n          dom\n        )\n      )\n      icon.addEventListener('click', collapseMouseDownListener)\n\n      const strong = header.appendChild(dom.createElement('h1'))\n      strong.appendChild(dom.createTextNode(UI.utils.label(subject)))\n      strong.style =\n        'font-size: 150%; margin: 0 0.6em 0 0; padding: 0.1em 0.4em;'\n      UI.widgets.makeDraggable(strong, subject)\n    }\n\n    header.appendChild(\n      await renderPaneIconTray(td, {\n        hideList: showHeader\n      })\n    )\n\n    // set DOM methods\n    tr.firstChild.tabulatorSelect = function () {\n      setSelected(this, true)\n    }\n    tr.firstChild.tabulatorDeselect = function () {\n      setSelected(this, false)\n    }\n    return tr\n  } // expandedHeaderTR\n\n  // / //////////////////////////////////////////////////////////////////////////\n\n  /*  PANES\n   **\n   **     Panes are regions of the outline view in which a particular subject is\n   ** displayed in a particular way.  They are like views but views are for query results.\n   ** subject panes are currently stacked vertically.\n   */\n\n  // / ////////////////////  Specific panes are in panes/*.js\n  //\n  // The defaultPane is the first one registered for which the label method exists\n  // Those registered first take priority as a default pane.\n  // That is, those earlier in this file\n\n  /**\n   * Pane registration\n   */\n\n  // the second argument indicates whether the query button is required\n\n  // / ///////////////////////////////////////////////////////////////////////////\n\n  // Remove a node from the DOM so that Firefox refreshes the screen OK\n  // Just deleting it cause whitespace to accumulate.\n  function removeAndRefresh (d) {\n    const table = d.parentNode\n    const par = table.parentNode\n    const placeholder = dom.createElement('table')\n    placeholder.setAttribute('style', 'width: 100%;')\n    par.replaceChild(placeholder, table)\n    table.removeChild(d)\n    par.replaceChild(table, placeholder) // Attempt to\n  }\n\n  const propertyTable = (this.propertyTable = function propertyTable (\n    subject,\n    table,\n    pane,\n    options\n  ) {\n    UI.log.debug('Property table for: ' + subject)\n    subject = kb.canon(subject)\n    // if (!pane) pane = panes.defaultPane;\n\n    if (!table) {\n      // Create a new property table\n      table = dom.createElement('table')\n      table.setAttribute('style', 'width: 100%;')\n      expandedHeaderTR(subject, pane, options).then(tr1 => {\n        table.appendChild(tr1)\n\n        if (tr1.firstPane) {\n          const pane = tr1.firstPane\n          UI.log.info('outline: Rendering pane (1): ' + pane.name)\n\n          const row = dom.createElement('tr')\n          const cell = row.appendChild(dom.createElement('td'))\n\n          // Helper to handle the rendered result\n          const handleRendered = (paneDiv) => {\n            cell.appendChild(paneDiv)\n            if (\n              pane.requireQueryButton &&\n              dom.getElementById('queryButton')\n            ) {\n              dom.getElementById('queryButton').removeAttribute('style')\n            }\n          }\n\n          // Helper for errors\n          const handleError = (e) => {\n            const errorDiv = dom.createElement('div')\n            errorDiv.setAttribute('class', 'exceptionPane')\n            const pre = dom.createElement('pre')\n            errorDiv.appendChild(pre)\n            pre.appendChild(dom.createTextNode(UI.utils.stackString(e)))\n            return errorDiv\n          }\n\n          try {\n            const result = pane.render(subject, context, options)\n            // Handle async render (returns Promise)\n            if (result && typeof result.then === 'function') {\n              const loading = dom.createElement('div')\n              loading.textContent = 'Loading ' + pane.name + '...'\n              cell.appendChild(loading)\n              result.then(paneDiv => {\n                cell.removeChild(loading)\n                handleRendered(paneDiv)\n              }).catch(e => {\n                cell.removeChild(loading)\n                handleRendered(handleError(e))\n              })\n            } else {\n              handleRendered(result)\n            }\n          } catch (e) {\n            handleRendered(handleError(e))\n          }\n\n          table.appendChild(row)\n          row.pane = pane\n          row.paneButton = tr1.paneButton\n        }\n      })\n\n      return table\n    } else {\n      // New display of existing table, keeping expanded bits\n      UI.log.info('Re-expand: ' + table)\n      // do some other stuff here\n      return table\n    }\n  }) /* propertyTable */\n\n  function propertyTR (doc, st, inverse) {\n    const tr = doc.createElement('TR')\n    tr.AJAR_statement = st\n    tr.AJAR_inverse = inverse\n    // tr.AJAR_variable = null; // @@ ??  was just 'tr.AJAR_variable'\n    tr.setAttribute('predTR', 'true')\n    const predicateTD = thisOutline.outlinePredicateTD(st.predicate, tr, inverse)\n    tr.appendChild(predicateTD) // @@ add 'internal' to predicateTD's class for style? mno\n    return tr\n  }\n  this.propertyTR = propertyTR\n\n  // / ////////// Property list\n  function appendPropertyTRs (parent, plist, inverse, predicateFilter) {\n    // UI.log.info('@appendPropertyTRs, 'this' is %s, dom is %s, '+ // Gives 'can't access dead object'\n    //                   'thisOutline.document is %s', this, dom.location, thisOutline.document.location);\n    // UI.log.info('@appendPropertyTRs, dom is now ' + this.document.location);\n    // UI.log.info('@appendPropertyTRs, dom is now ' + thisOutline.document.location);\n    UI.log.debug('Property list length = ' + plist.length)\n    if (plist.length === 0) return ''\n    let sel, j, k\n    if (inverse) {\n      sel = function (x) {\n        return x.subject\n      }\n      plist = plist.sort(UI.utils.RDFComparePredicateSubject)\n    } else {\n      sel = function (x) {\n        return x.object\n      }\n      plist = plist.sort(UI.utils.RDFComparePredicateObject)\n    }\n\n    const max = plist.length\n    for (j = 0; j < max; j++) {\n      // squishing together equivalent properties I think\n      let s = plist[j]\n      //      if (s.object == parentSubject) continue; // that we knew\n\n      // Avoid predicates from other panes\n      if (predicateFilter && !predicateFilter(s.predicate, inverse)) continue\n\n      const tr = propertyTR(dom, s, inverse)\n      parent.appendChild(tr)\n      const predicateTD = tr.firstChild // we need to kludge the rowspan later\n\n      let defaultpropview = views.defaults[s.predicate.uri]\n\n      //   LANGUAGE PREFERENCES WAS AVAILABLE WITH FF EXTENSION - get from elsewhere?\n\n      let dups = 0 // How many rows have the same predicate, -1?\n      let langTagged = 0 // how many objects have language tags?\n      let myLang = 0 // Is there one I like?\n\n      for (\n        k = 0;\n        k + j < max && plist[j + k].predicate.sameTerm(s.predicate);\n        k++\n      ) {\n        if (k > 0 && sel(plist[j + k]).sameTerm(sel(plist[j + k - 1]))) dups++\n        if (sel(plist[j + k]).lang && outline.labeller.LanguagePreference) {\n          langTagged += 1\n          if (\n            sel(plist[j + k]).lang.indexOf(\n              outline.labeller.LanguagePreference\n            ) >= 0\n          ) {\n            myLang++\n          }\n        }\n      }\n\n      /* Display only the one in the preferred language\n          ONLY in the case (currently) when all the values are tagged.\n          Then we treat them as alternatives. */\n\n      if (myLang > 0 && langTagged === dups + 1) {\n        for (let k = j; k <= j + dups; k++) {\n          if (\n            outline.labeller.LanguagePreference &&\n            sel(plist[k]).lang.indexOf(outline.labeller.LanguagePreference) >= 0\n          ) {\n            tr.appendChild(\n              thisOutline.outlineObjectTD(\n                sel(plist[k]),\n                defaultpropview,\n                undefined,\n                s\n              )\n            )\n            break\n          }\n        }\n        j += dups // extra push\n        continue\n      }\n\n      tr.appendChild(\n        thisOutline.outlineObjectTD(sel(s), defaultpropview, undefined, s)\n      )\n\n      /* Note: showNobj shows between n to 2n objects.\n       * This is to prevent the case where you have a long list of objects\n       * shown, and dangling at the end is '1 more' (which is easily ignored)\n       * Therefore more objects are shown than hidden.\n       */\n\n      tr.showNobj = function (n) {\n        const predDups = k - dups\n        const show = 2 * n < predDups ? n : predDups\n        const showLaterArray = []\n        if (predDups !== 1) {\n          predicateTD.setAttribute(\n            'rowspan',\n            show === predDups ? predDups : n + 1\n          )\n          let l\n          if (show < predDups && show === 1) {\n            // what case is this...\n            predicateTD.setAttribute('rowspan', 2)\n          }\n          let displayed = 0 // The number of cells generated-1,\n          // all duplicate thing removed\n          for (l = 1; l < k; l++) {\n            // This detects the same things\n            if (\n              !kb\n                .canon(sel(plist[j + l]))\n                .sameTerm(kb.canon(sel(plist[j + l - 1])))\n            ) {\n              displayed++\n              s = plist[j + l]\n              defaultpropview = views.defaults[s.predicate.uri]\n              const trObj = dom.createElement('tr')\n              trObj.style.colspan = '1'\n              trObj.appendChild(\n                thisOutline.outlineObjectTD(\n                  sel(plist[j + l]),\n                  defaultpropview,\n                  undefined,\n                  s\n                )\n              )\n              trObj.AJAR_statement = s\n              trObj.AJAR_inverse = inverse\n              parent.appendChild(trObj)\n              if (displayed >= show) {\n                trObj.style.display = 'none'\n                showLaterArray.push(trObj)\n              }\n            } else {\n              // ToDo: show all the data sources of this statement\n              UI.log.info('there are duplicates here: %s', plist[j + l - 1])\n            }\n          }\n          // @@a quick fix on the messing problem.\n          if (show === predDups) {\n            predicateTD.setAttribute('rowspan', displayed + 1)\n          }\n        } // end of if (predDups!==1)\n\n        if (show < predDups) {\n          // Add the x more <TR> here\n          const moreTR = dom.createElement('tr')\n          const moreTD = moreTR.appendChild(dom.createElement('td'))\n          moreTD.setAttribute(\n            'style',\n            'margin: 0.2em; border: none; padding: 0; vertical-align: top;'\n          )\n          moreTD.setAttribute('notSelectable', 'false')\n          if (predDups > n) {\n            // what is this for??\n            const small = dom.createElement('a')\n            moreTD.appendChild(small)\n\n            const predToggle = (function (f) {\n              return f(predicateTD, k, dups, n)\n            })(function (predicateTD, k, dups, n) {\n              return function (display) {\n                small.innerHTML = ''\n                if (display === 'none') {\n                  small.appendChild(\n                    UI.utils.AJARImage(\n                      UI.icons.originalIconBase + 'tbl-more-trans.png',\n                      'more',\n                      'See all',\n                      dom\n                    )\n                  )\n                  small.appendChild(\n                    dom.createTextNode(predDups - n + ' more...')\n                  )\n                  predicateTD.setAttribute('rowspan', n + 1)\n                } else {\n                  small.appendChild(\n                    UI.utils.AJARImage(\n                      UI.icons.originalIconBase + 'tbl-shrink.png',\n                      '(less)',\n                      undefined,\n                      dom\n                    )\n                  )\n                  predicateTD.setAttribute('rowspan', predDups + 1)\n                }\n                for (let i = 0; i < showLaterArray.length; i++) {\n                  const trObj = showLaterArray[i]\n                  trObj.style.display = display\n                }\n              }\n            }) // ???\n            let current = 'none'\n            const toggleObj = function (event) {\n              predToggle(current)\n              current = current === 'none' ? '' : 'none'\n              if (event) event.stopPropagation()\n              return false // what is this for?\n            }\n            toggleObj()\n            small.addEventListener('click', toggleObj, false)\n          } // if(predDups>n)\n          parent.appendChild(moreTR)\n        } // if\n      } // tr.showNobj\n\n      tr.showAllobj = function () {\n        tr.showNobj(k - dups)\n      }\n\n      tr.showNobj(10)\n\n      j += k - 1 // extra push\n    }\n  } //  appendPropertyTRs\n\n  this.appendPropertyTRs = appendPropertyTRs\n\n  /*   termWidget\n   **\n   */\n  const termWidget = {} // @@@@@@ global\n  global.termWidget = termWidget\n  termWidget.construct = function (dom) {\n    dom = dom || document\n    const td = dom.createElement('TD')\n    td.setAttribute(\n      'style',\n      'margin: 0.2em; border: none; padding: 0; vertical-align: top;'\n    )\n    td.setAttribute('class', 'iconTD')\n    td.setAttribute('notSelectable', 'true')\n    td.style.width = '0px'\n    return td\n  }\n  termWidget.addIcon = function (td, icon, listener) {\n    const iconTD = td.childNodes[1]\n    if (!iconTD) return\n    let width = iconTD.style.width\n    const img = UI.utils.AJARImage(icon.src, icon.alt, icon.tooltip, dom)\n    width = parseInt(width)\n    width = width + icon.width\n    iconTD.style.width = width + 'px'\n    iconTD.appendChild(img)\n    if (listener) {\n      img.addEventListener('click', listener)\n    }\n  }\n  termWidget.removeIcon = function (td, icon) {\n    const iconTD = td.childNodes[1]\n    let baseURI\n    if (!iconTD) return\n    let width = iconTD.style.width\n    width = parseInt(width)\n    width = width - icon.width\n    iconTD.style.width = width + 'px'\n    for (let x = 0; x < iconTD.childNodes.length; x++) {\n      const elt = iconTD.childNodes[x]\n      const eltSrc = elt.src\n\n      // ignore first '?' and everything after it //Kenny doesn't know what this is for\n      try {\n        baseURI = dom.location.href.split('?')[0]\n      } catch (e) {\n        console.log(e)\n        baseURI = ''\n      }\n      const relativeIconSrc = $rdf.uri.join(icon.src, baseURI)\n      if (eltSrc === relativeIconSrc) {\n        iconTD.removeChild(elt)\n      }\n    }\n  }\n  termWidget.replaceIcon = function (td, oldIcon, newIcon, listener) {\n    termWidget.removeIcon(td, oldIcon)\n    termWidget.addIcon(td, newIcon, listener)\n  }\n\n  // / /////////////////////////////////////////////////// VALUE BROWSER VIEW\n\n  // / /////////////////////////////////////////////////////// TABLE VIEW\n\n  //  Summarize a thing as a table cell\n\n  /**********************\n\n    query global vars\n\n  ***********************/\n\n  // const doesn't work in Opera\n  // const BLANK_QUERY = { pat: kb.formula(), vars: [], orderBy: [] };\n  // @ pat: the query pattern in an RDFIndexedFormula. Statements are in pat.statements\n  // @ vars: the free variables in the query\n  // @ orderBy: the variables to order the table\n\n  function QueryObj () {\n    this.pat = kb.formula()\n    this.vars = []\n    // this.orderBy = []\n  }\n\n  const queries = []\n  queries[0] = new QueryObj()\n  /*\n  function querySave () {\n    queries.push(queries[0])\n    var choices = dom.getElementById('queryChoices')\n    var next = dom.createElement('option')\n    var box = dom.createElement('input')\n    var index = queries.length - 1\n    box.setAttribute('type', 'checkBox')\n    box.setAttribute('value', index)\n    choices.appendChild(box)\n    choices.appendChild(dom.createTextNode('Saved query #' + index))\n    choices.appendChild(dom.createElement('br'))\n    next.setAttribute('value', index)\n    next.appendChild(dom.createTextNode('Saved query #' + index))\n    dom.getElementById('queryJump').appendChild(next)\n  }\n*/\n  /*\n  function resetQuery () {\n    function resetOutliner (pat) {\n      var n = pat.statements.length\n      var pattern, tr\n      for (let i = 0; i < n; i++) {\n        pattern = pat.statements[i]\n        tr = pattern.tr\n        // UI.log.debug('tr: ' + tr.AJAR_statement);\n        if (typeof tr !== 'undefined') {\n          delete tr.AJAR_pattern\n          delete tr.AJAR_variable\n        }\n      }\n      for (let x in pat.optional) { resetOutliner(pat.optional[x]) }\n    }\n    resetOutliner(myQuery.pat)\n    UI.utils.clearVariableNames()\n    queries[0] = myQuery = new QueryObj()\n  }\n*/\n  function addButtonCallbacks (target, fireOn) {\n    UI.log.debug('Button callbacks for ' + fireOn + ' added')\n    const makeIconCallback = function (icon) {\n      return function IconCallback (req) {\n        if (req.indexOf('#') >= 0) {\n          console.log(\n            '@@ makeIconCallback: Not expecting # in URI whose state changed: ' +\n              req\n          )\n          // alert('Should have no hash in '+req)\n        }\n        if (!target) {\n          return false\n        }\n        if (!outline.ancestor(target, 'DIV')) return false\n        // if (term.termType != 'symbol') { return true } // should always ve\n        if (req === fireOn) {\n          target.src = icon\n          target.title = outlineIcons.tooltips[icon]\n        }\n        return true\n      }\n    }\n    sf.addCallback('request', makeIconCallback(outlineIcons.src.icon_requested))\n    sf.addCallback('done', makeIconCallback(outlineIcons.src.icon_fetched))\n    sf.addCallback('fail', makeIconCallback(outlineIcons.src.icon_failed))\n  }\n\n  //   Selection support\n\n  function selected (node) {\n    const a = node.getAttribute('class')\n    if (a && a.indexOf('selected') >= 0) return true\n    return false\n  }\n\n  // These woulkd be simpler using closer variables below\n  function optOnIconMouseDownListener (e) {\n    // outlineIcons.src.icon_opton  needed?\n    const target = thisOutline.targetOf(e)\n    const p = target.parentNode\n    termWidget.replaceIcon(\n      p.parentNode,\n      outlineIcons.termWidgets.optOn,\n      outlineIcons.termWidgets.optOff,\n      optOffIconMouseDownListener\n    )\n    p.parentNode.parentNode.removeAttribute('optional')\n  }\n\n  function optOffIconMouseDownListener (e) {\n    // outlineIcons.src.icon_optoff needed?\n    const target = thisOutline.targetOf(e)\n    const p = target.parentNode\n    termWidget.replaceIcon(\n      p.parentNode,\n      outlineIcons.termWidgets.optOff,\n      outlineIcons.termWidgets.optOn,\n      optOnIconMouseDownListener\n    )\n    p.parentNode.parentNode.setAttribute('optional', 'true')\n  }\n\n  function setSelectedParent (node, inc) {\n    const onIcon = outlineIcons.termWidgets.optOn\n    const offIcon = outlineIcons.termWidgets.optOff\n    for (let n = node; n.parentNode; n = n.parentNode) {\n      while (true) {\n        if (n.getAttribute('predTR')) {\n          let num = n.getAttribute('parentOfSelected')\n          if (!num) num = 0\n          else num = parseInt(num)\n          if (num === 0 && inc > 0) {\n            termWidget.addIcon(\n              n.childNodes[0],\n              n.getAttribute('optional') ? onIcon : offIcon,\n              n.getAttribute('optional')\n                ? optOnIconMouseDownListener\n                : optOffIconMouseDownListener\n            )\n          }\n          num = num + inc\n          n.setAttribute('parentOfSelected', num)\n          if (num === 0) {\n            n.removeAttribute('parentOfSelected')\n            termWidget.removeIcon(\n              n.childNodes[0],\n              n.getAttribute('optional') ? onIcon : offIcon\n            )\n          }\n          break\n        } else if (n.previousSibling && n.previousSibling.nodeName === 'TR') {\n          n = n.previousSibling\n        } else break\n      }\n    }\n  }\n\n  this.statusBarClick = function (event) {\n    const target = UI.utils.getTarget(event)\n    if (target.label) {\n      window.content.location = target.label\n      // The following alternative does not work in the extension.\n      // var s = store.sym(target.label);\n      // outline.GotoSubject(s, true);\n    }\n  }\n\n  this.showURI = function showURI (about) {\n    if (about && dom.getElementById('UserURI')) {\n      dom.getElementById('UserURI').value =\n        about.termType === 'NamedNode' ? about.uri : '' // blank if no URI\n    }\n  }\n\n  this.showSource = function showSource () {\n    if (typeof sourceWidget === 'undefined') return\n    // deselect all before going on, this is necessary because you would switch tab,\n    // close tab or so on...\n    for (const uri in sourceWidget.sources) {\n      sourceWidget.sources[uri].setAttribute('class', '')\n    } // .class doesn't work. Be careful!\n    for (let i = 0; i < selection.length; i++) {\n      if (!selection[i].parentNode) {\n        console.log('showSource: EH? no parentNode? ' + selection[i] + '\\n')\n        continue\n      }\n      const st = selection[i].parentNode.AJAR_statement\n      if (!st) continue // for root TD\n      const source = st.why\n      if (source && source.uri) {\n        sourceWidget.highlight(source, true)\n      }\n    }\n  }\n\n  this.getSelection = function getSelection () {\n    return selection\n  }\n\n  function setSelected (node, newValue) {\n    // UI.log.info('selection has ' +selection.map(function(item){return item.textContent;}).join(', '));\n    // UI.log.debug('@outline setSelected, intended to '+(newValue?'select ':'deselect ')+node+node.textContent);\n    // if (newValue === selected(node)) return; //we might not need this anymore...\n    if (node.nodeName !== 'TD') {\n      UI.log.debug('down' + node.nodeName)\n      throw new Error(\n        'Expected TD in setSelected: ' +\n          node.nodeName +\n          ' : ' +\n          node.textContent\n      )\n    }\n    UI.log.debug('pass')\n    let cla = node.getAttribute('class')\n    if (!cla) cla = ''\n    if (newValue) {\n      cla += ' selected'\n      if (cla.indexOf('pred') >= 0 || cla.indexOf('obj') >= 0) {\n        setSelectedParent(node, 1)\n      }\n      selection.push(node)\n      // UI.log.info('Selecting '+node.textContent)\n\n      const about = UI.utils.getTerm(node) // show uri for a newly selectedTd\n      thisOutline.showURI(about)\n\n      let st = node.AJAR_statement // show blue cross when the why of that triple is editable\n      if (typeof st === 'undefined' && node.parentNode) st = node.parentNode.AJAR_statement\n      // if (typeof st === 'undefined') return; // @@ Kludge?  Click in the middle of nowhere\n      if (st) {\n        // don't do these for headers or base nodes\n        const source = st.why\n        // var target = st.why\n        const editable = store.updater.editable(source.uri, kb)\n        if (!editable) {\n          // let target = node.parentNode.AJAR_inverse ? st.object : st.subject\n        } // left hand side\n        // think about this later. Because we update to the why for now.\n        // alert('Target='+target+', editable='+editable+'\\nselected statement:' + st)\n        if (editable && cla.indexOf('pred') >= 0) {\n          termWidget.addIcon(node, outlineIcons.termWidgets.addTri)\n        } // Add blue plus\n      }\n    } else {\n      UI.log.debug('cla=$' + cla + '$')\n      if (cla === 'selected') cla = '' // for header <TD>\n      cla = cla.replace(' selected', '')\n      if (cla.indexOf('pred') >= 0 || cla.indexOf('obj') >= 0) {\n        setSelectedParent(node, -1)\n      }\n      if (cla.indexOf('pred') >= 0) {\n        termWidget.removeIcon(node, outlineIcons.termWidgets.addTri)\n      }\n\n      selection = selection.filter(function (x) {\n        return x === node\n      })\n\n      UI.log.info('Deselecting ' + node.textContent)\n    }\n    if (typeof sourceWidget !== 'undefined') thisOutline.showSource() // Update the data sources display\n    // UI.log.info('selection becomes [' +selection.map(function(item){return item.textContent;}).join(', ')+']');\n    // UI.log.info('Setting className ' + cla);\n    node.setAttribute('class', cla)\n  }\n\n  function deselectAll () {\n    const n = selection.length\n    for (let i = n - 1; i >= 0; i--) setSelected(selection[i], false)\n    selection = []\n  }\n\n  /** Get the target of an event **/\n  this.targetOf = function (e) {\n    let target\n    if (!e) e = window.event\n    if (e.target) {\n      target = e.target\n    } else if (e.srcElement) {\n      target = e.srcElement\n    } else {\n      UI.log.error('can\\'t get target for event ' + e)\n      return false\n    } // fail\n    if (target.nodeType === 3) {\n      // defeat Safari bug [sic]\n      target = target.parentNode\n    }\n    return target\n  } // targetOf\n\n  this.walk = function walk (directionCode, inputTd) {\n    const selectedTd = inputTd || selection[0]\n    let newSelTd\n    switch (directionCode) {\n      case 'down':\n        try {\n          newSelTd = selectedTd.parentNode.nextSibling.lastChild\n        } catch (e) {\n          this.walk('up')\n          return\n        } // end\n        deselectAll()\n        setSelected(newSelTd, true)\n        break\n      case 'up':\n        try {\n          newSelTd = selectedTd.parentNode.previousSibling.lastChild\n        } catch (e) {\n          return\n        } // top\n        deselectAll()\n        setSelected(newSelTd, true)\n        break\n      case 'right':\n        deselectAll()\n        if (\n          selectedTd.nextSibling ||\n          selectedTd.lastChild.tagName === 'strong'\n        ) {\n          setSelected(selectedTd.nextSibling, true)\n        } else {\n          const newSelected = dom.evaluate(\n            'table/div/tr/td[2]',\n            selectedTd,\n            null,\n            XPathResult.FIRST_ORDERED_NODE_TYPE,\n            null\n          ).singleNodeValue\n          setSelected(newSelected, true)\n        }\n        break\n      case 'left':\n        deselectAll()\n        if (\n          selectedTd.previousSibling &&\n          selectedTd.previousSibling.className === 'undetermined'\n        ) {\n          setSelected(selectedTd.previousSibling, true)\n          return true // do not shrink signal\n        } else {\n          setSelected(UI.utils.ancestor(selectedTd.parentNode, 'TD'), true)\n        } // supplied by thieOutline.focusTd\n        break\n      case 'moveTo':\n        // UI.log.info(selection[0].textContent+'->'+inputTd.textContent);\n        deselectAll()\n        setSelected(inputTd, true)\n        break\n    }\n    if (directionCode === 'down' || directionCode === 'up') {\n      if (!newSelTd.tabulatorSelect) this.walk(directionCode)\n    }\n    // return newSelTd;\n  }\n\n  // Keyboard Input: we can consider this as...\n  // 1. a fast way to modify data - enter will go to next predicate\n  // 2. an alternative way to input - enter at the end of a predicate will create a new statement\n  this.OutlinerKeypressPanel = function OutlinerKeypressPanel (e) {\n    UI.log.info('Key ' + e.keyCode + ' pressed')\n\n    function showURI (about) {\n      if (about && dom.getElementById('UserURI')) {\n        dom.getElementById('UserURI').value =\n          about.termType === 'NamedNode' ? about.uri : '' // blank if no URI\n      }\n    }\n\n    function setSelectedAfterward (_uri) {\n      if (arguments[3]) return true\n      walk('right', selectedTd)\n      showURI(UI.utils.getAbout(kb, selection[0]))\n      return true\n    }\n    let target, editable\n\n    if (UI.utils.getTarget(e).tagName === 'TEXTAREA') return\n    if (UI.utils.getTarget(e).id === 'UserURI') return\n    if (selection.length > 1) return\n    if (selection.length === 0) {\n      if (\n        e.keyCode === 13 ||\n        e.keyCode === 38 ||\n        e.keyCode === 40 ||\n        e.keyCode === 37 ||\n        e.keyCode === 39\n      ) {\n        this.walk('right', thisOutline.focusTd)\n        showURI(UI.utils.getAbout(kb, selection[0]))\n      }\n      return\n    }\n    const selectedTd = selection[0]\n    // if not done, Have to deal with redraw...\n    sf.removeCallback('done', 'setSelectedAfterward')\n    sf.removeCallback('fail', 'setSelectedAfterward')\n\n    switch (e.keyCode) {\n      case 13: // enter\n        if (UI.utils.getTarget(e).tagName === 'HTML') {\n          // I don't know why 'HTML'\n          const object = UI.utils.getAbout(kb, selectedTd)\n          target = selectedTd.parentNode.AJAR_statement.why\n          editable = store.updater.editable(target.uri, kb)\n          if (object) {\n            // <Feature about='enterToExpand'>\n            outline.GotoSubject(object, true)\n            /* //deal with this later\n            deselectAll();\n            var newTr=dom.getElementById('outline').lastChild;\n            setSelected(newTr.firstChild.firstChild.childNodes[1].lastChild,true);\n            function setSelectedAfterward(uri){\n                deselectAll();\n                setSelected(newTr.firstChild.firstChild.childNodes[1].lastChild,true);\n                showURI(getAbout(kb,selection[0]));\n                return true;\n            }\n            sf.insertCallback('done',setSelectedAfterward);\n            sf.insertCallback('fail',setSelectedAfterward);\n            */\n            // </Feature>\n          } else if (editable) {\n            // this is a text node and editable\n            thisOutline.UserInput.Enter(selectedTd)\n          }\n        } else {\n          // var newSelTd=thisOutline.UserInput.lastModified.parentNode.parentNode.nextSibling.lastChild;\n          this.UserInput.Keypress(e)\n          this.walk('down') // bug with input at the end\n          // dom.getElementById('docHTML').focus(); //have to set this or focus blurs\n          e.stopPropagation()\n        }\n        return\n      case 38: // up\n        // thisOutline.UserInput.clearInputAndSave();\n        // ^^^ does not work because up and down not captured...\n        this.walk('up')\n        e.stopPropagation()\n        e.preventDefault()\n        break\n      case 40: // down\n        // thisOutline.UserInput.clearInputAndSave();\n        this.walk('down')\n        e.stopPropagation()\n        e.preventDefault()\n    } // switch\n\n    if (UI.utils.getTarget(e).tagName === 'INPUT') return\n\n    let walk\n    switch (e.keyCode) {\n      case 46: // delete\n      case 8: // backspace\n        target = selectedTd.parentNode.AJAR_statement.why\n        editable = store.updater.editable(target.uri, kb)\n        if (editable) {\n          e.preventDefault() // prevent from going back\n          this.UserInput.Delete(selectedTd)\n        }\n        break\n      case 37: { // left\n        if (this.walk('left')) return\n        const titleTd = UI.utils.ancestor(selectedTd.parentNode, 'TD')\n        outlineCollapse(selectedTd, UI.utils.getAbout(kb, titleTd))\n        break\n      }\n      case 39: // right\n        // @@ TODO: Write away the need for exception on next line\n        {\n          const obj = UI.utils.getAbout(kb, selectedTd)\n          if (obj) {\n            walk = this.walk\n            if (selectedTd.nextSibling) {\n              // when selectedTd is a predicate\n              this.walk('right')\n              return\n            }\n            if (selectedTd.firstChild.tagName !== 'TABLE') {\n              // not expanded\n              sf.addCallback('done', setSelectedAfterward)\n              sf.addCallback('fail', setSelectedAfterward)\n              outlineExpand(selectedTd, obj, {\n                pane: paneRegistry.byName('defaultPane')\n              })\n            }\n            setSelectedAfterward()\n          }\n        }\n        break\n      case 38: // up\n      case 40: // down\n        break\n      default:\n        switch (e.charCode) {\n          case 99: // c for Copy\n            if (e.ctrlKey) {\n              thisOutline.UserInput.copyToClipboard(\n                thisOutline.clipboardAddress,\n                selectedTd\n              )\n              break\n            }\n            break\n          case 118: // v\n          case 112: // p for Paste\n            if (e.ctrlKey) {\n              thisOutline.UserInput.pasteFromClipboard(\n                thisOutline.clipboardAddress,\n                selectedTd\n              )\n              // dom.getElementById('docHTML').focus(); //have to set this or focus blurs\n              // window.focus();\n              // e.stopPropagation();\n              break\n            }\n            break\n          default:\n            if (UI.utils.getTarget(e).tagName === 'HTML') {\n              /*\n              //<Feature about='typeOnSelectedToInput'>\n              thisOutline.UserInput.Click(e,selectedTd);\n              thisOutline.UserInput.lastModified.value=String.fromCharCode(e.charCode);\n              if (selectedTd.className==='undetermined selected') thisOutline.UserInput.AutoComplete(e.charCode)\n              //</Feature>\n              */\n              // Events are not reliable...\n              // var e2=document.createEvent('KeyboardEvent');\n              // e2.initKeyEvent('keypress',true,true,null,false,false,false,false,e.keyCode,0);\n              // UserInput.lastModified.dispatchEvent(e2);\n            }\n        }\n    } // end of switch\n\n    showURI(UI.utils.getAbout(kb, selection[0]))\n    // alert(window);alert(doc);\n    /*\n    var wm = Components.classes['@mozilla.org/appshell/window-mediator;1']\n               .getService(Components.interfaces.nsIWindowMediator);\n    var gBrowser = wm.getMostRecentWindow('navigator:browser') */\n    // gBrowser.addTab('http://www.w3.org/');\n    // alert(gBrowser.addTab);alert(gBrowser.scroll);alert(gBrowser.scrollBy)\n    // gBrowser.scrollBy(0,100);\n\n    // var thisHtml=selection[0].owner\n    if (selection[0]) {\n      const PosY = UI.utils.findPos(selection[0])[1]\n      if (\n        PosY + selection[0].clientHeight >\n        window.scrollY + window.innerHeight\n      ) {\n        UI.utils.getEyeFocus(selection[0], true, true, window)\n      }\n      if (PosY < window.scrollY + 54) {\n        UI.utils.getEyeFocus(selection[0], true, undefined, window)\n      }\n    }\n  }\n  this.OutlinerMouseclickPanel = function (e) {\n    switch (thisOutline.UserInput._tabulatorMode) {\n      case 0:\n        TabulatorMousedown(e)\n        break\n      case 1:\n        thisOutline.UserInput.Click(e)\n        break\n      default:\n    }\n  }\n\n  /** things to do onmousedown in outline view **/\n  /*\n   **   To Do:  This big event handler needs to be replaced by lots\n   ** of little ones individually connected to each icon.  This horrible\n   ** switch below isn't modular. (Sorry!) - Tim\n   */\n  // expand\n  // collapse\n  // refocus\n  // select\n  // visit/open a page\n\n  function expandMouseDownListener (e) {\n    // For icon (UI.icons.originalIconBase + 'tbl-expand-trans.png')\n    const target = thisOutline.targetOf(e)\n    const p = target.parentNode\n    const subject = UI.utils.getAbout(kb, target)\n    const pane = e.altKey ? paneRegistry.byName('internal') : undefined // set later: was panes.defaultPane\n\n    if (e.shiftKey) {\n      // Shift forces a refocus - bring this to the top\n      outlineRefocus(p, subject, pane)\n    } else {\n      if (e.altKey) {\n        // To investigate screw ups, dont wait show internals\n        outlineExpand(p, subject, {\n          pane: paneRegistry.byName('internal'),\n          immediate: true\n        })\n      } else {\n        outlineExpand(p, subject)\n      }\n    }\n  }\n\n  function collapseMouseDownListener (e) {\n    // for icon UI.icons.originalIconBase + 'tbl-collapse.png'\n    const target = thisOutline.targetOf(e)\n    const subject = UI.utils.getAbout(kb, target)\n    const pane = e.altKey ? paneRegistry.byName('internal') : undefined\n    const p = target.parentNode.parentNode\n    outlineCollapse(p, subject, pane)\n  }\n\n  function failedIconMouseDownListener (e) {\n    // outlineIcons.src.icon_failed\n    const target = thisOutline.targetOf(e)\n    const uri = target.getAttribute('uri') // Put on access buttons\n    if (e.altKey) {\n      sf.fetch($rdf.uri.docpart(uri), {\n        force: true\n      }) // Add 'force' bit?\n    } else {\n      sf.refresh(kb.sym($rdf.uri.docpart(uri))) // just one\n    }\n  }\n\n  function fetchedIconMouseDownListener (e) {\n    // outlineIcons.src.icon_fetched\n    const target = thisOutline.targetOf(e)\n    const uri = target.getAttribute('uri') // Put on access buttons\n    if (e.altKey) {\n      sf.fetch($rdf.uri.docpart(uri), {\n        force: true\n      })\n    } else {\n      sf.refresh(kb.sym($rdf.uri.docpart(uri))) // just one\n    }\n  }\n\n  function unrequestedIconMouseDownListener (e) {\n    const target = thisOutline.targetOf(e)\n    const uri = target.getAttribute('uri') // Put on access buttons\n    sf.fetch($rdf.uri.docpart(uri))\n  }\n\n  function removeNodeIconMouseDownListener (e) {\n    // icon_remove_node\n    const target = thisOutline.targetOf(e)\n    let node = target.node\n    if (node.childNodes.length > 1) node = target.parentNode // parallel outline view @@ Hack\n    removeAndRefresh(node) // @@ update icons for pane?\n  }\n\n  function selectableTDClickListener (e) {\n    // Is we are in editing mode already\n    if (thisOutline.UserInput._tabulatorMode) {\n      return thisOutline.UserInput.Click(e)\n    }\n\n    const target = thisOutline.targetOf(e)\n    // Originally this was set on the whole tree and could happen anywhere\n    // var p = target.parentNode\n    let node\n    for (\n      node = UI.utils.ancestor(target, 'TD');\n      node && !(node.getAttribute('notSelectable') === 'false'); // Default now is not selectable\n      node = UI.utils.ancestor(node.parentNode, 'TD')\n    ) {\n      // ...\n    }\n    if (!node) return\n\n    // var node = target;\n\n    const sel = selected(node)\n    // var cla = node.getAttribute('class')\n    UI.log.debug('Was node selected before: ' + sel)\n    if (e.altKey) {\n      setSelected(node, !selected(node))\n    } else if (e.shiftKey) {\n      setSelected(node, true)\n    } else {\n      // setSelected(node, !selected(node))\n      deselectAll()\n      thisOutline.UserInput.clearInputAndSave(e)\n      setSelected(node, true)\n\n      if (e.detail === 2) {\n        // double click -> quit TabulatorMousedown()\n        e.stopPropagation()\n        return\n      }\n      // if the node is already selected and the corresponding statement is editable,\n      // go to UserInput\n      let st\n      if (node.parentNode) st = node.parentNode.AJAR_statement\n      if (!st) return // For example in the title TD of an expanded pane\n      const target = st.why\n      const editable = store.updater.editable(target.uri, kb)\n      if (sel && editable) thisOutline.UserInput.Click(e, selection[0]) // was next 2 lines\n      // var text='TabulatorMouseDown@Outline()';\n      // HCIoptions['able to edit in Discovery Mode by mouse'].setupHere([sel,e,thisOutline,selection[0]],text);\n    }\n    UI.log.debug(\n      'Was node selected after: ' +\n        selected(node) +\n        ', count=' +\n        selection.length\n    )\n    // var tr = node.parentNode\n    /*\n    if (tr.AJAR_statement) {\n      // var why = tr.AJAR_statement.why\n        // UI.log.info('Information from '+why);\n    }\n    */\n    e.stopPropagation()\n    // this is important or conflict between deselect and user input happens\n  }\n\n  function TabulatorMousedown (e) {\n    UI.log.info('@TabulatorMousedown, dom.location is now ' + dom.location)\n    const target = thisOutline.targetOf(e)\n    if (!target) return\n    const tname = target.tagName\n    // UI.log.debug('TabulatorMousedown: ' + tname + ' shift='+e.shiftKey+' alt='+e.altKey+' ctrl='+e.ctrlKey);\n    // var p = target.parentNode\n    // var about = UI.utils.getAbout(kb, target)\n    // var source = null\n    if (tname === 'INPUT' || tname === 'TEXTAREA') {\n      return\n    }\n\n    // not input then clear\n    thisOutline.UserInput.clearMenu()\n\n    // ToDo:remove this and recover X\n    if (\n      thisOutline.UserInput.lastModified &&\n      thisOutline.UserInput.lastModified.parentNode.nextSibling\n    ) {\n      thisOutline.UserInput.backOut()\n    }\n\n    // if (typeof rav=='undefined') //uncomment this for javascript2rdf\n    // have to put this here or this conflicts with deselectAll()\n\n    if (\n      !target.src ||\n      (target.src.slice(target.src.indexOf('/icons/') + 1) !==\n        outlineIcons.src.icon_show_choices &&\n        target.src.slice(target.src.indexOf('/icons/') + 1) !==\n          outlineIcons.src.icon_add_triple)\n    ) {\n      thisOutline.UserInput.clearInputAndSave(e)\n    }\n\n    if (\n      !target.src ||\n      target.src.slice(target.src.indexOf('/icons/') + 1) !==\n        outlineIcons.src.icon_show_choices\n    ) {\n      thisOutline.UserInput.clearMenu()\n    }\n\n    if (e) e.stopPropagation()\n  } // function TabulatorMousedown\n\n  function setUrlBarAndTitle (subject) {\n    dom.title = UI.utils.label(subject)\n    if (dom.location.href.startsWith(subject.site().uri)) {\n      // dom.location = subject.uri  // No causes reload\n    }\n  }\n\n  /** Expand an outline view\n   * @param p {Element} - container\n   */\n  function outlineExpand (p, subject1, options) {\n    options = options || {}\n    const pane = options.pane\n    let already = !!options.already\n    const immediate = options.immediate\n\n    UI.log.info('@outlineExpand, dom is now ' + dom.location)\n    // remove callback to prevent unexpected repaint\n    sf.removeCallback('done', 'expand')\n    sf.removeCallback('fail', 'expand')\n\n    let subject = kb.canon(subject1)\n    // var requTerm = subject.uri ? kb.sym($rdf.uri.docpart(subject.uri)) : subject\n\n    function render () {\n      subject = kb.canon(subject)\n      if (!p || !p.parentNode || !p.parentNode.parentNode) return false\n\n      let newTable\n      UI.log.info('@@ REPAINTING ')\n      if (!already) {\n        // first expand\n        newTable = propertyTable(subject, undefined, pane, options)\n      } else {\n        UI.log.info(' ... p is  ' + p)\n        for (\n          newTable = p.firstChild;\n          newTable.nextSibling;\n          newTable = newTable.nextSibling\n        ) {\n          UI.log.info(' ... checking node ' + newTable)\n          if (newTable.nodeName === 'table') break\n        }\n        newTable = propertyTable(subject, newTable, pane, options)\n      }\n      already = true\n      if (\n        UI.utils.ancestor(p, 'TABLE') &&\n        UI.utils.ancestor(p, 'TABLE').style.backgroundColor === 'white'\n      ) {\n        newTable.style.backgroundColor = '#eee'\n      } else {\n        newTable.style.backgroundColor = 'white'\n      }\n      UI.utils.emptyNode(p).appendChild(newTable)\n      thisOutline.focusTd = p // I don't know why I couldn't use 'this'...because not defined in callbacks\n      UI.log.debug('expand: Node for ' + subject + ' expanded')\n      // fetch seeAlso when render()\n      // var seeAlsoStats = sf.store.statementsMatching(subject, UI.ns.rdfs('seeAlso'))\n      // seeAlsoStats.map(function (x) {sf.lookUpThing(x.object, subject,false);})\n      const seeAlsoWhat = kb.each(subject, UI.ns.rdfs('seeAlso'))\n      for (let i = 0; i < seeAlsoWhat.length; i++) {\n        if (i === 25) {\n          UI.log.warn(\n            'expand: Warning: many (' +\n              seeAlsoWhat.length +\n              ') seeAlso links for ' +\n              subject\n          )\n          // break; Not sure what limits the AJAX system has here\n        }\n        sf.lookUpThing(seeAlsoWhat[i], subject)\n      }\n    }\n\n    function expand (uri) {\n      if (arguments[3]) return true // already fetched indicator\n      const cursubj = kb.canon(subject) // canonical identifier may have changed\n      UI.log.info(\n        '@@ expand: relevant subject=' +\n          cursubj +\n          ', uri=' +\n          uri +\n          ', already=' +\n          already\n      )\n      // var term = kb.sym(uri)\n      const docTerm = kb.sym($rdf.uri.docpart(uri))\n      if (uri.indexOf('#') >= 0) {\n        throw new Error('Internal error: hash in ' + uri)\n      }\n\n      const relevant = function () {\n        // Is the loading of this URI relevam to the display of subject?\n        if (!cursubj.uri) return true // bnode should expand()\n        const as = kb.uris(cursubj)\n        if (!as) return false\n        for (let i = 0; i < as.length; i++) {\n          // canon'l uri or any alias\n          for (\n            let rd = $rdf.uri.docpart(as[i]);\n            rd;\n            rd = kb.HTTPRedirects[rd]\n          ) {\n            if (uri === rd) return true\n          }\n        }\n        if (kb.anyStatementMatching(cursubj, undefined, undefined, docTerm)) {\n          return true\n        } // Kenny: inverse?\n        return false\n      }\n      if (relevant()) {\n        UI.log.success(\n          '@@ expand OK: relevant subject=' +\n            cursubj +\n            ', uri=' +\n            uri +\n            ', source=' +\n            already\n        )\n\n        render()\n        return false //  @@@@@@@@@@@ Will this allow just the first\n      }\n      return true\n    }\n    // Body of outlineExpand\n\n    if (options.solo) {\n      setUrlBarAndTitle(subject)\n    }\n    UI.log.debug('outlineExpand: dereferencing ' + subject)\n    const status = dom.createElement('span')\n    p.appendChild(status)\n    sf.addCallback('done', expand) // @@@@@@@ This can really mess up existing work\n    sf.addCallback('fail', expand) // Need to do if there s one a gentle resync of page with store\n\n    const returnConditions = [] // this is quite a general way to do cut and paste programming\n    // I might make a class for this\n    if (subject.uri && subject.uri.split(':')[0] === 'rdf') {\n      // what is this? -tim\n      render()\n      return\n    }\n\n    for (let i = 0; i < returnConditions.length; i++) {\n      let returnCode\n      if (returnCode === returnConditions[i](subject)) {\n        render()\n        UI.log.debug('outline 1815')\n        if (returnCode[1]) outlineElement.removeChild(outlineElement.lastChild)\n        return\n      }\n    }\n    if (\n      subject.uri &&\n      !immediate &&\n      !UI.widgets.isAudio(subject) &&\n      !UI.widgets.isVideo(subject)\n    ) {\n      // Wait till at least the main URI is loaded before expanding:\n      sf.nowOrWhenFetched(subject.doc(), undefined, function (ok, body) {\n        if (ok) {\n          sf.lookUpThing(subject)\n          render() // inital open, or else full if re-open\n          if (options.solo) {\n            // Update window title with new information\n            // dom.title = UI.utils.label(subject)\n            setUrlBarAndTitle(subject)\n          }\n        } else {\n          const message = dom.createElement('pre')\n          message.textContent = body\n          message.setAttribute('style', 'background-color: #fee;')\n          message.textContent =\n            'Outline.expand: Unable to fetch ' + subject.doc() + ': ' + body\n          p.appendChild(message)\n        }\n      })\n    } else {\n      render()\n    }\n  } // outlineExpand\n\n  function outlineCollapse (p, subject) {\n    let row = UI.utils.ancestor(p, 'TR')\n    row = UI.utils.ancestor(row.parentNode, 'TR') // two levels up\n    let statement\n    if (row) statement = row.AJAR_statement\n    let level // find level (the enclosing TD)\n    for (\n      level = p.parentNode;\n      level.tagName !== 'TD';\n      level = level.parentNode\n    ) {\n      if (typeof level === 'undefined') {\n        alert('Not enclosed in TD!')\n        return\n      }\n    }\n\n    UI.log.debug('Collapsing subject ' + subject)\n    let myview\n    if (statement) {\n      UI.log.debug('looking up pred ' + statement.predicate.uri + 'in defaults')\n      myview = views.defaults[statement.predicate.uri]\n    }\n    UI.log.debug('view= ' + myview)\n    let deleteNode\n    if (level.parentNode.parentNode.id === 'outline') {\n      deleteNode = level.parentNode\n    }\n    thisOutline.replaceTD(\n      thisOutline.outlineObjectTD(subject, myview, deleteNode, statement),\n      level\n    )\n  } // outlineCollapse\n\n  this.replaceTD = function replaceTD (newTd, replacedTd) {\n    let reselect\n    if (selected(replacedTd)) reselect = true\n\n    // deselects everything being collapsed. This goes backwards because\n    // deselecting an element decreases selection.length\n    for (let x = selection.length - 1; x > -1; x--) {\n      for (let elt = selection[x]; elt.parentNode; elt = elt.parentNode) {\n        if (elt === replacedTd) {\n          setSelected(selection[x], false)\n        }\n      }\n    }\n\n    replacedTd.parentNode.replaceChild(newTd, replacedTd)\n    if (reselect) setSelected(newTd, true)\n  }\n\n  function outlineRefocus (p, subject) {\n    // Shift-expand or shift-collapse: Maximize\n    let outer = null\n    for (let level = p.parentNode; level; level = level.parentNode) {\n      UI.log.debug('level ' + level.tagName)\n      if (level.tagName === 'TD') outer = level\n    } // find outermost td\n    UI.utils.emptyNode(outer).appendChild(propertyTable(subject))\n    setUrlBarAndTitle(subject)\n    // dom.title = UI.utils.label(subject)\n    outer.setAttribute('about', subject.toNT())\n  } // outlineRefocus\n\n  outline.outlineRefocus = outlineRefocus\n\n  // Inversion is turning the outline view inside-out\n  // It may be called eversion\n  /*\n  function outlineInversion (p, subject) { // re-root at subject\n    function move_root (rootTR, childTR) { // swap root with child\n      // @@\n    }\n  }\n*/\n  this.GotoFormURI_enterKey = function (e) {\n    if (e.keyCode === 13) outline.GotoFormURI(e)\n  }\n  this.GotoFormURI = function (_e) {\n    GotoURI(dom.getElementById('UserURI').value)\n  }\n\n  function GotoURI (uri) {\n    const subject = kb.sym(uri)\n    this.GotoSubject(subject, true)\n  }\n  this.GotoURIinit = function (uri) {\n    const subject = kb.sym(uri)\n    this.GotoSubject(subject)\n  }\n\n  /** Display the subject in an outline view\n\n  @param subject -- RDF term for teh thing to be presented\n  @param expand  -- flag -- open the subject rather than keep folded closed\n  @param pane    -- optional -- pane to be used for expanded display\n  @param solo    -- optional -- the window will be cleared out and only the subject displayed\n  @param referer -- optional -- where did we hear about this from anyway?\n  @param table   -- option  -- a table element in which to put the outline.\n*/\n  this.GotoSubject = function (subject, expand, pane, solo, referrer, table) {\n    table = table || dom.getElementById('outline') // if does not exist just add one? nowhere to out it\n    if (solo) {\n      UI.utils.emptyNode(table)\n      table.style.width = '100%'\n    }\n\n    function GotoSubjectDefault () {\n      const tr = dom.createElement('TR')\n      tr.style.verticalAlign = 'top'\n      table.appendChild(tr)\n      const td = thisOutline.outlineObjectTD(subject, undefined, tr)\n      tr.appendChild(td)\n      return td\n    }\n\n    const td = GotoSubjectDefault()\n\n    if (solo) setUrlBarAndTitle(subject) // dom.title = UI.utils.label(subject) // 'Tabulator: '+  No need to advertize\n\n    if (expand) {\n      outlineExpand(td, subject, {\n        pane,\n        solo\n      })\n      const tr = td.parentNode\n      UI.utils.getEyeFocus(tr, false, undefined, window) // instantly: false\n    }\n\n    if (\n      solo &&\n      dom &&\n      dom.defaultView &&\n      dom.defaultView.history &&\n      // Don't add the new location to the history if we arrived here through a direct link\n      // (i.e. when static/databrowser.html in node-solid-server called this method):\n      document.location.href !== subject.uri\n    ) {\n      const stateObj = pane ? { paneName: pane.name } : {}\n      try {\n        // can fail if different origin\n        dom.defaultView.history.pushState(stateObj, subject.uri, subject.uri)\n      } catch (e) {\n        console.log(e)\n      }\n    }\n\n    return subject\n  }\n\n  // / /////////////////////////////////////////////////////\n  //\n  //\n  //                    VIEWS\n  //\n  //\n  // / /////////////////////////////////////////////////////\n\n  const ns = UI.ns\n\n  const views = propertyViews(dom)\n\n  // var thisOutline = this   dup\n  /** some builtin simple views **/\n\n  function viewAsBoringDefault (obj) {\n    // UI.log.debug('entered viewAsBoringDefault...');\n    let rep // representation in html\n\n    if (obj.termType === 'Literal') {\n      const styles = {\n        integer: 'text-align: right;',\n        decimal: 'text-align: \\'.\\';',\n        double: 'text-align: \\'.\\';'\n      }\n      rep = dom.createElement('span')\n      rep.textContent = obj.value\n      // Newlines have effect and overlong lines wrapped automatically\n      let style = ''\n      if (obj.datatype && obj.datatype.uri) {\n        const xsd = UI.ns.xsd('').uri\n        if (obj.datatype.uri.slice(0, xsd.length) === xsd) {\n          style = styles[obj.datatype.uri.slice(xsd.length)]\n        }\n      }\n      rep.setAttribute('style', style || 'white-space: pre-wrap;')\n    } else if (obj.termType === 'NamedNode' || obj.termType === 'BlankNode') {\n      rep = dom.createElement('span')\n      rep.setAttribute('about', obj.toNT())\n      thisOutline.appendAccessIcons(kb, rep, obj)\n\n      if (obj.termType === 'NamedNode') {\n        if (obj.uri.slice(0, 4) === 'tel:') {\n          const num = obj.uri.slice(4)\n          const anchor = dom.createElement('a')\n          rep.appendChild(dom.createTextNode(num))\n          anchor.setAttribute('href', obj.uri)\n          anchor.appendChild(\n            UI.utils.AJARImage(\n              outlineIcons.src.icon_telephone,\n              'phone',\n              'phone ' + num,\n              dom\n            )\n          )\n          rep.appendChild(anchor)\n          anchor.firstChild.setAttribute('class', 'phoneIcon')\n        } else {\n          // not tel:\n          rep.appendChild(dom.createTextNode(UI.utils.label(obj)))\n          const anchor = UI.widgets.linkIcon(dom, obj)\n          rep.appendChild(anchor)\n          UI.widgets.makeDraggable(rep, obj) // 2017\n        }\n      } else {\n        // bnode\n        rep.appendChild(dom.createTextNode(UI.utils.label(obj)))\n      }\n    } else if (obj.termType === 'Collection') {\n      // obj.elements is an array of the elements in the collection\n      rep = dom.createElement('table')\n      rep.setAttribute('style', 'width: 100%;')\n      rep.setAttribute('about', obj.toNT())\n      /* Not sure which looks best -- with or without. I think without\n\n                var tr = rep.appendChild(document.createElement('tr'));\n                tr.appendChild(document.createTextNode(\n                        obj.elements.length ? '(' + obj.elements.length+')' : '(none)'));\n        */\n      for (let i = 0; i < obj.elements.length; i++) {\n        const elt = obj.elements[i]\n        const row = rep.appendChild(dom.createElement('tr'))\n        const numcell = row.appendChild(dom.createElement('td'))\n        numcell.setAttribute(\n          'style',\n          'margin: 0.2em; border: none; padding: 0; vertical-align: top;'\n        )\n        numcell.setAttribute('notSelectable', 'false')\n        numcell.setAttribute('about', obj.toNT())\n        numcell.innerHTML = i + 1 + ')'\n        row.appendChild(thisOutline.outlineObjectTD(elt))\n      }\n    } else if (obj.termType === 'Graph') {\n      rep = paneRegistry\n        .byName('dataContentPane')\n        .statementsAsTables(obj.statements, context)\n      rep.setAttribute('class', 'nestedFormula')\n    } else {\n      UI.log.error('Object ' + obj + ' has unknown term type: ' + obj.termType)\n      rep = dom.createTextNode('[unknownTermType:' + obj.termType + ']')\n    } // boring defaults.\n    UI.log.debug('contents: ' + rep.innerHTML)\n    return rep\n  } // boring_default\n\n  this.createTabURI = function () {\n    dom.getElementById('UserURI').value =\n      dom.URL + '?uri=' + dom.getElementById('UserURI').value\n  }\n\n  // a way to expose variables to UserInput without making them propeties/methods\n  this.UserInput.setSelected = setSelected\n  this.UserInput.deselectAll = deselectAll\n  this.UserInput.views = views\n  this.outlineExpand = outlineExpand\n\n  // this.panes = panes; // Allow external panes to register\n\n  return this\n} // END OF OUTLINE\n"],"mappings":"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","ignoreList":[]}