{"version":3,"file":"userInput.js","names":["UI","store","panes","$rdf","UserInputFormula","TempFormula","UserInput","outline","myDocument","document","menuId","qp","str","console","log","rdf","ns","bibo","Namespace","dcelems","movedArrow","Formula","superFormula","IndexedFormula","name","updater","UpdateManager","sparqler","lastModified","lastModifiedStat","statIsInverse","addNewPredicateObject","e","utils","getTarget","className","This","target","insertTr","createElement","ancestor","insertBefore","tempTr","reqTerm1","generateRequest","appendChild","firstChild","reqTerm2","previousSibling","AJAR_statement","preStat","formUndetStat","subject","why","getAbout","parentNode","doc","sym","Util","uri","docpart","walk","info","getSelection","map","item","textContent","join","startFillInText","addNewObject","predicateTd","isInverse","AJAR_inverse","appendToPredicate","reqTerm","predicate","object","lastChild","Delete","selectedTd","deleteTriple","Enter","literalModification","Click","getTerm","termType","preventDefault","stopPropagation","pasteFromClipboard","address","termFrom","fromCode","term","clipboard","shift","warn","allArray","all","i","sameTerm","splice","Error","nextSibling","returnArray","insertTermTo","whatSortOfEditCell","emptyNode","createInputBoxIn","isNew","select","performAutoCompleteEdit","debug","indexOf","about","getStatementAbout","obj","trNode","error","tdNode","removeChild","value","match","textBox","createTextNode","setAttribute","length","toString","menu","addEventListener","getAutoCompleteHandler","backOut","clearMenu","getElementById","menuID","clearInputAndSave","s","defaultpropview","defaultValue","trCache","Statement","literal","views","defaults","update","success","errorBody","add","s1","s2","s3","valueCache","oldValue","st","replace","textTerm","selectedPredicate","elements","any","undefined","pageX","findPos","pageY","clientHeight","showMenu","dialogTerm","bnodeTerm","type","the","anyStatementMatching","remove","enclosingTd","defaultPane","byName","outlineExpand","pane","already","focusTd","fillInRequest","removeMany","upperTr","replaceTD","outlineObjectTD","isBackOut","whether","link","removefromview","removedTr","trIterator","childNodes","theNext","parseInt","getAttribute","clipboardInit","objects","predicates","copyToClipboard","unshift","isObject","AJAR_statemnet","stackString","statements","push","paneDiv","newTr","outlinePredicateTD","Refill","isPredicate","predicateQuery","subjectClass","sparqlText","endl","rdfs","variable","SPARQLToQuery","predicateTerm","owl","classQuery","mode","InputBox","enterEvent","setHighlightItem","lastHighlight","showURI","newText","keyCode","tagName","createNew","inputURI","jtitle","innerHTML","juri","slice","inputTerm","fillInType","String","fromCharCode","charCode","inputText","WildCardButtons","menuDiv","div","input1","input2","highlightInput","Keypress","targetOf","preRows","Mousedown","window","ctrlKey","switchMode","oncontextmenu","button","Mouseover","_tabulatorMode","preTd","style","cursor","border","borderColor","Mouseout","something","statement","defaultText","UpAndDown","OutlinerKeypressPanel","location","inputBox","_e","targetdoc","newTerm","nextSymbol","tiptext","typeURIhandler","newuri","isEnd","colspan","display","hasAttribute","table","bnode2symbol","bnode","symbol","copyTo","tipText","trNew","notShow","tp","newNode","menuType","inputQuery","extraInformation","_order","x","id","top","left","getOffset","el","_lf","_tp","oldlf","oldtp","newlf","newtp","isNaN","offsetLeft","offsetTop","scrollLeft","scrollTop","loc","body","highlightTr","selectItem","IDpredicate","IDterm","clickedTd","predicateChoices","tr","newTd","NameSpaces","each","forEach","ontology","label","addMenuItem","Label","predicateLabelForXML","theNamespace","string_startswith","th","toUpperCase","addPredicateChoice","selectedQuery","bindings","vars","width","h1","h1th","plist","statementsMatching","text","h2","h2th","ans1","ans2","labeller","searchAdv","results","tempQuery","tempBinding","Kenny","fromNT","NT","entries","search","types","thisNT","toNT","typeLabel","juris","matchedtitle","jtstr","matchstr","toLowerCase","jTitleLowerCase","choiceTerm","choices","nullFetcher","constructor","query","stat","newStat","doNext","eventhandler","_errorBody","newStats","inverse"],"sources":["../../src/outline/userInput.js"],"sourcesContent":["/* istanbul ignore file */\n// Original author: kennyluck\n//\n// Kenny's Notes:\n/* places to generate SPARQL update: clearInputAndSave() pasteFromClipboard()->insertTermTo();\n                                  undetermined statement generated formUndetStat()\n                                                                 ->fillInRequest()\n   ontological issues\n    temporarily using the tabont namespace\n    clipboard: 'predicates' 'objects' 'all'(internal)\n    request: 'from' 'to' 'message' 'Request'\n*/\n\nimport * as UI from 'solid-ui-jss'\nimport { store } from 'solid-logic-jss'\nimport * as panes from 'pane-registry'\nimport * as $rdf from 'rdflib'\n\nlet UserInputFormula // Formula to store references of user's work\nlet TempFormula // Formula to store incomplete triples (Requests),\n// temporarily disjoint with kb to avoid bugs\n\nexport function UserInput (outline) {\n  const myDocument = outline.document // is this ok?\n  // UI.log.warn(\"myDocument when it's set is \"+myDocument.location);\n  this.menuId = 'predicateMenu1'\n\n  /* //namespace information, as a subgraph of the knowledge base, is built in showMenu\n    this.namespaces={};\n\n    for (var name in UI.ns) {\n        this.namespaces[name] = UI.ns[name]('').uri;\n    }\n    var NameSpaces=this.namespaces;\n    */\n\n  // hq, print and trim functions\n  const qp = function qp (str) {\n    console.log(str + '\\n')\n  }\n\n  // var tabont = UI.ns.tabont;\n  // var foaf = UI.ns.foaf\n  const rdf = UI.ns.rdf\n  // var RDFS = UI.ns.rdfs\n  // var OWL = UI.ns.owl\n  // var dc = UI.ns.dc\n  // var rss = UI.ns.rss\n  // var contact = UI.ns.contact\n  // var mo = UI.ns.mo\n  const bibo = $rdf.Namespace('http://purl.org/ontology/bibo/') // hql for pubsPane\n  // var dcterms = $rdf.Namespace('http://purl.org/dc/terms/')\n  const dcelems = $rdf.Namespace('http://purl.org/dc/elements/1.1/')\n\n  let movedArrow = false // hq\n\n  // var updateService=new updateCenter(kb);\n\n  if (!UserInputFormula) {\n    UserInputFormula = new $rdf.Formula()\n    UserInputFormula.superFormula = store\n    // UserInputFormula.registerFormula(\"Your Work\");\n  }\n  if (!TempFormula) TempFormula = new $rdf.IndexedFormula()\n  // Use RDFIndexedFormula so add returns the statement\n  TempFormula.name = 'TempFormula'\n  if (!store.updater) store.updater = new $rdf.UpdateManager(store)\n\n  return {\n    // updateService: updateService,\n\n    sparqler: store.updater,\n    lastModified: null, // the last <input> being modified, .isNew indicates whether it's a new input\n    lastModifiedStat: null, // the last statement being modified\n    statIsInverse: false, // whether the statement is an inverse\n\n    /**\n     *  Triggering Events: event entry points, should be called only from outline.js but not anywhere else\n     *                     in userinput.js, should be as short as possible, function names to be discussed\n     */\n\n    //  Called when the blue cross under the default pane is clicked.\n    //  Add a new row to a property list ( P and O)\n    addNewPredicateObject: function addNewPredicateObject (e) {\n      if (UI.utils.getTarget(e).className !== 'bottom-border-active') return\n      const This = outline.UserInput\n      const target = UI.utils.getTarget(e)\n\n      // UI.log.warn(ancestor(target,'TABLE').textContent);\n      const insertTr = myDocument.createElement('tr')\n      UI.utils\n        .ancestor(target, 'DIV')\n        .insertBefore(insertTr, UI.utils.ancestor(target, 'TR'))\n      const tempTr = myDocument.createElement('tr')\n      const reqTerm1 = This.generateRequest('(TBD)', tempTr, true)\n      insertTr.appendChild(tempTr.firstChild)\n      const reqTerm2 = This.generateRequest(\n        '(Enter text or drag an object onto this field)',\n        tempTr,\n        false\n      )\n      insertTr.appendChild(tempTr.firstChild)\n      // there should be an elegant way of doing this\n\n      // Take the why of the last TR and write to it.\n      if (\n        UI.utils.ancestor(target, 'TR').previousSibling && // there is a previous predicate/object line\n        UI.utils.ancestor(target, 'TR').previousSibling.AJAR_statement\n      ) {\n        const preStat = UI.utils.ancestor(target, 'TR').previousSibling\n          .AJAR_statement\n        // This should always(?) input a non-inverse statement\n        This.formUndetStat(\n          insertTr,\n          preStat.subject,\n          reqTerm1,\n          reqTerm2,\n          preStat.why,\n          false\n        )\n      } else {\n        // no previous row: write to the document defining the subject\n        const subject = UI.utils.getAbout(\n          store,\n          UI.utils.ancestor(target.parentNode.parentNode, 'TD')\n        )\n        const doc = store.sym($rdf.Util.uri.docpart(subject.uri))\n        This.formUndetStat(insertTr, subject, reqTerm1, reqTerm2, doc, false)\n      }\n\n      outline.walk('moveTo', insertTr.firstChild)\n      UI.log.info(\n        'addNewPredicateObject: selection = ' +\n          outline\n            .getSelection()\n            .map(function (item) {\n              return item.textContent\n            })\n            .join(', ')\n      )\n      this.startFillInText(outline.getSelection()[0])\n    },\n\n    //  Called when a blue cross on a predicate is clicked\n    //  tr.AJAR_inverse stores whether the clicked predicate is an inverse one\n    //  tr.AJAR_statement (an incomplete statement in TempFormula) stores the destination(why), now\n    //  determined by the preceding one (is this good?)\n    addNewObject: function addNewObject (e) {\n      const predicateTd = UI.utils.getTarget(e).parentNode.parentNode\n      // var predicateTerm = UI.utils.getAbout(kb, predicateTd)\n      const isInverse = predicateTd.parentNode.AJAR_inverse\n      // var titleTerm=UI.utils.getAbout(kb,UI.utils.ancestor(predicateTd.parentNode,'TD'));\n      // set pseudo lastModifiedStat here\n      this.lastModifiedStat = predicateTd.parentNode.AJAR_statement\n\n      const insertTr = this.appendToPredicate(predicateTd)\n      const reqTerm = this.generateRequest(' (Error) ', insertTr, false)\n      const preStat = insertTr.previousSibling.AJAR_statement\n      if (!isInverse) {\n        this.formUndetStat(\n          insertTr,\n          preStat.subject,\n          preStat.predicate,\n          reqTerm,\n          preStat.why,\n          false\n        )\n      } else {\n        this.formUndetStat(\n          insertTr,\n          reqTerm,\n          preStat.predicate,\n          preStat.object,\n          preStat.why,\n          true\n        )\n      }\n\n      outline.walk('moveTo', insertTr.lastChild)\n      this.startFillInText(insertTr.lastChild)\n      // this.statIsInverse=false;\n    },\n\n    //  Called when delete is pressed\n    Delete: function Delete (selectedTd) {\n      this.deleteTriple(selectedTd, false)\n    },\n    //  Called when enter is pressed\n    Enter: function Enter (selectedTd) {\n      this.literalModification(selectedTd)\n    },\n    //  Called when a selected cell is clicked again\n    Click: function Click (e) {\n      const target = UI.utils.getTarget(e)\n      if (UI.utils.getTerm(target).termType !== 'Literal') return\n      this.literalModification(target)\n      // this prevents the generated inputbox to be clicked again\n      e.preventDefault()\n      e.stopPropagation()\n    },\n    //  Called when paste is called (Ctrl+v)\n    pasteFromClipboard: function pasteFromClipboard (address, selectedTd) {\n      function termFrom (fromCode) {\n        const term = outline.clipboard[fromCode].shift()\n        if (term === null) {\n          UI.log.warn('no more element in clipboard!')\n          return\n        }\n        switch (fromCode) {\n          case 'predicates':\n          case 'objects': {\n            const allArray = outline.clipboard.all\n            for (let i = 0; true; i++) {\n              if (term.sameTerm(allArray[i])) {\n                allArray.splice(i, 1)\n                break\n              }\n            }\n            break\n          }\n          case 'all':\n            throw new Error(\n              'hostorical code not understood - what is theCollection?'\n            )\n          /*\n            var isObject = term.sameTerm(theCollection('objects').elements[0])\n            isObject ? outline.clipboard.objecs.shift() : outline.clipboard.predicates.shift() // drop the corresponding term\n            return [term, isObject]\n            break\n            */\n        }\n        return term\n      }\n      let term\n      switch (selectedTd.className) {\n        case 'undetermined selected':\n          term = selectedTd.nextSibling\n            ? termFrom('predicates')\n            : termFrom('objects')\n          if (!term) return\n          break\n        case 'pred selected': // paste objects into this predicate\n          term = termFrom('objects')\n          if (!term) return\n          break\n        case 'selected': { // header <TD>, undetermined generated\n          const returnArray = termFrom('all')\n          if (!returnArray) return\n          term = returnArray[0]\n          this.insertTermTo(selectedTd, term, returnArray[1])\n          return\n        }\n      }\n      this.insertTermTo(selectedTd, term)\n    },\n\n    /**\n     *  Intermediate Processing:\n     */\n\n    // a general entry point for any event except Click&Enter(goes to literalModification)\n    // do a little inference to pick the right input box\n    startFillInText: function startFillInText (selectedTd) {\n      switch (this.whatSortOfEditCell(selectedTd)) {\n        case 'DatatypeProperty-like':\n          // this.clearMenu();\n          // selectedTd.className='';\n          UI.utils.emptyNode(selectedTd)\n          this.lastModified = this.createInputBoxIn(\n            selectedTd,\n            ' (Please Input) '\n          )\n          this.lastModified.isNew = false\n\n          this.lastModified.select()\n          break\n        case 'predicate':\n          // the goal is to bring back all the menus (with autocomplete functionality\n          // this.performAutoCompleteEdit(selectedTd,['PredicateAutoComplete',\n          //                        this.choiceQuery('SuggestPredicateByDomain')]);\n          this.performAutoCompleteEdit(selectedTd, 'PredicateAutoComplete')\n          break\n        case 'ObjectProperty-like':\n        case 'no-idea':\n          // menu should be either function that\n          this.performAutoCompleteEdit(selectedTd, 'GeneralAutoComplete')\n\n        /*\n                //<code time=\"original\">\n                emptyNode(selectedTd);\n                this.lastModified=this.createInputBoxIn(selectedTd,\"\");\n                this.lastModified.select();\n                this.lastModified.addEventListener('keypress',this.AutoComplete,false);\n                //this pops up the autocomplete menu\n                this.AutoComplete(1);\n                //</code>\n                */\n      }\n    },\n\n    literalModification: function literalModification (selectedTd) {\n      UI.log.debug(\n        'entering literal Modification with ' +\n          selectedTd +\n          selectedTd.textContent\n      )\n      // var This=outline.UserInput;\n      if (selectedTd.className.indexOf(' pendingedit') !== -1) {\n        UI.log.warn(\n          'The node you attempted to edit has a request still pending.\\n' +\n            'Please wait for the request to finish (the text will turn black)\\n' +\n            'before editing this node again.'\n        )\n        return true\n      }\n\n      const target = selectedTd\n      const about = this.getStatementAbout(target) // timbl - to avoid alert from random clicks\n      if (!about) return\n      let obj\n      let trNode\n      try {\n        obj = UI.utils.getTerm(target)\n        trNode = UI.utils.ancestor(target, 'TR')\n      } catch (e) {\n        UI.log.warn('userinput.js: ' + e + UI.utils.getAbout(store, selectedTd))\n        UI.log.error(target + ' getStatement Error:' + e)\n      }\n\n      let tdNode\n      try {\n        tdNode = trNode.lastChild\n      } catch (e) {\n        UI.log.error(e + '@' + target)\n      }\n      // seems to be a event handling problem of firefox3\n      /*\n        if (e.type!='keypress'&&(selectedTd.className=='undetermined selected'||selectedTd.className=='undetermined')){\n            this.Refill(e,selectedTd);\n            return;\n        }\n        */\n      // ignore clicking trNode.firstChild (be careful for <div> or <span>)\n      // if (e.type!='keypress'&&target!=tdNode && UI.utils.ancestor(target,'TD')!=tdNode) return;\n\n      if (obj.termType === 'Literal') {\n        tdNode.removeChild(tdNode.firstChild) // remove the text\n\n        if (obj.value.match('\\n')) {\n          // match a line feed and require <TEXTAREA>\n          const textBox = myDocument.createElement('textarea')\n          textBox.appendChild(myDocument.createTextNode(obj.value))\n          textBox.setAttribute(\n            'rows',\n            (obj.value.match(/\\n/g).length + 1).toString()\n          )\n          // g is for global(??)\n          textBox.setAttribute('cols', '100') // should be the size of <TD>\n          textBox.setAttribute('class', 'textinput')\n          tdNode.appendChild(textBox)\n          this.lastModified = textBox\n        } else {\n          this.lastModified = this.createInputBoxIn(tdNode, obj.value)\n        }\n        this.lastModified.isNew = false\n        // Kenny: What should be expected after you click a editable text element?\n        // Choice 1\n        this.lastModified.select()\n        // Choice 2 - direct the key cursor to where you click (failed attempt)\n        // --------------------------------------------------------------------------\n        // duplicate the event so user can edit without clicking twice\n        // var e2=myDocument.createEvent(\"MouseEvents\");\n        // e2.initMouseEvent(\"click\",true,true,window,0,0,0,0,0,false,false,false,false,0,null);\n        // inputBox.dispatchEvent(e2);\n        // ---------------------------------------------------------------------------\n      }\n\n      return true // this is not a valid modification\n    },\n\n    /**\n     *  UIs: input event handlers, menu generation\n     */\n    performAutoCompleteEdit: function performAutoCompleteEdit (\n      selectedTd,\n      menu\n    ) {\n      UI.utils.emptyNode(selectedTd)\n      qp('perform AutoCompleteEdit. THIS IS=' + this)\n      this.lastModified = this.createInputBoxIn(selectedTd, '')\n      this.lastModified.select()\n      this.lastModified.addEventListener(\n        'keypress',\n        this.getAutoCompleteHandler(menu),\n        false\n      )\n      /* keypress!?\n           This is what I hate about UI programming.\n           I shall write something about this but not now.\n        */\n      // this pops up the autocomplete menu\n      // Pops up the menu even though no keypress has occurred\n      // 1 is a dummy variable for the \"enterEvent\"\n      this.getAutoCompleteHandler(menu)(1)\n    },\n    backOut: function backOut () {\n      this.deleteTriple(this.lastModified.parentNode, true)\n      this.lastModified = null\n    },\n\n    clearMenu: function clearMenu () {\n      const menu = myDocument.getElementById(this.menuID)\n      if (menu) {\n        menu.parentNode.removeChild(menu)\n        // emptyNode(menu);\n      }\n    },\n\n    /* goes here when either this is a literal or escape from menu and then input text */\n    clearInputAndSave: function clearInputAndSave (e) {\n      let obj\n      if (!this.lastModified) return\n      if (!this.lastModified.isNew) {\n        try {\n          obj = this.getStatementAbout(this.lastModified).object\n        } catch (e) {\n          return\n        }\n      }\n      let s = this.lastModifiedStat // when 'isNew' this is set at addNewObject()\n\n      let defaultpropview\n      let trNode\n      let reqTerm\n      let preStat\n      if (this.lastModified.value !== this.lastModified.defaultValue) {\n        let trCache\n        if (this.lastModified.value === '') {\n          // ToDo: remove this\n          this.lastModified.value = this.lastModified.defaultValue\n          this.clearInputAndSave()\n          return\n        } else if (this.lastModified.isNew) {\n          s = new $rdf.Statement(\n            s.subject,\n            s.predicate,\n            store.literal(this.lastModified.value),\n            s.why\n          )\n          // TODO: DEFINE ERROR CALLBACK\n          defaultpropview = this.views.defaults[s.predicate.uri]\n          trCache = UI.utils.ancestor(this.lastModified, 'TR')\n          try {\n            store.updater.update([], [s], function (\n              uri,\n              success,\n              errorBody\n            ) {\n              if (!success) {\n                UI.log.error(\n                  'Error occurs while inserting ' +\n                    s +\n                    '\\n\\n' +\n                    errorBody +\n                    '\\n'\n                )\n                // UI.log.warn(\"Error occurs while inserting \"+s+'\\n\\n'+errorBody);\n                outline.UserInput.deleteTriple(trCache.lastChild, true)\n              }\n            })\n          } catch (e) {\n            UI.log.error('Error inserting fact ' + s + ':\\n\\t' + e + '\\n')\n            return\n          }\n          s = store.add(\n            s.subject,\n            s.predicate,\n            store.literal(this.lastModified.value),\n            s.why\n          )\n        } else {\n          if (this.statIsInverse) {\n            UI.log.error(\n              'Invalid Input: a literal can\\'t be a subject in RDF/XML'\n            )\n            this.backOut()\n            return\n          }\n          let s1, s2, s3\n          switch (obj.termType) {\n            case 'Literal': {\n              // generate path and nailing from current values\n\n              // TODO: DEFINE ERROR CALLBACK\n              const valueCache = this.lastModified.value\n              trCache = UI.utils.ancestor(this.lastModified, 'TR')\n              const oldValue = this.lastModified.defaultValue\n              s2 = $rdf.st(\n                s.subject,\n                s.predicate,\n                store.literal(this.lastModified.value),\n                s.why\n              )\n              try {\n                store.updater.update([s], [s2], function (\n                  uri,\n                  success,\n                  errorBody\n                ) {\n                  if (success) {\n                    obj.value = valueCache\n                  } else {\n                    UI.log.warn(\n                      'Error occurs while editing ' + s + '\\n\\n' + errorBody\n                    )\n                    trCache.lastChild.textContent = oldValue\n                  }\n                  trCache.lastChild.className = trCache.lastChild.className.replace(\n                    / pendingedit/g,\n                    ''\n                  )\n                })\n              } catch (e) {\n                UI.log.warn('Error occurs while editing ' + s + ':\\n\\t' + e)\n                return\n              }\n              // obj.value=this.lastModified.value;\n              // UserInputFormula.statements.push(s);\n              break\n            }\n            case 'BlankNode': { // a request refill with text\n              // var newStat\n              const textTerm = store.literal(this.lastModified.value, '')\n              // <Feature about=\"labelChoice\">\n              if (s.predicate.termType === 'Collection') {\n                // case: add triple   ????????? Weird - tbl\n                const selectedPredicate = s.predicate.elements[0] //    @@ TBL elements is a list on the predicate??\n                if (store.any(undefined, selectedPredicate, textTerm)) {\n                  if (!e) {\n                    // keyboard\n                    const tdNode = this.lastModified.parentNode\n                    e = {}\n                    e.pageX = UI.utils.findPos(tdNode)[0]\n                    e.pageY = UI.utils.findPos(tdNode)[1] + tdNode.clientHeight\n                  }\n                  this.showMenu(e, 'DidYouMeanDialog', undefined, {\n                    dialogTerm: store.any(undefined, selectedPredicate, textTerm),\n                    bnodeTerm: s.subject\n                  })\n                } else {\n                  s1 = UI.utils.ancestor(\n                    UI.utils.ancestor(this.lastModified, 'TR').parentNode,\n                    'TR'\n                  ).AJAR_statement\n                  s2 = $rdf.st(s.subject, selectedPredicate, textTerm, s.why)\n                  const type = store.the(s.subject, rdf('type'))\n                  s3 = store.anyStatementMatching(\n                    s.subject,\n                    rdf('type'),\n                    type,\n                    s.why\n                  )\n                  // TODO: DEFINE ERROR CALLBACK\n                  // because the table is repainted, so...\n                  trCache = UI.utils.ancestor(\n                    UI.utils.ancestor(this.lastModified, 'TR'),\n                    'TD'\n                  ).parentNode\n                  try {\n                    store.updater.update([], [s1, s2, s3], function (\n                      uri,\n                      success,\n                      errorBody\n                    ) {\n                      if (!success) {\n                        console.log(\n                          'Error occurs while editing ' +\n                            s1 +\n                            '\\n\\n' +\n                            errorBody\n                        )\n                        outline.UserInput.deleteTriple(trCache.lastChild, true) // @@@@ This\n                      }\n                    })\n                  } catch (e) {\n                    console.log(\n                      'Error occurs while editing ' + s1 + ':\\n\\t' + e\n                    )\n                    return\n                  }\n                  store.remove(s)\n                  store.add(s.subject, selectedPredicate, textTerm, s.why) // was: newStat =\n                  // a subtle bug occurs here, if foaf:nick hasn't been dereferneced,\n                  // this add will cause a repainting\n                }\n                const enclosingTd = UI.utils.ancestor(\n                  this.lastModified.parentNode.parentNode,\n                  'TD'\n                )\n                const defaultPane = panes.byName('default') // @@ check\n                outline.outlineExpand(enclosingTd, s.subject, {\n                  pane: defaultPane,\n                  already: true\n                })\n                outline.walk('right', outline.focusTd)\n                // </Feature>\n              } else {\n                this.fillInRequest(\n                  'object',\n                  this.lastModified.parentNode,\n                  store.literal(this.lastModified.value)\n                )\n                return // The new Td is already generated by fillInRequest, so it's done.\n              }\n              break\n            }\n          }\n        }\n      } else if (this.lastModified.isNew) {\n        // generate 'Request', there is no way you can input ' (Please Input) '\n        trNode = UI.utils.ancestor(this.lastModified, 'TR')\n        reqTerm = this.generateRequest(\n          '(To be determined. Re-type of drag an object onto this field)'\n        )\n        preStat = trNode.previousSibling.AJAR_statement // the statement of the same predicate\n        this.formUndetStat(\n          trNode,\n          preStat.subject,\n          preStat.predicate,\n          reqTerm,\n          preStat.why,\n          false\n        )\n        // this why being the same as the previous statement\n        this.lastModified = null\n\n        // UI.log.warn(\"test .isNew)\");\n        return\n      } else if (s.predicate.termType === 'Collection') {\n        store.removeMany(s.subject)\n        const upperTr = UI.utils.ancestor(\n          UI.utils.ancestor(this.lastModified, 'TR').parentNode,\n          'TR'\n        )\n        preStat = upperTr.AJAR_statement\n        reqTerm = this.generateRequest(\n          '(To be determined. Re-type of drag an object onto this field)'\n        )\n        this.formUndetStat(\n          upperTr,\n          preStat.subject,\n          preStat.predicate,\n          reqTerm,\n          preStat.why,\n          false\n        )\n        outline.replaceTD(\n          outline.outlineObjectTD(reqTerm, defaultpropview),\n          upperTr.lastChild\n        )\n        this.lastModified = null\n        return\n      } else if (this.statIsInverse) {\n        /*\n      if ((s.object.termType === 'BlankNode' && !this.statIsInverse) ||\n                  s.subject.termType === 'BlankNode' && this.statIsInverse) {\n        this.backOut()\n        return\n      */\n        if (s.subject.termType === 'BlankNode') {\n          this.backOut()\n          return\n        }\n      } else {\n        if (s.object.termType === 'BlankNode') {\n          this.backOut()\n          return\n        }\n      }\n      // case modified - literal modification only(for now).\n      trNode = UI.utils.ancestor(this.lastModified, 'TR')\n      // var defaultpropview = this.views.defaults[s.predicate.uri]\n\n      if (!this.statIsInverse) {\n        // this is for an old feature\n        // outline.replaceTD(outline.outlineObjectTD(s.object, defaultpropview),trNode.lastChild);\n        outline.replaceTD(\n          outline.outlineObjectTD(\n            store.literal(this.lastModified.value),\n            defaultpropview\n          ),\n          trNode.lastChild\n        )\n      } else {\n        outline.replaceTD(\n          outline.outlineObjectTD(s.subject, defaultpropview),\n          trNode.lastChild\n        )\n      }\n      if (this.lastModified.value !== this.lastModified.defaultValue) {\n        trNode.lastChild.className += ' pendingedit'\n      }\n      // trNode.AJAR_statement=s;//you don't have to set AJAR_inverse because it's not changed\n      // This is going to be painful when predicate-edit allowed\n      this.lastModified = null\n    },\n\n    /* deletes the triple corresponding to selectedTd, remove that Td. */\n    deleteTriple: function deleteTriple (selectedTd, isBackOut) {\n      // ToDo: complete deletion of a node\n      UI.log.debug('deleteTriple entered')\n\n      // allow a pending node to be deleted if it's a backout sent by SPARQL update callback\n      if (!isBackOut && selectedTd.className.indexOf(' pendingedit') !== -1) {\n        console.log(\n          'The node you attempted to edit has a request still pending.\\n' +\n            'Please wait for the request to finish (the text will turn black)\\n' +\n            'before editing this node again.'\n        )\n        outline.walk('up')\n        return\n      }\n      // var afterTr\n      const s = this.getStatementAbout(selectedTd)\n      if (\n        !isBackOut &&\n        !store.whether(s.object, rdf('type'), UI.ns.link('Request')) &&\n        // Better to check whether provenance is internal?\n        !store.whether(s.predicate, rdf('type'), UI.ns.link('Request')) &&\n        !store.whether(s.subject, rdf('type'), UI.ns.link('Request'))\n      ) {\n        UI.log.debug('about to send SPARQLUpdate')\n        try {\n          store.updater.update([s], [], function (uri, success, errorBody) {\n            if (success) {\n              removefromview()\n            } else {\n              // removedTr.AJAR_statement=kb.add(s.subject,s.predicate,s.object,s.why);\n              console.log(\n                'Error occurs while deleting ' + s + '\\n\\n' + errorBody\n              )\n              selectedTd.className = selectedTd.className.replace(\n                / pendingedit/g,\n                ''\n              )\n            }\n          })\n          selectedTd.className += ' pendingedit'\n        } catch (e) {\n          UI.log.error(e)\n          UI.log.warn('Error deleting statement ' + s + ':\\n\\t' + e)\n          return\n        }\n\n        UI.log.debug('SPARQLUpdate sent')\n      } else {\n        // removal of an undetermined statement associated with pending TRs\n        // TempFormula.remove(s);\n      }\n      UI.log.debug('about to remove ' + s)\n\n      UI.log.debug('removed')\n      outline.walk('up')\n\n      const removedTr = selectedTd.parentNode\n      // afterTr = removedTr.nextSibling\n      function removefromview () {\n        let trIterator\n        for (\n          trIterator = removedTr;\n          trIterator.childNodes.length === 1;\n          trIterator = trIterator.previousSibling\n        );\n        let predicateTd\n        if (trIterator === removedTr) {\n          const theNext = trIterator.nextSibling\n          if (theNext.nextSibling && theNext.childNodes.length === 1) {\n            predicateTd = trIterator.firstChild\n            predicateTd.setAttribute(\n              'rowspan',\n              parseInt(predicateTd.getAttribute('rowspan')) - 1\n            )\n            theNext.insertBefore(trIterator.firstChild, theNext.firstChild)\n          }\n          removedTr.parentNode.removeChild(removedTr)\n        } else {\n          // !DisplayOptions[\"display:block on\"].enabled){\n          predicateTd = trIterator.firstChild\n          predicateTd.setAttribute(\n            'rowspan',\n            parseInt(predicateTd.getAttribute('rowspan')) - 1\n          )\n          removedTr.parentNode.removeChild(removedTr)\n        }\n      }\n      if (isBackOut) removefromview()\n    },\n\n    /* clipboard principle: copy wildly, paste carefully\n      ToDoS:\n      1. register Subcollection?\n      2. copy from more than one selectedTd: 1.sequece 2.collection\n      3. make a clipboard class?\n    */\n    clipboardInit: function clipboardInit () {\n      outline.clipboard = {}\n      outline.clipboard.objects = []\n      outline.clipboard.predicates = []\n      outline.clipboard.all = []\n    },\n\n    copyToClipboard: function copyToClipboard (address, selectedTd) {\n      /*\n        var clip  = Components.classes[\"@mozilla.org/widget/clipboard;1\"].getService(Components.interfaces.nsIClipboard);\n        if (!clip) return false;\n        var clipid = Components.interfaces.nsIClipboard;\n\n        var trans = Components.classes[\"@mozilla.org/widget/transferable;1\"].createInstance(Components.interfaces.nsITransferable);\n        if (!trans) return false;\n\n        var copytext = \"Tabulator!!\";\n\n        var str   = Components.classes[\"@mozilla.org/supports-string;1\"].\n                           createInstance(Components.interfaces.nsISupportsString);\n        if (!str) return false;\n\n        str.data  = copytext;\n\n        trans.addDataFlavor(\"text/x-moz-url\");\n        trans.setTransferData(\"text/x-mox-url\", str, copytext.length * 2);\n\n        clip.setData(trans, null, clipid.kGlobalClipboard);\n        */\n\n      const term = UI.utils.getTerm(selectedTd)\n      switch (selectedTd.className) {\n        case 'selected': // table header\n        case 'obj selected':\n          // var objects = outline.clipboard.objects\n          outline.clipboard.objects.unshift(term)\n          break\n        case 'pred selected':\n        case 'pred internal selected':\n          outline.clipboard.predicates.unshift(term)\n      }\n\n      outline.clipboard.all.unshift(term)\n    },\n\n    insertTermTo: function insertTermTo (selectedTd, term, isObject) {\n      let defaultpropview\n      let preStat\n      switch (selectedTd.className) {\n        case 'undetermined selected':\n          defaultpropview = this.views.defaults[\n            selectedTd.parentNode.AJAR_statement.predicate.uri\n          ]\n          this.fillInRequest(\n            selectedTd.nextSibling ? 'predicate' : 'object',\n            selectedTd,\n            term\n          )\n          break\n        case 'pred selected': { // paste objects into this predicate\n          const insertTr = this.appendToPredicate(selectedTd)\n          preStat = selectedTd.parentNode.AJAR_statement\n          defaultpropview = this.views.defaults[preStat.predicate.uri]\n          insertTr.appendChild(outline.outlineObjectTD(term, defaultpropview))\n          // modify store and update here\n          const isInverse = selectedTd.parentNode.AJAR_inverse\n          if (!isInverse) {\n            insertTr.AJAR_statement = store.add(\n              preStat.subject,\n              preStat.predicate,\n              term,\n              preStat.why\n            )\n          } else {\n            insertTr.AJAR_statemnet = store.add(\n              term,\n              preStat.predicate,\n              preStat.object,\n              preStat.why\n            )\n          }\n\n          try {\n            store.updater.update([], [insertTr.AJAR_statement], function (\n              uri,\n              success,\n              errorBody\n            ) {\n              if (!success) {\n                UI.log.error(\n                  'userinput.js (pred selected): Fail trying to insert statement ' +\n                    insertTr.AJAR_statement +\n                    ': ' +\n                    errorBody\n                )\n              }\n            })\n          } catch (e) {\n            UI.log.error(\n              'Exception trying to insert statement ' +\n                insertTr.AJAR_statement +\n                ': ' +\n                UI.utils.stackString(e)\n            )\n            return\n          }\n          insertTr.AJAR_inverse = isInverse\n          UserInputFormula.statements.push(insertTr.AJAR_statement)\n          break\n        }\n        case 'selected': { // header <TD>, undetermined generated\n          const paneDiv = UI.utils.ancestor(selectedTd, 'TABLE').lastChild\n          const newTr = paneDiv.insertBefore(\n            myDocument.createElement('tr'),\n            paneDiv.lastChild\n          )\n          // var titleTerm=UI.utils.getAbout(kb,UI.utils.ancestor(newTr,'TD'));\n          preStat = newTr.previousSibling.AJAR_statement\n          if (typeof isObject === 'undefined') isObject = true\n          if (isObject) {\n            // object inserted\n            this.formUndetStat(\n              newTr,\n              preStat.subject,\n              this.generateRequest('(TBD)', newTr, true),\n              term,\n              preStat.why,\n              false\n            )\n            // defaultpropview temporaily not dealt with\n            newTr.appendChild(outline.outlineObjectTD(term))\n            outline.walk('moveTo', newTr.firstChild)\n            this.startFillInText(newTr.firstChild)\n          } else {\n            // predicate inserted\n            // existing predicate not expected\n            const reqTerm = this.generateRequest(\n              '(To be determined. Re-type of drag an object onto this field)',\n              newTr\n            )\n            this.formUndetStat(\n              newTr,\n              preStat.subject,\n              term,\n              reqTerm,\n              preStat.why,\n              false\n            )\n\n            newTr.insertBefore(\n              outline.outlinePredicateTD(term, newTr, false, false),\n              newTr.firstChild\n            )\n            outline.walk('moveTo', newTr.lastChild)\n            this.startFillInText(newTr.lastChild)\n          }\n          break\n        }\n      }\n    },\n\n    Refill: function Refill (e, selectedTd) {\n      UI.log.info('Refill' + selectedTd.textContent)\n      const isPredicate = selectedTd.nextSibling\n      let predicateQuery\n      if (isPredicate) {\n        // predicateTd\n        let subject\n        let subjectClass\n        let sparqlText\n        if (selectedTd.nextSibling.className === 'undetermined') {\n          /* Make set of proprties to propose for a predicate.\n            The  naive approach is to take those which have a class\n            of the subject as their domain.  But in fact we must offer anything which\n            is not explicitly excluded, by having a domain disjointWith a\n            class of the subject. */\n\n          /* SELECT ?pred\n               WHERE{\n                   ?pred a rdf:Property.\n                   ?pred rdfs:domain subjectClass.\n               }\n            */\n          /*  SELECT ?pred ?class\n                WHERE{\n                   ?pred a rdf:Property.\n                   subjectClass owl:subClassOf ?class.\n                   ?pred rdfs:domain ?class.\n               }\n            */\n          /*  SELECT ?pred\n                WHERE{\n                   subject a ?subjectClass.\n                   ?pred rdfs:domain ?subjectClass.\n                }\n            */\n          subject = UI.utils.getAbout(\n            store,\n            UI.utils.ancestor(selectedTd, 'TABLE').parentNode\n          )\n          subjectClass = store.any(subject, rdf('type'))\n          sparqlText = []\n          const endl = '.\\n'\n          sparqlText[0] =\n            'SELECT ?pred WHERE{\\n?pred ' +\n            rdf('type') +\n            rdf('Property') +\n            '.\\n' +\n            '?pred ' +\n            UI.ns.rdfs('domain') +\n            subjectClass +\n            '.}' // \\n is required? SPARQL parser bug?\n          sparqlText[1] =\n            'SELECT ?pred ?class\\nWHERE{\\n' +\n            '?pred ' +\n            rdf('type') +\n            rdf('Property') +\n            '.\\n' +\n            subjectClass +\n            UI.ns.rdfs('subClassOf') +\n            ' ?class.\\n' +\n            '?pred ' +\n            UI.ns.rdfs('domain') +\n            ' ?class.\\n}'\n          sparqlText[2] =\n            'SELECT ?pred WHERE{\\n' +\n            subject +\n            rdf('type') +\n            store.variable('subjectClass') +\n            endl +\n            store.variable('pred') +\n            UI.ns.rdfs('domain') +\n            store.variable('subjectClass') +\n            endl +\n            '}'\n          predicateQuery = sparqlText.map($rdf.SPARQLToQuery)\n        } else {\n          // ------selector\n          /* SELECT ?pred\n               WHERE{\n                   ?pred a rdf:Property.\n                   ?pred rdfs:domain subjectClass.\n                   ?pred rdfs:range objectClass.\n               }\n            */\n          // Candidate\n          /* SELECT ?pred\n               WHERE{\n                   subject a ?subjectClass.\n                   object a ?objectClass.\n                   ?pred rdfs:domain ?subjectClass.\n                   ?pred rdfs:range ?objectClass.\n            */\n          subject = UI.utils.getAbout(\n            store,\n            UI.utils.ancestor(selectedTd, 'TABLE').parentNode\n          )\n          subjectClass = store.any(subject, rdf('type'))\n          const object = selectedTd.parentNode.AJAR_statement.object\n          // var objectClass = (object.termType === 'Literal') ? UI.ns.rdfs('Literal') : kb.any(object, rdf('type'))\n          // var sparqlText=\"SELECT ?pred WHERE{\\n?pred \"+rdf('type')+rdf('Property')+\".\\n\"+\n          //               \"?pred \"+UI.ns.rdfs('domain')+subjectClass+\".\\n\"+\n          //               \"?pred \"+UI.ns.rdfs('range')+objectClass+\".\\n}\"; // \\n is required? SPARQL parser bug?\n          sparqlText =\n            'SELECT ?pred WHERE{' +\n            subject +\n            rdf('type') +\n            '?subjectClass' +\n            '.\\n' +\n            object +\n            rdf('type') +\n            '?objectClass' +\n            '.\\n' +\n            '?pred ' +\n            UI.ns.rdfs('domain') +\n            '?subjectClass' +\n            '.\\n' +\n            '?pred ' +\n            UI.ns.rdfs('range') +\n            '?objectClass' +\n            '.\\n}' // \\n is required? SPARQL parser bug?\n          predicateQuery = $rdf.SPARQLToQuery(sparqlText)\n        }\n\n        // -------presenter\n        // ToDo: how to sort selected predicates?\n        this.showMenu(e, 'GeneralPredicateChoice', predicateQuery, {\n          isPredicate,\n          selectedTd\n        })\n      } else {\n        // objectTd\n        const predicateTerm = selectedTd.parentNode.AJAR_statement.predicate\n        if (\n          store.whether(\n            predicateTerm,\n            rdf('type'),\n            UI.ns.owl('DatatypeProperty')\n          ) ||\n          predicateTerm.termType === 'Collection' ||\n          store.whether(predicateTerm, UI.ns.rdfs('range'), UI.ns.rdfs('Literal'))\n        ) {\n          selectedTd.className = ''\n          UI.utils.emptyNode(selectedTd)\n          this.lastModified = this.createInputBoxIn(\n            selectedTd,\n            ' (Please Input) '\n          )\n          this.lastModified.isNew = false\n\n          this.lastModified.select()\n        }\n\n        // show menu for rdf:type\n        if (\n          selectedTd.parentNode.AJAR_statement.predicate.sameTerm(rdf('type'))\n        ) {\n          const sparqlText =\n            'SELECT ?class WHERE{?class ' +\n            rdf('type') +\n            UI.ns.rdfs('Class') +\n            '.}'\n          // I should just use kb.each\n          const classQuery = $rdf.SPARQLToQuery(sparqlText)\n          this.showMenu(e, 'TypeChoice', classQuery, {\n            isPredicate,\n            selectedTd\n          })\n        }\n      }\n    },\n\n    // This is where pubsPane.js comes in, with: outline.UserInput.getAutoCompleteHandler(\"JournalTAC\")(e);\n    getAutoCompleteHandler: function getAutoCompleteHandler (mode) {\n      qp('\\n\\n***** In getAutoCompleteHandler ****** mode = ' + mode)\n      if (mode === 'PredicateAutoComplete') {\n        mode = 'predicate'\n      } else if (mode !== 'JournalTAC') {\n        // hq  // why? -tim  - not 'predicate' below\n        mode = 'all'\n      }\n\n      let InputBox\n      if (mode === 'JournalTAC') {\n        // hq  // Better to pass in InputBox as a param\n        InputBox = myDocument.getElementById('inpid_journal_title')\n      } else {\n        InputBox = this.lastModified || outline.getSelection()[0].firstChild\n      }\n      qp('InputBox=' + InputBox) // hq\n      qp('InputBox.value=' + InputBox.value) // hq\n\n      return function (enterEvent) {\n        qp('ENTER EVENT=' + enterEvent)\n        // Firefox 2.0.0.6 makes this not working? 'this' becomes [object HTMLInputElement]\n        //                                           but not [wrapped ...]\n        // var InputBox=(typeof enterEvent=='object')?this:this.lastModified;//'this' is the <input> element\n        qp('1. outside (if eneterEvent)')\n        const e = {}\n        const tdNode = InputBox.parentNode\n        if (!mode) mode = tdNode.nextSibling ? 'predicate' : 'all'\n        e.pageX = UI.utils.findPos(tdNode)[0]\n        e.pageY = UI.utils.findPos(tdNode)[1] + tdNode.clientHeight\n        qp('epX=' + e.pageX + ', epY=' + e.pageY + ', mode=' + mode)\n        let menu = myDocument.getElementById(outline.UserInput.menuID)\n        function setHighlightItem (item) {\n          if (!item) return // do not make changes\n          if (menu.lastHighlight) menu.lastHighlight.className = ''\n          menu.lastHighlight = item\n          menu.lastHighlight.className = 'activeItem'\n          outline.showURI(UI.utils.getAbout(store, menu.lastHighlight))\n        }\n        if (enterEvent) {\n          // either the real event of the pseudo number passed by OutlineKeypressPanel\n          qp('2. in (if enterEvent).  with type = ' + typeof enterEvent)\n          let newText = InputBox.value\n\n          if (typeof enterEvent === 'object') {\n            qp(\n              '3. in typeof enterEvent is object, will switch to keys, arrows, etc. keycode = ' +\n                enterEvent.keyCode\n            )\n            enterEvent.stopPropagation()\n            if (menu && !menu.lastHighlight) {\n              // this ensures the following operation valid\n              setHighlightItem(menu.firstChild.firstChild)\n            }\n            switch (enterEvent.keyCode) {\n              case 13: // enter\n              case 9: // tab\n                qp('handler: Enter or Tab')\n                if (!menu) {\n                  outline.UserInput.clearInputAndSave()\n                  return\n                }\n                if (!menu.lastHighlight) {\n                  if (mode === 'JournalTAC') {\n                    outline.UserInput.clearMenu()\n                    qp('no lastH')\n                    return 'no lastH'\n                  }\n                  return\n                } // warning?\n\n                if (menu.lastHighlight.tagName === 'INPUT') {\n                  switch (menu.lastHighlight.value) {\n                    case 'New...':\n                      qp('subcase New')\n                      outline.UserInput.createNew()\n                      break\n                    case 'GiveURI':\n                      qp('subcase GiveURI')\n                      outline.UserInput.inputURI()\n                      break\n                  }\n                } else {\n                  // pubsPane Stuff:\n                  if (mode === 'JournalTAC') {\n                    qp('movedArrow? ' + movedArrow)\n                    // Enter only works if arrows have been moved\n                    if (movedArrow && menu.lastHighlight) {\n                      // Get the title from the DOM\n                      // tr, th, div, innerHTML\n                      const jtitle =\n                        menu.lastHighlight.firstChild.firstChild.innerHTML\n                      // tr, th, td, innerHTML\n                      let juri =\n                        menu.lastHighlight.firstChild.nextSibling.innerHTML\n                      // clearing out the &lt; and &gt; from juri\n                      juri = juri.slice(4, -4)\n                      return ['gotdptitle', jtitle, juri]\n                    }\n                    // If doesn't qualify to be autocomplete, return this random string, since pubsPane checks for \"gotdptitle\"\n                    return 'asGivenTxt'\n                  }\n\n                  const inputTerm = UI.utils.getAbout(store, menu.lastHighlight)\n                  const fillInType = mode === 'predicate' ? 'predicate' : 'object'\n                  outline.UserInput.clearMenu()\n                  outline.UserInput.fillInRequest(\n                    fillInType,\n                    InputBox.parentNode,\n                    inputTerm\n                  )\n                  // if (outline.UserInput.fillInRequest(fillInType,InputBox.parentNode,inputTerm))\n                  //    outline.UserInput.clearMenu();\n                }\n                qp('outside')\n                return\n              case 38: // up\n                qp('handler: Arrow UP')\n                movedArrow = true // hq\n                if (\n                  newText === '' &&\n                  menu.lastHighlight.tagName === 'TR' &&\n                  !menu.lastHighlight.previousSibling\n                ) {\n                  setHighlightItem(menu.firstChild.firstChild)\n                } else {\n                  setHighlightItem(menu.lastHighlight.previousSibling)\n                }\n                return 'I\\'m a little Arrow Up'\n              case 40: // down\n                qp('handler: Arrow Down')\n                movedArrow = true // hq\n                if (menu.lastHighlight.tagName === 'INPUT') {\n                  setHighlightItem(menu.childNodes[1].firstChild)\n                } else {\n                  setHighlightItem(menu.lastHighlight.nextSibling)\n                }\n                return 'I\\'m a little Down Arrow'\n              case 37: // left\n              case 39: // right\n                qp('handler: Arrow left, right')\n                if (menu.lastHighlight.tagName === 'INPUT') {\n                  if (enterEvent.keyCode === 37) {\n                    setHighlightItem(menu.lastHighlight.previousSibling)\n                  } else {\n                    setHighlightItem(menu.lastHighlight.nextSibling)\n                  }\n                }\n                return\n              case 8: // backspace\n                qp('handler: Backspace')\n                newText = newText.slice(0, -1)\n                break\n              case 27: // esc to enter literal\n                qp('handler: Esc')\n                if (!menu) {\n                  outline.UserInput.backOut()\n                  return\n                }\n                outline.UserInput.clearMenu()\n                // Not working? I don't know.\n                // InputBox.removeEventListener('keypress',outline.UserInput.Autocomplete,false);\n                return\n              // break\n              default:\n                qp('handler: Default')\n                movedArrow = false // hq\n                // we need this because it is keypress, seeAlso performAutoCompleteEdit\n                qp('oldtext=' + newText)\n                newText += String.fromCharCode(enterEvent.charCode)\n                qp('charcodent=' + enterEvent.charCode)\n                qp('strcharcod=' + String.fromCharCode(enterEvent.charCode))\n                console.log('DEFAULT txtstr=' + newText + '\\n') // hq\n            }\n          } // endif typeof(event) === object\n\n          // UI.log.warn(InputBox.choices.length);\n          // for(i=0;InputBox.choices[i].label<newText;i++); //O(n) ToDo: O(log n)\n          if (mode === 'all') {\n            qp('generalAC after switch, newText=' + newText + 'mode is all')\n            outline.UserInput.clearMenu()\n            // outline.UserInput.showMenu(e,'GeneralAutoComplete',undefined,{'isPredicate':false,'selectedTd':tdNode,'choices':InputBox.choices, 'index':i});\n            outline.UserInput.showMenu(e, 'GeneralAutoComplete', undefined, {\n              inputText: newText,\n              selectedTd: tdNode\n            })\n            if (newText.length === 0) outline.UserInput.WildCardButtons()\n          } else if (mode === 'predicate') {\n            qp(\n              'predicateAC after switch, newText=' +\n                newText +\n                'mode is predicate'\n            )\n            outline.UserInput.clearMenu()\n            outline.UserInput.showMenu(e, 'PredicateAutoComplete', undefined, {\n              inputText: newText,\n              isPredicate: true,\n              selectedTd: tdNode\n            })\n          } else if (mode === 'JournalTAC') {\n            // hq\n            qp('JouralTAC after switch, newText=' + newText)\n            outline.UserInput.clearMenu()\n            // Goto showMenu\n            outline.UserInput.showMenu(\n              e,\n              'JournalTitleAutoComplete',\n              undefined,\n              { inputText: newText },\n              'orderisuseless'\n            )\n          }\n          menu = myDocument.getElementById(outline.UserInput.menuID)\n          if (!menu) {\n            qp('No menu element.  Do not show menu.')\n            return\n          }\n          qp('at end of handler\\n^^^^^^^^^^^^^^^^^\\n\\n')\n          setHighlightItem(menu.firstChild.firstChild)\n          outline.showURI(UI.utils.getAbout(store, menu.lastHighlight))\n          return 'nothing to return'\n        }\n      } // end of return function\n    },\n\n    // Add the buttons which allow the suer to craete a new object\n    // Or reference an exiting one with a URI.\n    //\n    WildCardButtons: function WildCardButtons () {\n      const menuDiv = myDocument.getElementById(outline.UserInput.menuID)\n      const div = menuDiv.insertBefore(\n        myDocument.createElement('div'),\n        menuDiv.firstChild\n      )\n      const input1 = div.appendChild(myDocument.createElement('input'))\n      const input2 = div.appendChild(myDocument.createElement('input'))\n      input1.type = 'button'\n      input1.value = 'New...'\n      input2.type = 'button'\n      input2.value = 'Know its URI'\n\n      function highlightInput (e) {\n        // same as the one in newMenu()\n        const menu = myDocument.getElementById(outline.UserInput.menuID)\n        if (menu.lastHighlight) menu.lastHighlight.className = ''\n        menu.lastHighlight = UI.utils.ancestor(UI.utils.getTarget(e), 'INPUT')\n        if (!menu.lastHighlight) return // mouseover <TABLE>\n        menu.lastHighlight.className = 'activeItem'\n      }\n      div.addEventListener('mouseover', highlightInput, false)\n      input1.addEventListener('click', this.createNew, false)\n      input2.addEventListener('click', this.inputURI, false)\n    },\n    // ToDo: shrink rows when \\n+backspace\n    Keypress: function (e) {\n      if (e.keyCode === 13) {\n        if (outline.targetOf(e).tagName !== 'TEXTAREA') {\n          this.clearInputAndSave()\n        } else {\n          // <TEXTAREA>\n          const preRows = parseInt(this.lastModified.getAttribute('rows'))\n          this.lastModified.setAttribute('rows', (preRows + 1).toString())\n          e.stopPropagation()\n        }\n      }\n      // Remark by Kenny: If the user wants to input more lines into an one-line-only blank.\n      //                 Direct him/her to a new blank (how?)\n    },\n\n    Mousedown: function (e) {\n      qp('MOUSING DOWN')\n      // temporary key ctrl+s or q for swiching mode\n      // This was in HCIOptions \"right click to switch mode\":\n      window.addEventListener(\n        'keypress',\n        function (e) {\n          if (e.ctrlKey && (e.charCode === 115 || e.charCode === 113)) {\n            UserInput.switchMode()\n          }\n        },\n        false\n      )\n      window.addEventListener('mousedown', UserInput.Mousedown, false)\n      document.getElementById('outline').oncontextmenu = function () {\n        return false\n      }\n\n      if (e.button === 2) {\n        // right click\n        UserInput.switchMode()\n        if (e) {\n          e.preventDefault()\n          e.stopPropagation()\n        }\n      }\n    },\n\n    Mouseover: function Mouseover (e) {\n      this.className = 'bottom-border-active'\n      if (this._tabulatorMode === 1) {\n        switch (UI.utils.getTarget(e).tagName) {\n          case 'TD': {\n            const preTd = UI.utils.getTarget(e)\n            if (preTd.className === 'pred') preTd.style.cursor = 'copy'\n            break\n          }\n          // Uh...I think I might have to give up this\n          case 'DIV': {\n            const border = UI.utils.getTarget(e)\n            if (UI.utils.getTarget(e).className === 'bottom-border') {\n              border.style.borderColor = 'rgb(100%,65%,0%)'\n              border.style.cursor = 'copy'\n            }\n            break\n          }\n          default:\n        }\n      }\n    },\n\n    Mouseout: function (e) {\n      this.className = 'bottom-border'\n      if (this._tabulatorMode === 1) {\n        const border = UI.utils.getTarget(e)\n        if (UI.utils.getTarget(e).className === 'bottom-border') {\n          border.style.borderColor = 'transparent'\n          border.style.cursor = 'auto'\n        }\n      }\n    },\n\n    /**\n     * Utilities\n     */\n\n    whatSortOfEditCell: function whatSortOfEditCell (selectedTd) {\n      if (selectedTd.nextSibling) return 'predicate'\n      const predicateTerm = this.getStatementAbout(selectedTd).predicate\n      // var predicateTerm=selectedTd.parentNode.AJAR_statement.predicate;\n      if (\n        store.whether(\n          predicateTerm,\n          UI.ns.rdf('type'),\n          UI.ns.owl('DatatypeProperty')\n        ) ||\n        store.whether(predicateTerm, UI.ns.rdfs('range'), UI.ns.rdfs('Literal')) ||\n        predicateTerm.termType === 'Collection'\n      ) {\n        return 'DatatypeProperty-like'\n      } else if (\n        store.whether(predicateTerm, rdf('type'), UI.ns.owl('ObjectProperty'))\n      ) {\n        return 'ObjectProperty-like'\n      } else {\n        return 'no-idea'\n      }\n    },\n\n    getStatementAbout: function getStatementAbout (something) {\n      // var trNode=something.parentNode;\n      const trNode = UI.utils.ancestor(something, 'TR')\n      if (!trNode) {\n        throw new Error('No ancestor TR for the TD we clicked on:' + something)\n      }\n      let statement\n      try {\n        statement = trNode.AJAR_statement\n      } catch (e) {\n        throw new Error(\n          'No AJAR_statement!' +\n            something +\n            something.textContent +\n            ' has ancestor ' +\n            trNode\n        ) // was commented out @@\n        // throw 'TR not a statement TR' // was commented out @@\n      }\n      // Set last modified here, I am not sure this will be ok.\n      this.lastModifiedStat = trNode.AJAR_statement\n      this.statIsInverse = trNode.AJAR_inverse\n\n      return statement\n    },\n\n    createInputBoxIn: function createInputBoxIn (tdNode, defaultText) {\n      function UpAndDown (e) {\n        if (e.keyCode === 38 || e.keyCode === 40) {\n          outline.OutlinerKeypressPanel(e)\n          outline.UserInput.clearInputAndSave()\n        }\n      }\n      UI.log.info(\n        'myDocument in createInputBoxIn is now ' + myDocument.location\n      )\n      UI.log.info('outline.document is now ' + outline.document.location)\n      const inputBox = myDocument.createElement('input')\n      inputBox.setAttribute('value', defaultText)\n      inputBox.setAttribute('class', 'textinput')\n      // inputBox.setAttribute('size','100');//should be the size of <TD>\n      if (tdNode.className !== 'undetermined selected') {\n        inputBox.setAttribute('size', '100') // should be the size of <TD>\n        inputBox.addEventListener('keypress', UpAndDown, false)\n      }\n      tdNode.appendChild(inputBox)\n      return inputBox\n    },\n\n    // called when 'New...' is clicked(eventlistener) or enter is pressed while 'New...' is highlighted\n    createNew: function createNew (_e) {\n      outline.UserInput.clearMenu()\n      const selectedTd = outline.getSelection()[0]\n      const targetdoc = selectedTd.parentNode.AJAR_statement.why\n      const newTerm = store.nextSymbol(targetdoc)\n      outline.UserInput.fillInRequest('object', selectedTd, newTerm)\n      // selection is changed\n      outline.outlineExpand(outline.getSelection()[0], newTerm)\n    },\n\n    inputURI: function inputURI (_e) {\n      const This = outline.UserInput\n      This.clearMenu()\n      const selectedTd = outline.getSelection()[0]\n      UI.utils.emptyNode(selectedTd)\n      const tiptext = ' (Type a URI) '\n      This.lastModified = This.createInputBoxIn(selectedTd, tiptext)\n      This.lastModified.select()\n      function typeURIhandler (e) {\n        e.stopPropagation()\n        switch (e.keyCode) {\n          case 13: // enter\n          case 9: // tab\n            // this is input box\n            if (this.value !== tiptext) {\n              const newuri = this.value // @@ Removed URI \"fixup\" code\n              This.fillInRequest('object', selectedTd, store.sym(newuri))\n            }\n        }\n      }\n      This.lastModified.addEventListener('keypress', typeURIhandler, false)\n      /*\n        if (false && UI.isExtension){\n            var selectedTd = outline.getSelection()[0];\n            emptyNode(selectedTd);\n            var textbox = myDocument.createElementNS(kXULNS,'textbox');\n            textbox.setAttribute('type','autocomplete');\n            textbox.setAttribute('autocompletesearch','history');\n            selectedTd.appendChild(textbox);\n\n            urlbar = gURLBar.cloneNode(false);\n            selectedTd.appendChild(urlbar);\n            urlbar.mController = gURLBar.mController;\n\n        }\n        */\n    },\n\n    appendToPredicate: function appendToPredicate (predicateTd) {\n      let isEnd = false\n      let trIterator\n      try {\n        for (\n          trIterator = predicateTd.parentNode.nextSibling;\n          trIterator.childNodes.length === 1 && trIterator.AJAR_statement;\n          // number of nodes as condition, also beware of toggle Trs that don't have AJAR_statement\n          trIterator = trIterator.nextSibling\n        ) {\n          // ..\n        }\n      } catch (e) {\n        isEnd = true\n      }\n      // if(!isEnd && HCIoptions[\"bottom insert highlights\"].enabled) trIterator=trIterator.previousSibling;\n\n      const insertTr = myDocument.createElement('tr')\n      // style stuff, I'll have to investigate appendPropertyTRs() somehow\n      insertTr.style.colspan = '1'\n      insertTr.style.display = 'block'\n\n      insertTr.style.display = ''\n      if (predicateTd.hasAttribute('rowspan')) {\n        predicateTd.setAttribute(\n          'rowspan',\n          parseInt(predicateTd.getAttribute('rowspan')) + 1\n        )\n      }\n\n      if (!predicateTd.hasAttribute('rowspan')) {\n        predicateTd.setAttribute('rowspan', '2')\n      }\n\n      if (!isEnd) {\n        trIterator.parentNode.insertBefore(insertTr, trIterator)\n      } else {\n        const table = predicateTd.parentNode.parentNode\n        if (table.className === 'defaultPane') {\n          table.insertBefore(insertTr, table.lastChild)\n        } else {\n          table.appendChild(insertTr)\n        }\n      }\n\n      return insertTr\n    },\n\n    bnode2symbol: function bnode2symbol (bnode, symbol) {\n      store.copyTo(bnode, symbol, ['two-direction', 'delete'])\n    },\n\n    generateRequest: function generateRequest (\n      tipText,\n      trNew,\n      isPredicate,\n      notShow\n    ) {\n      let trNode\n      if (!notShow) {\n        if (trNew) {\n          trNode = trNew\n        } else {\n          trNode = UI.utils.ancestor(this.lastModified, 'TR')\n        }\n        UI.utils.emptyNode(trNode)\n      }\n\n      // create the undetermined term\n      // Choice 1:\n      // var reqTerm=kb.literal(\"TBD\");\n      // this is troblesome since RDFIndexedFormula does not allow me to add <x> <y> \"TBD\". twice\n      // Choice 2: Use a variable.\n      // Agreed. Kenny wonders whether there is RDF/XML representation of a variable.\n      // labelPriority[UI.ns.link('message').uri] = 20;\n\n      // We must get rid of this clutter in the store. \"OK, will be stroed in a seperate formula to avoid bugs\", Kenny says\n      const tp = TempFormula\n      const reqTerm = tp.bnode()\n      tp.add(reqTerm, UI.ns.rdf('type'), UI.ns.link('Request'))\n      if (tipText.length < 10) {\n        tp.add(reqTerm, UI.ns.link('message'), tp.literal(tipText))\n      } else {\n        tp.add(reqTerm, UI.ns.link('message'), tp.literal(tipText))\n      }\n      tp.add(reqTerm, UI.ns.link('to'), tp.literal('The User'))\n      tp.add(reqTerm, UI.ns.link('from'), tp.literal('The User'))\n\n      // append the undetermined td\n      if (!notShow) {\n        let newNode\n        if (isPredicate) {\n          newNode = trNode.appendChild(\n            outline.outlinePredicateTD(reqTerm, trNode, false, false)\n          )\n        } else {\n          newNode = trNode.appendChild(outline.outlineObjectTD(reqTerm))\n        }\n        newNode.className = 'undetermined'\n        newNode.textContent = tipText\n      }\n\n      return reqTerm\n    },\n\n    showMenu: function showMenu (\n      e,\n      menuType,\n      inputQuery,\n      extraInformation,\n      _order\n    ) {\n      // ToDo:order, make a class?\n      UI.log.info('myDocument is now ' + myDocument.location)\n      UI.log.info('outline.doucment is now ' + outline.document.location)\n      const This = this\n      const menu = myDocument.createElement('div')\n      qp('\\n**** In showMenu, menuType = ' + menuType + '\\n')\n      if (extraInformation) {\n        for (const x in extraInformation) {\n          console.log('\\t extra ' + x + ': ' + extraInformation[x] + '\\n')\n        }\n      }\n      console.log('CREATED MENU\\n') // hq\n      menu.id = this.menuID\n      menu.className = 'outlineMenu'\n      // menu.addEventListener('click',false);\n      menu.style.top = e.pageY + 'px'\n      menu.style.left = e.pageX + 'px'\n\n      /// /For pubsPane\n      // This is for setting the location of the dropdown menu, because\n      // JournalTitleAutoComplete is called with a keypress, and not mouse actions\n      // Get Offset of an HTML element\n      const getOffset = function getOffset (el) {\n        let _lf = 0\n        let _tp = 0\n        let oldlf = 0\n        let oldtp = 0\n        let newlf = 0\n        let newtp = 0\n\n        // repeatedly get ancestor's positions\n        // TODO: STILL a small offset/bug\n        while (el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)) {\n          newlf = el.offsetLeft\n          newtp = el.offsetTop\n\n          // only change if the new parent's offset is different\n          if (newlf !== oldlf) {\n            _lf += el.offsetLeft - el.scrollLeft\n          }\n          if (newtp !== oldtp) {\n            _tp += el.offsetTop - el.scrollTop\n          }\n\n          oldlf = newlf\n          oldtp = newtp\n\n          el = el.parentNode\n        }\n        // there is a constant offset\n        return { top: _tp + 54, left: _lf - 38 }\n      }\n      // Change the position of menu in pubsPane's journal Title AC\n      if (menuType === 'JournalTitleAutoComplete') {\n        // hql\n        const loc = getOffset(myDocument.getElementById('inpid_journal_title'))\n        loc.left -= myDocument.getElementById('inpid_journal_title').scrollTop\n        menu.style.top = loc.top + 'px'\n        menu.style.left = loc.left + 'px'\n      }\n      console.log(\n        'menu at top=' + menu.style.top + ' left=' + menu.style.left + '\\n'\n      ) // hql\n      // \\\\\\\\\\\\\\hql\n\n      myDocument.body.appendChild(menu)\n      const table = menu.appendChild(myDocument.createElement('table'))\n\n      menu.lastHighlight = null\n      function highlightTr (e) {\n        if (menu.lastHighlight) menu.lastHighlight.className = ''\n        menu.lastHighlight = UI.utils.ancestor(UI.utils.getTarget(e), 'TR')\n        if (!menu.lastHighlight) return // mouseover <TABLE>\n        menu.lastHighlight.className = 'activeItem'\n      }\n\n      table.addEventListener('mouseover', highlightTr, false)\n\n      // setting for action after selecting item\n      let selectItem\n      switch (menuType) {\n        case 'DidYouMeanDialog':\n          selectItem = function selectItem (e) {\n            qp('DID YOU MEAN SELECT ITEM!!!!!')\n            const target = UI.utils.ancestor(UI.utils.getTarget(e), 'TR')\n            if (target.childNodes.length === 2 && target.nextSibling) {\n              // Yes\n              store.add(bnodeTerm, IDpredicate, IDterm) // used to connect the two\n              outline.UserInput.clearMenu()\n            } else if (target.childNodes.length === 2) {\n              outline.UserInput.clearMenu()\n            }\n          }\n          break\n        case 'LimitedPredicateChoice': {\n          const clickedTd = extraInformation.clickedTd\n          selectItem = function selectItem (e) {\n            qp('LIMITED P SELECT ITEM!!!!')\n            const selectedPredicate = UI.utils.getAbout(store, UI.utils.getTarget(e))\n            const predicateChoices =\n              clickedTd.parentNode.AJAR_statement.predicate.elements\n            for (let i = 0; i < predicateChoices.length; i++) {\n              if (predicateChoices[i].sameTerm(selectedPredicate)) {\n                predicateChoices.unshift(predicateChoices.splice(i, 1)[0])\n              }\n            }\n            outline.UserInput.clearMenu()\n\n            // refresh the choice\n            const tr = clickedTd.parentNode\n            const newTd = outline.outlinePredicateTD(\n              tr.AJAR_statement.predicate,\n              tr\n            )\n            tr.insertBefore(newTd, clickedTd)\n            tr.removeChild(clickedTd)\n            This.lastModified.select()\n          }\n          break\n        }\n        case 'PredicateAutoComplete':\n        case 'GeneralAutoComplete':\n        case 'GeneralPredicateChoice':\n        case 'JournalTitleAutoComplete': // hql\n        case 'TypeChoice': {\n          // Clickable menu\n          const isPredicate = extraInformation.isPredicate\n          const selectedTd = extraInformation.selectedTd\n          selectItem = function selectItem (e) {\n            qp('WOOHOO')\n            const inputTerm = UI.utils.getAbout(store, UI.utils.getTarget(e))\n            qp('GENERAL SELECT ITEM!!!!!!=' + inputTerm)\n            qp('target=' + UI.utils.getTarget(e))\n            if (isPredicate) {\n              qp('1')\n              if (\n                outline.UserInput.fillInRequest(\n                  'predicate',\n                  selectedTd,\n                  inputTerm\n                )\n              ) {\n                qp('2')\n                outline.UserInput.clearMenu()\n              }\n            } else {\n              qp('3')\n              // thisInput.fillInRequest('object',selectedTd,inputTerm); //why is this not working?\n              if (\n                outline.UserInput.fillInRequest('object', selectedTd, inputTerm)\n              ) {\n                qp('4')\n                outline.UserInput.clearMenu()\n              }\n            }\n          }\n          break\n        }\n        default:\n          throw new Error('userinput: unexpected mode')\n      }\n      // hq: this line makes the menu clickable\n      table.addEventListener('click', selectItem, false)\n\n      // Add Items to the list\n      // build NameSpaces here from knowledge base\n      const NameSpaces = {}\n      // for each (ontology in ontologies)\n      store.each(undefined, UI.ns.rdf('type'), UI.ns.owl('Ontology')).forEach(\n        function (ontology) {\n          const label = UI.utils.label(ontology)\n          if (!label) return\n          // this is like extracting metadata from URI. Maybe it's better not to take the abbrevs.\n          const match = label.value.match(/\\((.+?)\\)/)\n          if (match) {\n            NameSpaces[match[1]] = ontology.uri\n          } else {\n            NameSpaces[label.value] = ontology.uri\n          }\n        }\n      )\n      function addMenuItem (predicate) {\n        if (table.firstChild && table.firstChild.className === 'no-suggest') {\n          table.removeChild(table.firstChild)\n        }\n        const Label = UI.utils.predicateLabelForXML(predicate, false)\n        // Label = Label.slice(0,1).toUpperCase() + Label.slice(1);\n\n        if (!predicate.uri) return // bnode\n        let theNamespace = '??'\n        for (const name in NameSpaces) {\n          UI.log.debug(NameSpaces[name])\n          if ($rdf.Util.string_startswith(predicate.uri, NameSpaces[name])) {\n            theNamespace = name\n            break\n          }\n        }\n\n        const tr = table.appendChild(myDocument.createElement('tr'))\n        tr.setAttribute('about', predicate)\n        const th = tr.appendChild(myDocument.createElement('th'))\n        th.appendChild(myDocument.createElement('div')).appendChild(\n          myDocument.createTextNode(Label)\n        )\n        tr.appendChild(myDocument.createElement('td')).appendChild(\n          myDocument.createTextNode(theNamespace.toUpperCase())\n        )\n      }\n      function addPredicateChoice (selectedQuery) {\n        return function (bindings) {\n          const predicate = bindings[selectedQuery.vars[0]]\n          addMenuItem(predicate)\n        }\n      }\n      function clearMenu (e) {\n        This.clearMenu()\n        e.stopPropagation()\n      }\n      let inputText\n      let bnodeTerm\n      let IDpredicate\n      let IDterm\n      let tr\n      let th\n      switch (menuType) {\n        case 'DidYouMeanDialog': {\n          const dialogTerm = extraInformation.dialogTerm\n          bnodeTerm = extraInformation.bnodeTerm\n          // have to do style instruction passing\n          menu.style.width = 'auto'\n\n          const h1 = table.appendChild(myDocument.createElement('tr'))\n          const h1th = h1.appendChild(myDocument.createElement('th'))\n          h1th.appendChild(myDocument.createTextNode('Did you mean...'))\n          const plist = store.statementsMatching(dialogTerm)\n          let i\n          for (i = 0; i < plist.length; i++) {\n            if (\n              store.whether(\n                plist[i].predicate,\n                rdf('type'),\n                UI.ns.owl('InverseFunctionalProperty')\n              )\n            ) {\n              break\n            }\n          }\n          const IDpredicate = plist[i].predicate\n          const IDterm = store.any(dialogTerm, plist[i].predicate)\n          const text =\n            UI.utils.label(dialogTerm) +\n            ' who has ' +\n            UI.utils.label(IDpredicate) +\n            ' ' +\n            IDterm +\n            '?'\n          const h2 = table.appendChild(myDocument.createElement('tr'))\n          const h2th = h2.appendChild(myDocument.createElement('th'))\n          h2th.appendChild(myDocument.createTextNode(text))\n          h1th.setAttribute('colspan', '2')\n          h2th.setAttribute('colspan', '2')\n          const ans1 = table.appendChild(myDocument.createElement('tr'))\n          ans1\n            .appendChild(myDocument.createElement('th'))\n            .appendChild(myDocument.createTextNode('Yes'))\n          ans1\n            .appendChild(myDocument.createElement('td'))\n            .appendChild(myDocument.createTextNode('BOOLEAN'))\n          const ans2 = table.appendChild(myDocument.createElement('tr'))\n          ans2\n            .appendChild(myDocument.createElement('th'))\n            .appendChild(myDocument.createTextNode('No'))\n          ans2\n            .appendChild(myDocument.createElement('td'))\n            .appendChild(myDocument.createTextNode('BOOLEAN'))\n          break\n        }\n        case 'PredicateAutoComplete': // Prompt user  for possible relationships for new data\n        {\n          inputText = extraInformation.inputText\n          /*   The labeller functionality code ahs been lost or dropped -- reinstate this? */\n          // @@ TODO: Write away the need for exception on next line\n\n          const predicates = outline.labeller.searchAdv(\n            inputText,\n            undefined,\n            'predicate'\n          )\n          // @@ TODO: Write away the need for exception on next line\n\n          const results = [] // @@ fixme\n          for (let i = 0; i < predicates.length; i++) {\n            const tempQuery = {}\n            tempQuery.vars = []\n            tempQuery.vars.push('Kenny')\n            const tempBinding = {}\n            tempBinding.Kenny = store.fromNT(predicates[i].NT)\n            try {\n              addPredicateChoice(tempQuery)(tempBinding)\n            } catch (e) {\n              throw new Error('I\\'ll deal with bnodes later...[Kenny]' + e)\n            } // I'll deal with bnodes later...\n          }\n\n          // @@ TODO: Write away the need for exception on next line\n\n          const entries = results[0]\n          if (entries.length === 0) {\n            console.log('cm length 0\\n') // hq\n            this.clearMenu()\n            return\n          }\n          for (let i = 0; i < entries.length && i < 10; i++) {\n            // do not show more than 30 items\n            addMenuItem(entries[i][1])\n          }\n          break\n        }\n        case 'GeneralAutoComplete': {\n          inputText = extraInformation.inputText\n          let results\n          try {\n            results = outline.labeller.search(inputText)\n          } catch (e) {\n            console.log(\n              'GeneralAutoComplete: debug me ' +\n                extraInformation.selectedTd.textContent +\n                '\\n' +\n                e +\n                '\\n'\n            )\n          }\n          const entries = results[0] // [label, subject,priority]\n          const types = results[1]\n          if (entries.length === 0) {\n            console.log('cm length 0\\n') // hq\n            this.clearMenu()\n            return\n          }\n          for (let i = 0; i < entries.length && i < 10; i++) {\n            // do not show more than 30 items\n            // console.log(\"\\nGEN ENTRIES[\"+i+\"] = \"+entries[i]+\"\\n\");//hq\n            const thisNT = entries[i][1].toNT()\n            // console.log(\"thisNT=\"+thisNT+\"\\n\");\n            tr = table.appendChild(myDocument.createElement('tr'))\n            tr.setAttribute('about', thisNT)\n            th = tr.appendChild(myDocument.createElement('th'))\n            th.appendChild(myDocument.createElement('div')).appendChild(\n              myDocument.createTextNode(entries[i][0])\n            )\n            // var theTerm = entries[i][1]\n            // var type=theTerm?kb.any(kb.fromNT(thisNT),rdf('type')):undefined;\n            const type = types[i]\n            const typeLabel = type ? UI.utils.label(type) : ''\n            tr.appendChild(myDocument.createElement('td')).appendChild(\n              myDocument.createTextNode(typeLabel)\n            )\n          }\n          /* var choices=extraInformation.choices;\n                var index=extraInformation.index;\n                for (var i=index-10;i<index+20;i++){ //show 30 items\n                    if (i<0) i=0;\n                    if (i==choices.length) break;\n                    var thisNT=choices[i].NT;\n                    var tr=table.appendChild(myDocument.createElement('tr'));\n                    tr.setAttribute('about',thisNT);\n                    var th=tr.appendChild(myDocument.createElement('th'))\n                    th.appendChild(myDocument.createElement('div')).appendChild(myDocument.createTextNode(choices[i].label));\n                    var theTerm=kb.fromNT(thisNT);\n                    var type=theTerm?kb.any(kb.fromNT(thisNT),rdf('type')):undefined;\n                    var typeLabel=type?label(type):\"\";\n                    tr.appendChild(myDocument.createElement('td')).appendChild(myDocument.createTextNode(typeLabel));\n                }\n                */\n          break\n        }\n        case 'JournalTitleAutoComplete': { // hql\n          // HEART OF JOURNAL TITLE AUTOCOMPLETE\n\n          // extraInformatin is from above getAutoCompleteHandler\n          inputText = extraInformation.inputText\n          console.log('testing searching text= ' + inputText + ' =====\\n')\n          console.log('\\n===start JournalTitleAutoComplete\\n')\n\n          // Gets all the URI's with type Journal in the knowledge base\n          const juris = store.each(undefined, rdf('type'), bibo('Journal'))\n\n          const matchedtitle = [] // debugging display before inserts into menu\n\n          for (let i = 0; i < juris.length; i++) {\n            const juri = juris[i]\n            const jtitle = store.each(juri, dcelems('title'), undefined)\n\n            const jtstr = jtitle + ''\n\n            const matchstr = inputText.toLowerCase()\n            const jTitleLowerCase = jtstr.toLowerCase()\n\n            // If the inputText as a whole is contained in a journal title\n            if (jTitleLowerCase.search(matchstr) !== -1) {\n              qp('FOUND A Journal Title Match!!!!!!')\n              matchedtitle.push(jtitle)\n\n              // Add it as a row to the menu:\n              // === Title, URI ==\n              const tr = table.appendChild(myDocument.createElement('tr'))\n              tr.setAttribute('about', 'journalTitle')\n              const th = tr.appendChild(myDocument.createElement('th'))\n              th.appendChild(myDocument.createElement('div')).appendChild(\n                myDocument.createTextNode(jtitle)\n              )\n              tr.appendChild(myDocument.createElement('td')).appendChild(\n                myDocument.createTextNode(juri)\n              )\n            }\n          }\n\n          console.log('matched: ' + matchedtitle + '\\n')\n\n          console.log('\\\\\\\\done showMenu\\'s JTAutocomplete\\n')\n          break\n        }\n        case 'LimitedPredicateChoice': {\n          const choiceTerm = UI.utils.getAbout(store, extraInformation.clickedTd)\n          // because getAbout relies on kb.fromNT, which does not deal with\n          // the 'Collection' termType. This termType is ambiguous anyway.\n          choiceTerm.termType = 'Collection'\n          const choices = store.each(choiceTerm, UI.ns.link('element'))\n          for (let i = 0; i < choices.length; i++) {\n            addMenuItem(choices[i])\n          }\n          break\n        }\n        default: {\n          tr = table.appendChild(myDocument.createElement('tr'))\n          tr.className = 'no-suggest'\n          th = tr.appendChild(myDocument.createElement('th'))\n          th.appendChild(myDocument.createElement('div')).appendChild(\n            myDocument.createTextNode(\n              'No suggested choices. Try to type instead.'\n            )\n          )\n          tr.appendChild(myDocument.createElement('td')).appendChild(\n            myDocument.createTextNode('OK')\n          )\n          // var This = this\n          tr.addEventListener('click', clearMenu, 'false')\n\n          const nullFetcher = function () {}\n          switch (inputQuery.constructor.name) {\n            case 'Array':\n              for (let i = 0; i < inputQuery.length; i++) {\n                store.query(\n                  inputQuery[i],\n                  addPredicateChoice(inputQuery[i]),\n                  nullFetcher\n                )\n              }\n              break\n            case 'undefined':\n              throw new Error('addPredicateChoice: query is not defined')\n            // break\n            default:\n              store.query(inputQuery, addPredicateChoice(inputQuery), nullFetcher)\n          }\n        }\n      }\n    }, // funciton showMenu\n\n    /* When a blank is filled. This happens even for blue-cross editing. */\n    fillInRequest: function fillInRequest (type, selectedTd, inputTerm) {\n      const tr = selectedTd.parentNode\n      const stat = tr.AJAR_statement\n      const isInverse = tr.AJAR_inverse\n\n      const reqTerm = type === 'object' ? stat.object : stat.predicate\n      let newStat\n      let doNext = false\n\n      // RDF Event\n\n      let eventhandler\n      if (store.any(reqTerm, UI.ns.link('onfillin'))) {\n        /*    2017 -- Not sure what is supposed to happen here -- timbl @@@@\n        eventhandler = function(subject) {\n          return kb.any(reqTerm, UI.ns.link('onfillin')).value)\n        }\n        */\n      }\n\n      if (type === 'predicate') {\n        // ToDo: How to link two things with an inverse relationship\n        const newTd = outline.outlinePredicateTD(inputTerm, tr, false, false)\n        if (selectedTd.nextSibling.className !== 'undetermined') {\n          const s = new $rdf.Statement(\n            stat.subject,\n            inputTerm,\n            stat.object,\n            stat.why\n          )\n\n          try {\n            store.updater.update([], [s], function (\n              uri,\n              success,\n              errorBody\n            ) {\n              if (success) {\n                newStat = store.anyStatementMatching(\n                  stat.subject,\n                  inputTerm,\n                  stat.object,\n                  stat.why\n                )\n                tr.AJAR_statement = newStat\n                newTd.className = newTd.className.replace(/ pendingedit/g, '')\n              } else {\n                // outline.UserInput.deleteTriple(newTd,true);\n                // Warn the user that the write has failed.\n                UI.log.warn(\n                  'Failure occurs (#2) while inserting ' +\n                    tr.AJAR_statement +\n                    '\\n\\n' +\n                    errorBody\n                )\n              }\n            })\n          } catch (e) {\n            UI.log.error(e)\n            // Warn the user that the write has failed.\n            UI.log.warn(\n              'Error when insert (#2) of statement ' + s + ':\\n\\t' + e\n            )\n            return\n          }\n\n          newTd.className += ' pendingedit'\n          this.lastModified = null\n        } else {\n          this.formUndetStat(\n            tr,\n            stat.subject,\n            inputTerm,\n            stat.object,\n            stat.why,\n            false\n          )\n          outline.walk('right')\n          doNext = true\n        }\n        outline.replaceTD(newTd, selectedTd)\n        TempFormula.remove(stat)\n      } else if (type === 'object') {\n        // Object value has been edited\n        const newTd = outline.outlineObjectTD(inputTerm)\n        outline.replaceTD(newTd, selectedTd)\n        if (\n          !selectedTd.previousSibling ||\n          selectedTd.previousSibling.className !== 'undetermined'\n        ) {\n          let s\n          if (!isInverse) {\n            s = new $rdf.Statement(\n              stat.subject,\n              stat.predicate,\n              inputTerm,\n              stat.why\n            )\n          } else {\n            s = new $rdf.Statement(\n              inputTerm,\n              stat.predicate,\n              stat.object,\n              stat.why\n            )\n          }\n\n          try {\n            store.updater.update([], [s], function (\n              uri,\n              success,\n              _errorBody\n            ) {\n              UI.log.info(\n                '@@ usinput.js (object) callback ok=' +\n                  success +\n                  ' for statement:' +\n                  s +\n                  '\\n '\n              )\n              let newStats\n              if (success) {\n                newTd.className = newTd.className.replace(/ pendingedit/g, '') // User feedback\n                if (!isInverse) {\n                  newStats = store.statementsMatching(\n                    stat.subject,\n                    stat.predicate,\n                    inputTerm,\n                    stat.why\n                  )\n                } else {\n                  newStats = store.statementsMatching(\n                    inputTerm,\n                    stat.predicate,\n                    stat.object,\n                    stat.why\n                  )\n                }\n                if (!newStats.length) {\n                  UI.log.error('userinput.js 1711: Can\\'t find statememt!')\n                }\n                tr.AJAR_statement = newStats[0]\n              } else {\n                UI.log.warn(\n                  'userinput.js (object): Fail trying to insert statement ' + s\n                )\n                // outline.UserInput.deleteTriple(newTd,true);\n              }\n            })\n          } catch (e) {\n            // outline.UserInput.deleteTriple(newTd,true);\n            UI.log.error(\n              'userinput.js (object): exception trying to insert statement ' +\n                s +\n                ': ' +\n                UI.utils.stackString(e)\n            )\n            UI.log.warn('Error trying to insert statement ' + s + ':\\n' + e)\n            return\n          }\n\n          this.lastModified = null\n          newTd.className += ' pendingedit'\n        } else {\n          // ?this.formUndetStat(tr...)\n          outline.walk('left')\n          doNext = true\n        }\n        // removal of the undetermined statement\n        TempFormula.remove(stat)\n      }\n      // do not throw away user's work even update fails\n      UserInputFormula.statements.push(newStat)\n      if (eventhandler) eventhandler(stat.subject)\n      if (doNext) {\n        this.startFillInText(outline.getSelection()[0])\n      } else {\n        return true\n      } // can clearMenu\n    },\n\n    formUndetStat: function formUndetStat (\n      trNode,\n      subject,\n      predicate,\n      object,\n      why,\n      inverse\n    ) {\n      trNode.AJAR_inverse = inverse\n      trNode.AJAR_statement = TempFormula.add(subject, predicate, object, why)\n      return trNode.AJAR_statement\n    }\n  }\n}\n"],"mappings":"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","ignoreList":[]}