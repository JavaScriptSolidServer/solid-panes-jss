{"version":3,"file":"microblogPane.js","names":["authn","store","UI","$rdf","icon","icons","originalIconBase","name","label","subject","whether","ns","rdf","foaf","render","s","doc","SIOC","Namespace","SIOCt","FOAF","terms","RDF","kb","charCount","sf","fetcher","sparqlUpdater","updater","FollowList","user","userlist","uris","myFollows","each","sym","mf","add","any","uri","prototype","push","selectUser","length","Favorites","favorites","favoritesURI","split","created","c","favs","f","favorited","post","callback","batch","Statement","insert_statement","a","success","predicate","object","why","remove","delete_statement","Microblog","theUser","currentUser","theAccount","preferences","get","getUser","User","avatar","id","getPost","Post","postLink","Date","anyValue","h","getHours","m","getMinutes","mo","da","ds","getDay","getDate","getMonth","getFullYear","date","mentions","message","String","creator","gen_random_uri","base","uriNonce","Math","floor","random","statusUpdate","statusMsg","replyTo","meta","myUserURI","getMyURI","myUser","newPost","microlist","micro","microlistelement","r","recipients","mblogs","mbl","replyBatch","b","me","console","log","myMicroblog","generateNewMB","loc","host","rememberMicroblog","set","cbgenUserMB","d","alert","triple","genUserMB","mb","myFavorites","myFollowList","Pane","microblogPane","TabManager","tablist","tabView","createElement","className","create","caption","view","isDefault","tab","innerHTML","change","addEventListener","evt","target","appendChild","getTabView","getElementById","replace","accounts","account","Ifollow","resourceType","thisIsMe","meUri","Tab","notify","messageString","xmsg","setTimeout","removeChild","header","that","lsFollowUser","username","mbconfirmFollow","_msg","followMe","removeMany","xfollowButton","disabled","followButtonLabel","doFollow","value","mbCancelNewMB","_evt","xupdateContainer","childNodes","xcreateNewMB","lsCreateNewMB","xcmb","xcmbName","xcmbId","xcmbAvatar","workspace","xcmbWritable","focus","mbSubmitPost","cbconfirmSubmit","responseText","xupdateSubmit","xupdateStatus","mbLetterCount","insertBefore","generatePost","words","mbUpdateWithReplies","xinReplyToContainer","word","match","atUser","recipient","xrecipients","xrecipientsSubmit","type","parentNode","recipChoice","recip","choice","toLowerCase","xupdateStatusCounter","style","color","xviewReply","headerContainer","xnotify","createTextNode","cols","xnewUser","subheaderContainer","creators","src","userName","setAttribute","xtabsList","_me","viewPost","i","xcloseContainer","xcloseButton","xpost","uholdsaccount","undefined","xuname","href","xunameText","xuavatar","xpostContent","postText","xpostLink","tags","mention","lookUpThing","postTags","postFunction","p","pop","t","person","replacePerson","RegExp","inReplyTo","xreplyTo","theReply","reply","genReplyTo","mbReplyTo","xconfirmDeletionDialog","mbDeletePost","lsconfirmNo","lsconfirmYes","reallyDelete","keyCode","confirmyes","confirmno","mbconfirmDeletePost","deleteThisNode","deleteMe","deleteContainerOf","deleteContainer","statementsMatching","getAttribute","batch_delete_statement","themaker","xreplyButton","xdeleteButton","mbFavorite","nid","favpost","xfavorite","cbFavorite","_c","_d","generatePostList","gmbPosts","postList","postlist","datelist","postDate","sort","reverse","followsView","getFollowed","userid","follow","fol","xfollows","creatorFollows","xfollowsList","thisPerson","streamView","postContainer","mbPosts","follows","smicroblogs","smb","concat","notificationsView","postNotificationContainer","postMentionContainer","mbnPosts","mbmPosts","microblogs","mbm","postNotificationList","postMentionList","build","microblogpane","ppane"],"sources":["../../src/microblogPane/microblogPane.js"],"sourcesContent":["/*\n Microblog pane\n Charles McKenzie <charles2@mit.edu>\n*/\n/* global alert */\nimport { authn, store } from 'solid-logic-jss'\nimport * as UI from 'solid-ui-jss'\nimport * as $rdf from 'rdflib'\n\nexport default {\n  icon: UI.icons.originalIconBase + 'microblog/microblog.png',\n  name: 'microblogPane',\n  label: function (subject) {\n    if (store.whether(subject, UI.ns.rdf('type'), UI.ns.foaf('Person'))) {\n      return 'Microblog'\n    } else {\n      return null\n    }\n  },\n  render: function (s, doc) {\n    //* **********************************************\n    // NAMESPACES  SECTION\n    //* **********************************************\n    const SIOC = $rdf.Namespace('http://rdfs.org/sioc/ns#')\n    const SIOCt = $rdf.Namespace('http://rdfs.org/sioc/types#')\n    const FOAF = $rdf.Namespace('http://xmlns.com/foaf/0.1/')\n    const terms = $rdf.Namespace('http://purl.org/dc/terms/')\n    const RDF = UI.ns.rdf\n\n    const kb = store\n    const charCount = 140\n    const sf = store.fetcher\n    //* **********************************************\n    // BACK END\n    //* **********************************************\n    const sparqlUpdater = kb.updater\n    // ----------------------------------------------\n    // FOLLOW LIST\n    // store the URIs of followed users for\n    // dereferencing the @replies\n    // ----------------------------------------------\n    const FollowList = function (user) {\n      this.userlist = {}\n      this.uris = {}\n      const myFollows = kb.each(kb.sym(user), SIOC('follows'))\n      for (const mf in myFollows) {\n        this.add(kb.any(myFollows[mf], SIOC('id')), myFollows[mf].uri)\n      }\n    }\n    FollowList.prototype.add = function (user, uri) {\n      // add a user to the follows store\n      if (this.userlist[user]) {\n        if (!(uri in this.uris)) {\n          this.userlist[user].push(uri)\n          this.uris[uri] = ''\n        }\n      } else {\n        this.userlist[user] = [uri]\n      }\n    }\n    FollowList.prototype.selectUser = function (user) {\n      // check if a user is in the follows list.\n      if (this.userlist[user]) {\n        return [this.userlist[user].length === 1, this.userlist[user]]\n      } else {\n        // user does not follow any users with this nick\n        return [false, []]\n      }\n    }\n    // ----------------------------------------------\n    // FAVORITES\n    // controls the list of favorites.\n    // constructor expects a user as uri.\n    // ----------------------------------------------\n    const Favorites = function (user) {\n      this.favorites = {}\n      this.favoritesURI = ''\n      if (!user) {\n        // TODO is this even useful?\n        return\n      }\n      this.user = user.split('#')[0]\n      const created = kb.each(kb.sym(user), SIOC('creator_of'))\n      for (const c in created) {\n        if (kb.whether(created[c], RDF('type'), SIOCt('FavouriteThings'))) {\n          this.favoritesURI = created[c]\n          const favs = kb.each(created[c], SIOC('container_of'))\n          for (const f in favs) {\n            this.favorites[favs[f]] = ''\n          }\n          break\n        }\n      }\n    }\n    Favorites.prototype.favorited = function (post) {\n      /* Favorited- returns true if the post is a favorite\n      false otherwise */\n      return kb.sym(post) in this.favorites\n    }\n    Favorites.prototype.add = function (post, callback) {\n      const batch = new $rdf.Statement(\n        this.favoritesURI,\n        SIOC('container_of'),\n        kb.sym(post),\n        kb.sym(this.user)\n      )\n      sparqlUpdater.insert_statement(batch, function (a, success, c) {\n        if (success) {\n          kb.add(batch.subject, batch.predicate, batch.object, batch.why)\n        }\n        callback(a, success, c)\n      })\n    }\n    Favorites.prototype.remove = function (post, callback) {\n      const batch = new $rdf.Statement(\n        this.favoritesURI,\n        SIOC('container_of'),\n        kb.sym(post),\n        kb.sym(this.user)\n      )\n      sparqlUpdater.delete_statement(batch, function (a, success, c) {\n        if (success) {\n          kb.add(batch.subject, batch.predicate, batch.object, batch.why)\n        }\n        callback(a, success, c)\n      })\n    }\n    // ----------------------------------------------\n    // MICROBLOG\n    // store the uri's of followed users for\n    // dereferencing the @replies.\n    // ----------------------------------------------\n    const Microblog = function (kb) {\n      this.kb = kb\n\n      // attempt to fetch user account from local preferences if just\n      // in case the user's foaf was not writable. add it to the store\n      // this will probably need to change.\n      const theUser = authn.currentUser()\n\n      if (theUser) {\n        let theAccount = UI.preferences.get('acct')\n\n        if (theAccount) {\n          theAccount = kb.sym(theAccount)\n        }\n\n        if (theUser && theAccount) {\n          kb.add(\n            theUser,\n            FOAF('holdsAccount'),\n            theAccount,\n            theUser.uri.split('#')[0]\n          )\n        }\n      }\n    }\n    Microblog.prototype.getUser = function (uri) {\n      const User = {}\n      User.name = kb.any(uri, SIOC('name')) ? kb.any(uri, SIOC('name')) : ''\n      User.avatar = kb.any(uri, SIOC('avatar'))\n        ? kb.any(uri, SIOC('avatar'))\n        : ''\n      User.id = kb.any(uri, SIOC('id'))\n      User.sym = uri\n      return User\n    }\n\n    Microblog.prototype.getPost = function (uri) {\n      const Post = {}\n      // date ----------\n      let postLink = new Date(kb.anyValue(uri, terms('created')))\n      let h = postLink.getHours()\n      const a = h > 12 ? ' PM' : ' AM'\n      h = h > 12 ? h - 12 : h\n      let m = postLink.getMinutes()\n      m = m < 10 ? '0' + m : m\n      const mo = [\n        'Jan',\n        'Feb',\n        'Mar',\n        'Apr',\n        'May',\n        'Jun',\n        'Jul',\n        'Aug',\n        'Sep',\n        'Oct',\n        'Nov',\n        'Dec'\n      ]\n      const da = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n      const ds =\n        da[postLink.getDay()] +\n        ' ' +\n        postLink.getDate() +\n        ' ' +\n        mo[postLink.getMonth()] +\n        ' ' +\n        postLink.getFullYear()\n      postLink = h + ':' + m + a + ' on ' + ds\n      Post.date = postLink\n      // ---------\n      Post.mentions = ''\n      Post.message = String(kb.any(uri, SIOC('content')))\n      Post.creator = kb.any(uri, SIOC('has_creator'))\n      Post.uri = ''\n      return Post\n    }\n    Microblog.prototype.gen_random_uri = function (base) {\n      // generate random uri\n      const uriNonce = base + '#n' + Math.floor(Math.random() * 10e9)\n      return kb.sym(uriNonce)\n    }\n    Microblog.prototype.statusUpdate = function (\n      statusMsg,\n      callback,\n      replyTo,\n      meta\n    ) {\n      const myUserURI = this.getMyURI()\n      const myUser = kb.sym(myUserURI.split('#')[0])\n      const newPost = this.gen_random_uri(myUser.uri)\n      const microlist = kb.each(kb.sym(myUserURI), SIOC('creator_of'))\n      let micro\n      for (const microlistelement in microlist) {\n        if (\n          kb.whether(\n            microlist[microlistelement],\n            RDF('type'),\n            SIOCt('Microblog')\n          ) &&\n          !kb.whether(\n            microlist[microlistelement],\n            SIOC('topic'),\n            kb.sym(this.getMyURI())\n          )\n        ) {\n          micro = microlist[microlistelement]\n          break\n        }\n      }\n\n      // generate new post\n      const batch = [\n        new $rdf.Statement(\n          newPost,\n          RDF('type'),\n          SIOCt('MicroblogPost'),\n          myUser\n        ),\n        new $rdf.Statement(\n          newPost,\n          SIOC('has_creator'),\n          kb.sym(myUserURI),\n          myUser\n        ),\n        new $rdf.Statement(newPost, SIOC('content'), statusMsg, myUser),\n        new $rdf.Statement(newPost, terms('created'), new Date(), myUser),\n        new $rdf.Statement(micro, SIOC('container_of'), newPost, myUser)\n      ]\n\n      // message replies\n      if (replyTo) {\n        batch.push(\n          new $rdf.Statement(\n            newPost,\n            SIOC('reply_of'),\n            kb.sym(replyTo),\n            myUser\n          )\n        )\n      }\n\n      // @replies, #hashtags, !groupReplies\n      for (const r in meta.recipients) {\n        batch.push(\n          new $rdf.Statement(\n            newPost,\n            SIOC('topic'),\n            kb.sym(meta.recipients[r]),\n            myUser\n          )\n        )\n        batch.push(\n          new $rdf.Statement(kb.any(), SIOC('container_of'), newPost, myUser)\n        )\n        const mblogs = kb.each(kb.sym(meta.recipients[r]), SIOC('creator_of'))\n        for (const mbl in mblogs) {\n          if (\n            kb.whether(mblogs[mbl], SIOC('topic'), kb.sym(meta.recipients[r]))\n          ) {\n            const replyBatch = new $rdf.Statement(\n              mblogs[mbl],\n              SIOC('container_of'),\n              newPost,\n              kb.sym(meta.recipients[r].split('#')[0])\n            )\n            sparqlUpdater.insert_statement(replyBatch)\n          }\n        }\n      }\n\n      sparqlUpdater.insert_statement(batch, function (a, b, c) {\n        callback(a, b, c, batch)\n      })\n    }\n    Microblog.prototype.getMyURI = function () {\n      const me = authn.currentUser()\n      console.log(me)\n      const myMicroblog = kb.any(kb.sym(me), FOAF('holdsAccount'))\n      console.log('\\n\\n' + myMicroblog)\n      return myMicroblog ? myMicroblog.uri : false\n    }\n    Microblog.prototype.generateNewMB = function (id, name, avatar, loc) {\n      const host = loc + '/' + id\n      const rememberMicroblog = function () {\n        UI.preferences.set('acct', host + '#' + id)\n      }\n      const cbgenUserMB = function (a, success, c, d) {\n        if (success) {\n          alert(\n            'Microblog generated at ' +\n              host +\n              '#' +\n              id +\n              'please add <b>' +\n              host +\n              '</b> to your foaf.'\n          )\n          // mbCancelNewMB()   @@TBD\n          // assume the foaf is not writable and store the microblog to the\n          // preferences for later retrieval.\n          // this will probably need to change.\n          rememberMicroblog()\n          for (const triple in d) {\n            kb.add(\n              d[triple].subject,\n              d[triple].predicate,\n              d[triple].object,\n              d[triple].why\n            )\n          }\n        }\n      }\n\n      const genUserMB = [\n        // user\n        new $rdf.Statement(\n          kb.sym(host + '#' + id),\n          RDF('type'),\n          SIOC('User'),\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#' + id),\n          SIOC('creator_of'),\n          kb.sym(host + '#mb'),\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#' + id),\n          SIOC('creator_of'),\n          kb.sym(host + '#mbn'),\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#' + id),\n          SIOC('creator_of'),\n          kb.sym(host + '#fav'),\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#' + id),\n          SIOC('name'),\n          name,\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#' + id),\n          SIOC('id'),\n          id,\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#' + id),\n          RDF('label'),\n          id,\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          s,\n          FOAF('holdsAccount'),\n          kb.sym(host + '#' + id),\n          kb.sym(host)\n        ),\n        // microblog\n        new $rdf.Statement(\n          kb.sym(host + '#mb'),\n          RDF('type'),\n          SIOCt('Microblog'),\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#mb'),\n          SIOC('has_creator'),\n          kb.sym(host + '#' + id),\n          kb.sym(host)\n        ),\n        // notification microblog\n        new $rdf.Statement(\n          kb.sym(host + '#mbn'),\n          RDF('type'),\n          SIOCt('Microblog'),\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#mbn'),\n          SIOC('topic'),\n          kb.sym(host + '#' + id),\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#mbn'),\n          SIOC('has_creator'),\n          kb.sym(host + '#' + id),\n          kb.sym(host)\n        ),\n        // favorites container\n        new $rdf.Statement(\n          kb.sym(host + '#fav'),\n          RDF('type'),\n          SIOCt('FavouriteThings'),\n          kb.sym(host)\n        ),\n        new $rdf.Statement(\n          kb.sym(host + '#fav'),\n          SIOC('has_creator'),\n          kb.sym(host + '#' + id),\n          kb.sym(host)\n        )\n      ]\n      if (avatar) {\n        // avatar optional\n        genUserMB.push(\n          new $rdf.Statement(\n            kb.sym(host + '#' + id),\n            SIOC('avatar'),\n            kb.sym(avatar),\n            kb.sym(host)\n          )\n        )\n      }\n      sparqlUpdater.insert_statement(genUserMB, cbgenUserMB)\n    }\n    const mb = new Microblog(kb)\n    const myFavorites = new Favorites(mb.getMyURI())\n    const myFollowList = new FollowList(mb.getMyURI())\n\n    //* **********************************************\n    // FRONT END FUNCTIONALITY\n    //* **********************************************\n    // ----------------------------------------------\n    // PANE\n    // User Interface for the Microblog Pane\n    // ----------------------------------------------\n    const Pane = function (s, doc, microblogPane) {\n      const TabManager = function (doc) {\n        this.tablist = {}\n        this.doc = doc\n        this.tabView = doc.createElement('ul')\n        this.tabView.className = 'tabslist'\n      }\n      TabManager.prototype.create = function (id, caption, view, isDefault) {\n        const tab = this.doc.createElement('li')\n        tab.innerHTML = caption\n        if (isDefault) {\n          tab.className = 'active'\n        }\n        tab.id = id\n        const change = this.change\n        const tablist = this.tablist\n        tab.addEventListener(\n          'click',\n          function (evt) {\n            change(evt.target.id, tablist, doc)\n          },\n          false\n        )\n\n        this.tablist[id] = { view: view.id, tab }\n        this.tabView.appendChild(tab)\n      }\n      TabManager.prototype.getTabView = function () {\n        return this.tabView\n      }\n      TabManager.prototype.change = function (id, tablist, doc) {\n        for (const tab in tablist) {\n          if (tab === id) {\n            tablist[id].tab.className = 'active'\n            doc.getElementById(tablist[id].view).className += ' active'\n          } else {\n            const view = doc.getElementById(tablist[tab].view)\n            view.className = view.className.replace(/\\w*active\\w*/, '')\n            tablist[tab].tab.className = tablist[id].tab.className.replace(\n              /\\w*active\\w*/,\n              ''\n            )\n          }\n        }\n      }\n      this.microblogPane = microblogPane\n      const accounts = kb.each(s, FOAF('holdsAccount'))\n      let account\n      for (const a in accounts) {\n        if (\n          kb.whether(accounts[a], RDF('type'), SIOC('User')) &&\n          kb.whether(\n            kb.any(accounts[a], SIOC('creator_of')),\n            RDF('type'),\n            SIOCt('Microblog')\n          )\n        ) {\n          account = accounts[a]\n          break\n        }\n      }\n      this.Ifollow = kb.whether(kb.sym(mb.getMyURI()), SIOC('follows'), account)\n      const resourceType = kb.any(s, RDF('type'))\n      if (\n        resourceType.uri === SIOCt('Microblog').uri ||\n        resourceType.uri === SIOCt('MicroblogPost').uri\n      ) {\n        this.thisIsMe = kb.any(s, SIOC('has_creator')).uri === mb.getMyURI()\n      } else if (resourceType.uri === SIOC('User').uri) {\n        this.thisIsMe = s.uri === mb.getMyURI()\n      } else if (resourceType.uri === FOAF('Person').uri) {\n        const me = authn.currentUser()\n        const meUri = me && me.uri\n        this.thisIsMe = s.uri === meUri\n      } else {\n        this.thisIsMe = false\n      }\n\n      this.Tab = new TabManager(doc)\n    }\n\n    Pane.prototype.notify = function (messageString) {\n      const xmsg = doc.createElement('li')\n      xmsg.className = 'notify'\n      xmsg.innerHTML = messageString\n      doc.getElementById('notify-container').appendChild(xmsg)\n      setTimeout(function () {\n        doc.getElementById('notify-container').removeChild(xmsg)\n        // delete xmsg;\n      }, 4000)\n    }\n\n    Pane.prototype.header = function (s, doc) {\n      const that = this\n      function lsFollowUser () {\n        const myUser = kb.sym(mb.getMyURI())\n        // var Ifollow = that.Ifollow\n        const username = that.creator.name\n        const mbconfirmFollow = function (uri, success, _msg) {\n          if (success === true) {\n            if (!that.Ifollow) {\n              // prevent duplicate entries from being added to kb (because that was happening)\n              if (\n                !kb.whether(\n                  followMe.subject,\n                  followMe.predicate,\n                  followMe.object,\n                  followMe.why\n                )\n              ) {\n                kb.add(\n                  followMe.subject,\n                  followMe.predicate,\n                  followMe.object,\n                  followMe.why\n                )\n              }\n            } else {\n              kb.removeMany(\n                followMe.subject,\n                followMe.predicate,\n                followMe.object,\n                followMe.why\n              )\n            }\n            console.log(that.Ifollow)\n            that.Ifollow = !that.Ifollow\n            xfollowButton.disabled = false\n            console.log(that.Ifollow)\n            const followButtonLabel = that.Ifollow ? 'Unfollow ' : 'Follow '\n            const doFollow = that.Ifollow ? 'now follow ' : 'no longer follow '\n            xfollowButton.value = followButtonLabel + username\n            that.notify('You ' + doFollow + username + '.')\n          }\n        }\n        const followMe = new $rdf.Statement(\n          myUser,\n          SIOC('follows'),\n          that.creator.sym,\n          myUser\n        )\n        xfollowButton.disabled = true\n        xfollowButton.value = 'Updating...'\n        if (!that.Ifollow) {\n          sparqlUpdater.insert_statement(followMe, mbconfirmFollow)\n        } else {\n          sparqlUpdater.delete_statement(followMe, mbconfirmFollow)\n        }\n      }\n      const notify = function (messageString) {\n        const xmsg = doc.createElement('li')\n        xmsg.className = 'notify'\n        xmsg.innerHTML = messageString\n        doc.getElementById('notify-container').appendChild(xmsg)\n        setTimeout(function () {\n          doc.getElementById('notify-container').removeChild(xmsg)\n          // delete xmsg;\n        }, 4000)\n      }\n      const mbCancelNewMB = function (_evt) {\n        xupdateContainer.removeChild(\n          xupdateContainer.childNodes[xupdateContainer.childNodes.length - 1]\n        )\n        xcreateNewMB.disabled = false\n      }\n      const lsCreateNewMB = function (_evt) {\n        // disable the create new microblog button.\n        // then prefills the information.\n        xcreateNewMB.disabled = true\n        const xcmb = doc.createElement('div')\n        const xcmbName = doc.createElement('input')\n        if (kb.whether(s, FOAF('name'))) {\n          // handle use of FOAF:NAME\n          xcmbName.value = kb.any(s, FOAF('name'))\n        } else {\n          // handle use of family and given name\n          xcmbName.value = kb.any(s, FOAF('givenname'))\n            ? kb.any(s, FOAF('givenname')) + ' '\n            : ''\n          xcmbName.value += kb.any(s, FOAF('family_name'))\n            ? kb.any(s, FOAF('givenname'))\n            : ''\n          xcmbName.value =\n            kb.any(s, FOAF('givenname')) + ' ' + kb.any(s, FOAF('family_name'))\n        }\n        const xcmbId = doc.createElement('input')\n        xcmbId.value = kb.any(s, FOAF('nick')) ? kb.any(s, FOAF('nick')) : ''\n        const xcmbAvatar = doc.createElement('input')\n        if (kb.whether(s, FOAF('img'))) {\n          // handle use of img\n          xcmbAvatar.value = kb.any(s, FOAF('img')).uri\n        } else {\n          // otherwise try depiction\n          xcmbAvatar.value = kb.any(s, FOAF('depiction'))\n            ? kb.any(s, FOAF('depiction')).uri\n            : ''\n        }\n        let workspace\n        // = kb.any(s,WORKSPACE) //TODO - ADD URI FOR WORKSPACE DEFINITION\n        const xcmbWritable = doc.createElement('input')\n        xcmbWritable.value =\n          workspace || 'http://dig.csail.mit.edu/2007/wiki/sandbox' // @@@\n        xcmb.innerHTML = `\n                        <form class =\"createNewMB\" id=\"createNewMB\">\n                            <p id=\"xcmbname\"><span class=\"\">Name: </span></p>\n                            <p id=\"xcmbid\">Id: </p>\n                            <p id=\"xcmbavatar\">Avatar: </p>\n                            <p id=\"xcmbwritable\">Host my microblog at: </p>\n                            <input type=\"button\" id=\"mbCancel\" value=\"Cancel\" />\n                            <input type=\"submit\" id=\"mbCreate\" value=\"Create!\" />\n                        </form>\n                        `\n        xupdateContainer.appendChild(xcmb)\n        doc.getElementById('xcmbname').appendChild(xcmbName)\n        doc.getElementById('xcmbid').appendChild(xcmbId)\n        doc.getElementById('xcmbavatar').appendChild(xcmbAvatar)\n        doc.getElementById('xcmbwritable').appendChild(xcmbWritable)\n        doc\n          .getElementById('mbCancel')\n          .addEventListener('click', mbCancelNewMB, false)\n        doc.getElementById('createNewMB').addEventListener(\n          'submit',\n          function () {\n            mb.generateNewMB(\n              xcmbId.value,\n              xcmbName.value,\n              xcmbAvatar.value,\n              xcmbWritable.value\n            )\n          },\n          false\n        )\n        xcmbName.focus()\n      }\n      const mbSubmitPost = function () {\n        const meta = {\n          recipients: []\n        }\n        // user has selected a microblog to post to\n        if (mb.getMyURI()) {\n          // let myUser = kb.sym(mb.getMyURI())\n          // submission callback\n          const cbconfirmSubmit = function (uri, success, responseText, d) {\n            if (success === true) {\n              for (const triple in d) {\n                kb.add(\n                  d[triple].subject,\n                  d[triple].predicate,\n                  d[triple].object,\n                  d[triple].why\n                )\n              }\n              xupdateSubmit.disabled = false\n              xupdateStatus.value = ''\n              mbLetterCount()\n              notify('Microblog Updated.')\n              if (that.thisIsMe) {\n                doc\n                  .getElementById('postNotificationList')\n                  .insertBefore(\n                    that.generatePost(d[0].subject),\n                    doc.getElementById('postNotificationList').childNodes[0]\n                  )\n              }\n            } else {\n              notify('There was a problem submitting your post.')\n            }\n          }\n          const words = xupdateStatus.value.split(' ')\n          const mbUpdateWithReplies = function () {\n            xupdateSubmit.disabled = true\n            xupdateSubmit.value = 'Updating...'\n            mb.statusUpdate(\n              xupdateStatus.value,\n              cbconfirmSubmit,\n              xinReplyToContainer.value,\n              meta\n            )\n          }\n          for (const word in words) {\n            if (words[word].match(/@\\w+/)) {\n              const atUser = words[word].replace(/\\W/g, '')\n              const recipient = myFollowList.selectUser(atUser)\n              if (recipient[0] === true) {\n                meta.recipients.push(recipient[1][0])\n              } else if (recipient[1].length > 1) {\n                // if  multiple users allow the user to choose\n                const xrecipients = doc.createElement('select')\n                const xrecipientsSubmit = doc.createElement('input')\n                xrecipientsSubmit.type = 'button'\n                xrecipientsSubmit.value = 'Continue'\n                xrecipientsSubmit.addEventListener(\n                  'click',\n                  function () {\n                    meta.recipients.push(recipient[1][xrecipients.value])\n                    mbUpdateWithReplies()\n                    xrecipients.parentNode.removeChild(xrecipientsSubmit)\n                    xrecipients.parentNode.removeChild(xrecipients)\n                  },\n                  false\n                )\n                const recipChoice = function (recip, c) {\n                  const name = kb.any(kb.sym(recip), SIOC('name'))\n                  const choice = doc.createElement('option')\n                  choice.value = c\n                  choice.innerHTML = name\n                  return choice\n                }\n                for (const r in recipient[1]) {\n                  xrecipients.appendChild(recipChoice(recipient[1][r], r))\n                }\n                xupdateContainer.appendChild(xrecipients)\n                xupdateContainer.appendChild(xrecipientsSubmit)\n                return\n              } else {\n                // no users known or self reference.\n                if (\n                  String(\n                    kb.any(kb.sym(mb.getMyURI()), SIOC('id'))\n                  ).toLowerCase() === atUser.toLowerCase()\n                ) {\n                  meta.recipients.push(mb.getMyURI())\n                } else {\n                  notify(\n                    'You do not follow ' +\n                      atUser +\n                      '. Try following ' +\n                      atUser +\n                      ' before mentioning them.'\n                  )\n                  return\n                }\n              }\n            }\n            /* else if(words[word].match(/\\#\\w+/)){\n                //hashtag\n            } else if(words[word].match(/\\!\\w+/)){\n                //usergroup\n            } */\n          }\n          mbUpdateWithReplies()\n        } else {\n          notify('Please set your microblog first.')\n        }\n      }\n      const mbLetterCount = function () {\n        xupdateStatusCounter.innerHTML = charCount - xupdateStatus.value.length\n        xupdateStatusCounter.style.color =\n          charCount - xupdateStatus.value.length < 0 ? '#c33' : ''\n        if (xupdateStatus.value.length === 0) {\n          xinReplyToContainer.value = ''\n          xupdateSubmit.value = 'Send'\n        }\n      }\n      // reply viewer\n      const xviewReply = doc.createElement('ul')\n      xviewReply.className = 'replyView'\n      xviewReply.addEventListener(\n        'click',\n        function () {\n          xviewReply.className = 'replyView'\n        },\n        false\n      )\n      this.xviewReply = xviewReply\n      const headerContainer = doc.createElement('div')\n      headerContainer.className = 'header-container'\n\n      // ---create status update box---\n      const xnotify = doc.createElement('ul')\n      xnotify.id = 'notify-container'\n      xnotify.className = 'notify-container'\n      this.xnotify = xnotify\n      const xupdateContainer = doc.createElement('form')\n      xupdateContainer.className = 'update-container'\n      xupdateContainer.innerHTML = '<h3>What are you up to?</h3>'\n      let xinReplyToContainer\n      let xupdateStatus\n      let xupdateStatusCounter\n      let xupdateSubmit\n      let xcreateNewMB\n      if (mb.getMyURI()) {\n        xinReplyToContainer = doc.createElement('input')\n        xinReplyToContainer.id = 'xinReplyToContainer'\n        xinReplyToContainer.type = 'hidden'\n\n        xupdateStatus = doc.createElement('textarea')\n        xupdateStatus.id = 'xupdateStatus'\n\n        xupdateStatusCounter = doc.createElement('span')\n        xupdateStatusCounter.appendChild(doc.createTextNode(charCount))\n        xupdateStatus.cols = 30\n        xupdateStatus.addEventListener('keyup', mbLetterCount, false)\n        xupdateStatus.addEventListener('focus', mbLetterCount, false)\n\n        xupdateSubmit = doc.createElement('input')\n        xupdateSubmit.id = 'xupdateSubmit'\n        xupdateSubmit.type = 'submit'\n        xupdateSubmit.value = 'Send'\n\n        xupdateContainer.appendChild(xinReplyToContainer)\n        xupdateContainer.appendChild(xupdateStatusCounter)\n        xupdateContainer.appendChild(xupdateStatus)\n        xupdateContainer.appendChild(xupdateSubmit)\n        xupdateContainer.addEventListener('submit', mbSubmitPost, false)\n      } else {\n        const xnewUser = doc.createTextNode(\n          'Hi, it looks like you don\\'t have a microblog, ' +\n            ' would you like to create one? '\n        )\n        xcreateNewMB = doc.createElement('input')\n        xcreateNewMB.type = 'button'\n        xcreateNewMB.value = 'Create a new Microblog'\n        xcreateNewMB.addEventListener('click', lsCreateNewMB, false)\n        xupdateContainer.appendChild(xnewUser)\n        xupdateContainer.appendChild(xcreateNewMB)\n      }\n\n      headerContainer.appendChild(xupdateContainer)\n\n      const subheaderContainer = doc.createElement('div')\n      subheaderContainer.className = 'subheader-container'\n\n      // user header\n      // this.creator\n      const creators = kb.each(s, FOAF('holdsAccount'))\n      let creator\n      for (const c in creators) {\n        if (\n          kb.whether(creators[c], RDF('type'), SIOC('User')) &&\n          kb.whether(\n            kb.any(creators[c], SIOC('creator_of')),\n            RDF('type'),\n            SIOCt('Microblog')\n          )\n        ) {\n          creator = creators[c]\n          // var mb = kb.sym(creator.uri.split(\"#\")[0]);\n          // store.fetcher.refresh(mb);\n          break\n          // TODO add support for more than one microblog in same foaf\n        }\n      }\n      let xfollowButton\n      if (creator) {\n        this.creator = mb.getUser(creator)\n        // ---display avatar, if available ---\n        if (this.creator.avatar !== '') {\n          const avatar = doc.createElement('img')\n          avatar.src = this.creator.avatar.uri\n          subheaderContainer.appendChild(avatar)\n        }\n        // ---generate name ---\n        const userName = doc.createElement('h1')\n        userName.className = 'fn'\n        userName.appendChild(\n          doc.createTextNode(this.creator.name + ' (' + this.creator.id + ')')\n        )\n        subheaderContainer.appendChild(userName)\n        // ---display follow button---\n        if (!this.thisIsMe && mb.getMyURI()) {\n          xfollowButton = doc.createElement('input')\n          xfollowButton.setAttribute('type', 'button')\n          const followButtonLabel = this.Ifollow ? 'Unfollow ' : 'Follow '\n          xfollowButton.value = followButtonLabel + this.creator.name\n          xfollowButton.addEventListener('click', lsFollowUser, false)\n          subheaderContainer.appendChild(xfollowButton)\n        }\n        // user header end\n        // header tabs\n        const xtabsList = this.Tab.getTabView()\n        headerContainer.appendChild(subheaderContainer)\n        headerContainer.appendChild(xtabsList)\n      }\n      return headerContainer\n    }\n    Pane.prototype.generatePost = function (post, _me) {\n      /*\n      generatePost - Creates and formats microblog posts\n          post - symbol of the uri the post in question\n  */\n      const that = this\n      const viewPost = function (uris) {\n        const xviewReply = that.xviewReply\n        for (let i = 0; i < xviewReply.childNodes.length; i++) {\n          xviewReply.removeChild(xviewReply.childNodes[0])\n        }\n        const xcloseContainer = doc.createElement('li')\n        xcloseContainer.className = 'closeContainer'\n        const xcloseButton = doc.createElement('span')\n        xcloseButton.innerHTML = '&#215;'\n        xcloseButton.className = 'closeButton'\n        xcloseContainer.appendChild(xcloseButton)\n        xviewReply.appendChild(xcloseContainer)\n        for (const uri in uris) {\n          xviewReply.appendChild(\n            that.generatePost(kb.sym(uris[uri]), this.thisIsMe, 'view')\n          )\n        }\n        xviewReply.className = 'replyView-active'\n        that.microblogPane.appendChild(xviewReply)\n      }\n      // container for post\n      const xpost = doc.createElement('li')\n      xpost.className = 'post'\n      xpost.setAttribute('id', String(post.uri).split('#')[1])\n      const Post = mb.getPost(post)\n      // username text\n      // var uname = kb.any(kb.any(post, SIOC('has_creator')), SIOC('id'))\n      const uholdsaccount = kb.any(\n        undefined,\n        FOAF('holdsAccount'),\n        kb.any(post, SIOC('has_creator'))\n      )\n      const xuname = doc.createElement('a')\n      xuname.href = uholdsaccount.uri\n      xuname.className = 'userLink'\n      const xunameText = doc.createTextNode(mb.getUser(Post.creator).id)\n      xuname.appendChild(xunameText)\n      // user image\n      const xuavatar = doc.createElement('img')\n      xuavatar.src = mb.getUser(Post.creator).avatar.uri\n      xuavatar.className = 'postAvatar'\n      // post content\n      const xpostContent = doc.createElement('blockquote')\n      let postText = Post.message\n      // post date\n      const xpostLink = doc.createElement('a')\n      xpostLink.className = 'postLink'\n      xpostLink.addEventListener(\n        'click',\n        function () {\n          viewPost([post.uri])\n        },\n        false\n      )\n      xpostLink.id = 'post_' + String(post.uri).split('#')[1]\n      xpostLink.setAttribute('content', post.uri)\n      xpostLink.setAttribute('property', 'permalink')\n      const postLink = doc.createTextNode(\n        Post.date ? Post.date : 'post date unknown'\n      )\n      xpostLink.appendChild(postLink)\n\n      // LINK META DATA (MENTIONS, HASHTAGS, GROUPS)\n      const mentions = kb.each(post, SIOC('topic'))\n      const tags = {}\n\n      for (const mention in mentions) {\n        sf.lookUpThing(mentions[mention])\n        const id = kb.any(mentions[mention], SIOC('id'))\n        tags['@' + id] = mentions[mention]\n      }\n      const postTags = postText.match(/(@|#|!)\\w+/g)\n      const postFunction = function () {\n        const p = postTags.pop()\n        return tags[p]\n          ? kb.any(undefined, FOAF('holdsAccount'), tags[p]).uri\n          : p\n      }\n      for (const t in tags) {\n        const person = t.replace(/@/, '')\n        const replacePerson = RegExp('(@|!|#)(' + person + ')')\n        postText = postText.replace(\n          replacePerson,\n          '$1<a href=\"' + postFunction() + '\">$2</a>'\n        )\n      }\n      xpostContent.innerHTML = postText\n\n      // in reply to logic\n      // This has the potential to support a post that replies to many messages.\n      const inReplyTo = kb.each(post, SIOC('reply_of'))\n      const xreplyTo = doc.createElement('span')\n      let theReply\n      for (const reply in inReplyTo) {\n        theReply = String(inReplyTo[reply]).replace(/<|>/g, '')\n        const genReplyTo = function () {\n          const reply = doc.createElement('a')\n          reply.innerHTML = ', <b>in reply to</b>'\n          reply.addEventListener(\n            'click',\n            function () {\n              viewPost([post.uri, theReply])\n              return false\n            },\n            false\n          )\n          return reply\n        }\n        xreplyTo.appendChild(genReplyTo())\n      }\n\n      // END LINK META DATA\n      // add the reply to and delete buttons to the interface\n      const mbReplyTo = function () {\n        const id = mb.getUser(Post.creator).id\n        const xupdateStatus = doc.getElementById('xupdateStatus')\n        const xinReplyToContainer = doc.getElementById('xinReplyToContainer')\n        const xupdateSubmit = doc.getElementById('xupdateSubmit')\n        xupdateStatus.value = '@' + id + ' '\n        xupdateStatus.focus()\n        xinReplyToContainer.value = post.uri\n        xupdateSubmit.value = 'Reply'\n      }\n      let xconfirmDeletionDialog\n      const mbDeletePost = function (evt) {\n        const lsconfirmNo = function () {\n          doc\n            .getElementById('notify-container')\n            .removeChild(xconfirmDeletionDialog)\n          evt.target.disabled = false\n        }\n        const lsconfirmYes = function () {\n          reallyDelete()\n          doc\n            .getElementById('notify-container')\n            .removeChild(xconfirmDeletionDialog)\n        }\n        evt.target.disabled = true\n        xconfirmDeletionDialog = doc.createElement('li')\n        xconfirmDeletionDialog.className = 'notify conf'\n        xconfirmDeletionDialog.innerHTML +=\n          '<p>Are you sure you want to delete this post?</p>'\n        xconfirmDeletionDialog.addEventListener(\n          'keyup',\n          function (evt) {\n            if (evt.keyCode === 27) {\n              lsconfirmNo()\n            }\n          },\n          false\n        )\n        const confirmyes = doc.createElement('input')\n        confirmyes.type = 'button'\n        confirmyes.className = 'confirm'\n        confirmyes.value = 'Delete'\n        confirmyes.addEventListener('click', lsconfirmYes, false)\n        const confirmno = doc.createElement('input')\n        confirmno.type = 'button'\n        confirmno.className = 'confirm'\n        confirmno.value = 'Cancel'\n        confirmno.addEventListener('click', lsconfirmNo, false)\n        xconfirmDeletionDialog.appendChild(confirmno)\n        xconfirmDeletionDialog.appendChild(confirmyes)\n        doc\n          .getElementById('notify-container')\n          .appendChild(xconfirmDeletionDialog)\n        confirmno.focus()\n\n        const reallyDelete = function () {\n          // callback after deletion\n          const mbconfirmDeletePost = function (a, success) {\n            if (success) {\n              that.notify('Post deleted.')\n              // update the ui to reflect model changes.\n              const deleteThisNode = evt.target.parentNode\n              deleteThisNode.parentNode.removeChild(deleteThisNode)\n              kb.removeMany(deleteMe)\n            } else {\n              that.notify('Oops, there was a problem, please try again')\n              evt.target.disabled = true\n            }\n          }\n          // delete references to post\n          const deleteContainerOf = function (a, success) {\n            if (success) {\n              const deleteContainer = kb.statementsMatching(\n                undefined,\n                SIOC('container_of'),\n                kb.sym(\n                  doc\n                    .getElementById('post_' + evt.target.parentNode.id)\n                    .getAttribute('content')\n                )\n              )\n              sparqlUpdater.batch_delete_statement(\n                deleteContainer,\n                mbconfirmDeletePost\n              )\n            } else {\n              that.notify('Oops, there was a problem, please try again')\n              evt.target.disabled = false\n            }\n          }\n          // delete attributes of post\n          evt.target.disabled = true\n          const deleteMe = kb.statementsMatching(\n            kb.sym(\n              doc\n                .getElementById('post_' + evt.target.parentNode.id)\n                .getAttribute('content')\n            )\n          )\n          sparqlUpdater.batch_delete_statement(deleteMe, deleteContainerOf)\n        }\n      }\n      let themaker\n      let xreplyButton\n      let xdeleteButton\n      if (mb.getMyURI()) {\n        // If the microblog in question does not belong to the user,\n        // display the delete post and reply to post buttons.\n        themaker = kb.any(post, SIOC('has_creator'))\n        if (mb.getMyURI() !== themaker.uri) {\n          xreplyButton = doc.createElement('input')\n          xreplyButton.type = 'button'\n          xreplyButton.value = 'reply'\n          xreplyButton.className = 'reply'\n          xreplyButton.addEventListener('click', mbReplyTo, false)\n        } else {\n          xdeleteButton = doc.createElement('input')\n          xdeleteButton.type = 'button'\n          xdeleteButton.value = 'Delete'\n          xdeleteButton.className = 'reply'\n          xdeleteButton.addEventListener('click', mbDeletePost, false)\n        }\n      }\n\n      const mbFavorite = function (evt) {\n        const nid = evt.target.parentNode.id\n        const favpost = doc.getElementById('post_' + nid).getAttribute('content')\n        xfavorite.className += ' ing'\n        const cbFavorite = function (a, success, _c, _d) {\n          if (success) {\n            xfavorite.className =\n              xfavorite.className.split(' ')[1] === 'ed'\n                ? 'favorit'\n                : 'favorit ed'\n          }\n        }\n        if (!myFavorites.favorited(favpost)) {\n          myFavorites.add(favpost, cbFavorite)\n        } else {\n          myFavorites.remove(favpost, cbFavorite)\n        }\n      }\n      const xfavorite = doc.createElement('a')\n      xfavorite.innerHTML = '&#9733;'\n      xfavorite.addEventListener('click', mbFavorite, false)\n      if (myFavorites.favorited(post.uri)) {\n        xfavorite.className = 'favorit ed'\n      } else {\n        xfavorite.className = 'favorit'\n      }\n      // build\n      xpost.appendChild(xuavatar)\n      xpost.appendChild(xpostContent)\n      if (mb.getMyURI()) {\n        xpost.appendChild(xfavorite)\n        if (mb.getMyURI() !== themaker.uri) {\n          xpost.appendChild(xreplyButton)\n        } else {\n          xpost.appendChild(xdeleteButton)\n        }\n      }\n      xpost.appendChild(xuname)\n      xpost.appendChild(xpostLink)\n      if (inReplyTo !== '') {\n        xpost.appendChild(xreplyTo)\n      }\n      return xpost\n    }\n    Pane.prototype.generatePostList = function (gmbPosts) {\n      /*\n      generatePostList - Generate the posts and\n      display their results on the interface.\n      */\n      const postList = doc.createElement('ul')\n      const postlist = {}\n      const datelist = []\n      for (const post in gmbPosts) {\n        const postDate = kb.any(gmbPosts[post], terms('created'))\n        if (postDate) {\n          datelist.push(postDate)\n          postlist[postDate] = this.generatePost(gmbPosts[post], this.thisIsMe)\n        }\n      }\n      datelist.sort().reverse()\n      for (const d in datelist) {\n        postList.appendChild(postlist[datelist[d]])\n      }\n      return postList\n    }\n    Pane.prototype.followsView = function () {\n      const getFollowed = function (user) {\n        let userid = kb.any(user, SIOC('id'))\n        const follow = doc.createElement('li')\n        follow.className = 'follow'\n        userid = userid || user.uri\n        let fol = kb.any(undefined, FOAF('holdsAccount'), user)\n        fol = fol ? fol.uri : user.uri\n        follow.innerHTML = '<a href=\"' + fol + '\">' + userid + '</a>'\n        return follow\n      }\n      const xfollows = doc.createElement('div')\n      xfollows.id = 'xfollows'\n      xfollows.className = 'followlist-container view-container'\n      if (this.creator && kb.whether(this.creator.sym, SIOC('follows'))) {\n        const creatorFollows = kb.each(this.creator.sym, SIOC('follows'))\n        const xfollowsList = doc.createElement('ul')\n        for (const thisPerson in creatorFollows) {\n          xfollowsList.appendChild(getFollowed(creatorFollows[thisPerson]))\n        }\n        xfollows.appendChild(xfollowsList)\n      }\n      this.Tab.create('tab-follows', 'Follows', xfollows, false)\n      return xfollows\n    }\n    Pane.prototype.streamView = function (s, doc) {\n      const postContainer = doc.createElement('div')\n      postContainer.id = 'postContainer'\n      postContainer.className = 'post-container view-container active'\n      let mbPosts = []\n      if (kb.whether(s, FOAF('name')) && kb.whether(s, FOAF('holdsAccount'))) {\n        sf.lookUpThing(kb.any(s, FOAF('holdsAccount')))\n        const follows = kb.each(kb.any(s, FOAF('holdsAccount')), SIOC('follows'))\n        for (const f in follows) {\n          sf.lookUpThing(follows[f])\n          // look up people user follows\n          const smicroblogs = kb.each(follows[f], SIOC('creator_of'))\n          // get the follows microblogs\n          for (const smb in smicroblogs) {\n            sf.lookUpThing(smicroblogs[smb])\n            if (kb.whether(smicroblogs[smb], SIOC('topic'), follows[f])) {\n              continue\n            } else {\n              mbPosts = mbPosts.concat(\n                kb.each(smicroblogs[smb], SIOC('container_of'))\n              )\n            }\n          }\n        }\n      }\n      if (mbPosts.length > 0) {\n        const postList = this.generatePostList(mbPosts)\n        // generate stream\n        postList.id = 'postList'\n        postList.className = 'postList'\n        postContainer.appendChild(postList)\n      }\n      this.Tab.create('tab-stream', 'By Follows', postContainer, true)\n      return postContainer\n    }\n    Pane.prototype.notificationsView = function (s, doc) {\n      const postNotificationContainer = doc.createElement('div')\n      postNotificationContainer.id = 'postNotificationContainer'\n      postNotificationContainer.className =\n        'notification-container view-container'\n      const postMentionContainer = doc.createElement('div')\n      postMentionContainer.id = 'postMentionContainer'\n      postMentionContainer.className = 'mention-container view-container'\n      let mbnPosts = []\n      let mbmPosts = []\n      // get mbs that I am the creator of.\n      const theUser = kb.any(s, FOAF('holdsAccount'))\n      const user = kb.any(theUser, SIOC('id'))\n      const microblogs = kb.each(theUser, SIOC('creator_of'))\n      for (const mbm in microblogs) {\n        sf.lookUpThing(microblogs[mbm])\n        if (kb.whether(microblogs[mbm], SIOC('topic'), theUser)) {\n          mbmPosts = mbmPosts.concat(\n            kb.each(microblogs[mbm], SIOC('container_of'))\n          )\n        } else {\n          if (kb.whether(microblogs[mbm], RDF('type'), SIOCt('Microblog'))) {\n            mbnPosts = mbnPosts.concat(\n              kb.each(microblogs[mbm], SIOC('container_of'))\n            )\n          }\n        }\n      }\n      const postNotificationList = this.generatePostList(mbnPosts)\n      postNotificationList.id = 'postNotificationList'\n      postNotificationList.className = 'postList'\n      postNotificationContainer.appendChild(postNotificationList)\n\n      const postMentionList = this.generatePostList(mbmPosts)\n      postMentionList.id = 'postMentionList'\n      postMentionList.className = 'postList'\n      postMentionContainer.appendChild(postMentionList)\n      this.postMentionContainer = postMentionContainer\n      this.postNotificationContainer = postNotificationContainer\n      this.Tab.create(\n        'tab-by-user',\n        'By ' + user,\n        postNotificationContainer,\n        false\n      )\n      this.Tab.create('tab-at-user', '@' + user, postMentionContainer, false)\n    }\n    Pane.prototype.build = function () {\n      const microblogPane = this.microblogPane\n      this.headerContainer = this.header(s, doc)\n      this.postContainer = this.streamView(s, doc)\n      this.notificationsView(s, doc)\n      this.xfollows = this.followsView()\n      microblogPane.className = 'ppane'\n      microblogPane.appendChild(this.xviewReply)\n      microblogPane.appendChild(this.xnotify)\n      microblogPane.appendChild(this.headerContainer)\n      if (this.xfollows !== undefined) {\n        microblogPane.appendChild(this.xfollows)\n      }\n      microblogPane.appendChild(this.postContainer)\n      microblogPane.appendChild(this.postNotificationContainer)\n      microblogPane.appendChild(this.postMentionContainer)\n    }\n\n    const microblogpane = doc.createElement('div')\n    //      var getusersfollows = function(uri){\n    //          var follows = new Object();\n    //          var followsa = {follows:0, matches:0};\n    //          var accounts = kb.each(s, FOAF(\"holdsAccount\"));\n    //          //get all of the accounts that a person holds\n    //          for (var acct in accounts){\n    //              var account  = accounts[acct].uri;\n    //              var act = kb.each(kb.sym(account),SIOC(\"follows\"));\n    //              for (var a in act){\n    //                  var thisuri = act[a].uri.split(\"#\")[0];\n    //                  if (!follows[thisuri]){followsa.follows+=1;}\n    //                  follows[thisuri] =true;\n    //              }\n    //          }\n    //\n    //          var buildPaneUI = function(uri){\n    //              followsa.matches = (follows[uri]) ? followsa.matches+1: followsa.matches;\n    //              console.log(follows.toSource());\n    //              if(followsa.follows == followsa.matches ){\n    const ppane = new Pane(s, doc, microblogpane)\n    ppane.build()\n    //                  return false;\n    //              }\n    //              else{\n    //                  return true;\n    //              }\n    //          }\n    //          sf.addCallback('done',buildPaneUI);\n    //          sf.addCallback('fail',buildPaneUI);\n    //          //fetch each of the followers\n    //          for (var f in follows){\n    //              sf.refresh(kb.sym(f));\n    //          }\n    //      }(s);\n    return microblogpane\n  }\n}\n"],"mappings":"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","ignoreList":[]}