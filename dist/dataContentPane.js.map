{"version":3,"file":"dataContentPane.js","names":["UI","_interopRequireWildcard","require","$rdf","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","ns","dataContentPane","exports","icon","icons","originalIconBase","name","audience","solid","label","subject","context","session","store","findTypeURIs","statementsMatching","undefined","length","statementsAsTables","sts","initialRoots","myDocument","dom","rep","createElement","sz","Serializer","res","rootSubjects","roots","subjects","loopBreakers","x","console","log","doneBnodes","referencedBnodes","propertyTree","lastPred","toStr","appendChild","createTextNode","sort","same","predicateTD","st","tr","predicate","uri","setAttribute","anchor","addEventListener","widgets","openHrefInOutlineMode","utils","predicateLabelForXML","objectTD","objectTree","object","obj","termType","datatype","textContent","value","innerHTML","toNT","slice","newTable","ancestor","style","backgroundColor","elements","paneRegistry","byName","statements","Error","concat","filter","sameTerm","subjectTD","TDTree","root","bNT","table","insertBefore","firstChild","render","alternativeRendering","p","s2","div","plist","kb","outliner","appendPropertyTRs","_pred","_inverse","verticalAlign","td","outlineObjectTD","outlineExpand","pane","mainRendering","holds","push","ps","any","foaf","getOutliner"],"sources":["../src/dataContentPane.js"],"sourcesContent":["/*      Data content Pane\n **\n **  This pane shows the content of a particular RDF resource\n ** or at least the RDF semantics we attribute to that resource.\n */\n\n// To do:  - Only take data from one graph\n//         - Only do forwards not backward?\n//         - Expand automatically all the way down\n//         - original source view?  Use ffox view source\n\nimport * as UI from 'solid-ui-jss'\nimport * as $rdf from 'rdflib'\n\nconst ns = UI.ns\n\nexport const dataContentPane = {\n  icon: UI.icons.originalIconBase + 'rdf_flyer.24.gif',\n\n  name: 'dataContents',\n\n  audience: [ns.solid('Developer')],\n\n  label: function (subject, context) {\n    if (\n      'http://www.w3.org/2007/ont/link#ProtocolEvent' in\n      context.session.store.findTypeURIs(subject)\n    ) {\n      return null\n    }\n    const n = context.session.store.statementsMatching(\n      undefined,\n      undefined,\n      undefined,\n      subject\n    ).length\n    if (n === 0) return null\n    return 'Data (' + n + ')'\n  },\n  /*\n  shouldGetFocus: function(subject) {\n      return store.whether(subject, UI.ns.rdf('type'), UI.ns.link('RDFDocument'))\n  },\n*/\n  statementsAsTables: function statementsAsTables (sts, context, initialRoots) {\n    const myDocument = context.dom\n    // const outliner = context.getOutliner(myDocument)\n    const rep = myDocument.createElement('table')\n    const sz = $rdf.Serializer(context.session.store)\n    const res = sz.rootSubjects(sts)\n    let roots = res.roots\n    const subjects = res.subjects\n    const loopBreakers = res.loopBreakers\n    for (const x in loopBreakers) {\n      console.log('\\tdataContentPane: loopbreaker:' + x)\n    }\n    const doneBnodes = {} // For preventing looping\n    const referencedBnodes = {} // Bnodes which need to be named alas\n\n    // The property tree for a single subject or anonymous node\n    function propertyTree (subject) {\n      // print('Proprty tree for '+subject)\n      const rep = myDocument.createElement('table')\n      let lastPred = null\n      const sts = subjects[sz.toStr(subject)] // relevant statements\n      if (!sts) {\n        // No statements in tree\n        rep.appendChild(myDocument.createTextNode('...')) // just empty bnode as object\n        return rep\n      }\n      sts.sort()\n      let same = 0\n      let predicateTD // The cell which holds the predicate\n      for (let i = 0; i < sts.length; i++) {\n        const st = sts[i]\n        const tr = myDocument.createElement('tr')\n        if (st.predicate.uri !== lastPred) {\n          if (lastPred && same > 1) {\n            predicateTD.setAttribute('rowspan', '' + same)\n          }\n          predicateTD = myDocument.createElement('td')\n          predicateTD.setAttribute('class', 'pred')\n          const anchor = myDocument.createElement('a')\n          anchor.setAttribute('href', st.predicate.uri)\n          anchor.addEventListener(\n            'click',\n            UI.widgets.openHrefInOutlineMode,\n            true\n          )\n          anchor.appendChild(\n            myDocument.createTextNode(\n              UI.utils.predicateLabelForXML(st.predicate)\n            )\n          )\n          predicateTD.appendChild(anchor)\n          tr.appendChild(predicateTD)\n          lastPred = st.predicate.uri\n          same = 0\n        }\n        same++\n        const objectTD = myDocument.createElement('td')\n        objectTD.appendChild(objectTree(st.object))\n        tr.appendChild(objectTD)\n        rep.appendChild(tr)\n      }\n      if (lastPred && same > 1) predicateTD.setAttribute('rowspan', '' + same)\n      return rep\n    }\n\n    // Convert a set of statements into a nested tree of tables\n    function objectTree (obj) {\n      let res, anchor\n      switch (obj.termType) {\n        case 'NamedNode':\n          anchor = myDocument.createElement('a')\n          anchor.setAttribute('href', obj.uri)\n          anchor.addEventListener(\n            'click',\n            UI.widgets.openHrefInOutlineMode,\n            true\n          )\n          anchor.appendChild(myDocument.createTextNode(UI.utils.label(obj)))\n          return anchor\n\n        case 'Literal':\n          if (!obj.datatype || !obj.datatype.uri) {\n            res = myDocument.createElement('div')\n            res.setAttribute('style', 'white-space: pre-wrap;')\n            res.textContent = obj.value\n            return res\n          } else if (\n            obj.datatype.uri ===\n            'http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral'\n          ) {\n            res = myDocument.createElement('div')\n            res.setAttribute('class', 'embeddedXHTML')\n            res.innerHTML = obj.value // Try that  @@@ beware embedded dangerous code\n            return res\n          }\n          return myDocument.createTextNode(obj.value) // placeholder - could be smarter,\n\n        case 'BlankNode': {\n          if (obj.toNT() in doneBnodes) {\n            // Break infinite recursion\n            referencedBnodes[obj.toNT()] = true\n            const anchor = myDocument.createElement('a')\n            anchor.setAttribute('href', '#' + obj.toNT().slice(2))\n            anchor.setAttribute('class', 'bnodeRef')\n            anchor.textContent = '*' + obj.toNT().slice(3)\n            return anchor\n          }\n          doneBnodes[obj.toNT()] = true // Flag to prevent infinite recursion in propertyTree\n          const newTable = propertyTree(obj)\n          doneBnodes[obj.toNT()] = newTable // Track where we mentioned it first\n          if (\n            UI.utils.ancestor(newTable, 'TABLE') &&\n            UI.utils.ancestor(newTable, 'TABLE').style.backgroundColor ===\n            'white'\n          ) {\n            newTable.style.backgroundColor = '#eee'\n          } else {\n            newTable.style.backgroundColor = 'white'\n          }\n          return newTable\n        }\n        case 'Collection':\n          res = myDocument.createElement('table')\n          res.setAttribute('class', 'collectionAsTables')\n          for (let i = 0; i < obj.elements.length; i++) {\n            const tr = myDocument.createElement('tr')\n            res.appendChild(tr)\n            tr.appendChild(objectTree(obj.elements[i]))\n          }\n          return res\n        case 'Graph':\n          res = context.session.paneRegistry\n            .byName('dataContents')\n            .statementsAsTables(obj.statements, context)\n          res.setAttribute('class', 'nestedFormula')\n          return res\n        case 'Variable':\n          res = myDocument.createTextNode('?' + obj.uri)\n          return res\n      }\n      throw new Error('Unhandled node type: ' + obj.termType)\n    }\n\n    // roots.sort()\n\n    if (initialRoots) {\n      roots = initialRoots.concat(\n        roots.filter(function (x) {\n          for (let i = 0; i < initialRoots.length; i++) {\n            // Max 2\n            if (x.sameTerm(initialRoots[i])) return false\n          }\n          return true\n        })\n      )\n    }\n    for (let i = 0; i < roots.length; i++) {\n      const tr = myDocument.createElement('tr')\n      tr.setAttribute('style', `background-color: ${i % 2 === 0 ? '#f0f0f0' : 'white'};`)\n      rep.appendChild(tr)\n      const subjectTD = myDocument.createElement('td')\n      tr.appendChild(subjectTD)\n      const TDTree = myDocument.createElement('td')\n      tr.appendChild(TDTree)\n      const root = roots[i]\n      if (root.termType === 'BlankNode') {\n        subjectTD.appendChild(myDocument.createTextNode(UI.utils.label(root))) // Don't recurse!\n      } else {\n        subjectTD.appendChild(objectTree(root)) // won't have tree\n      }\n      TDTree.appendChild(propertyTree(root))\n    }\n    for (const bNT in referencedBnodes) {\n      // Add number to refer to\n      const table = doneBnodes[bNT]\n      // let tr = myDocument.createElement('tr')\n      const anchor = myDocument.createElement('a')\n      anchor.setAttribute('id', bNT.slice(2))\n      anchor.setAttribute('class', 'bnodeDef')\n      anchor.textContent = bNT.slice(3) + ')'\n      table.insertBefore(anchor, table.firstChild)\n    }\n    return rep\n  }, // statementsAsTables\n  // View the data in a file in user-friendly way\n  render: function (subject, context) {\n    const myDocument = context.dom\n\n    function alternativeRendering () {\n      const sz = $rdf.Serializer(context.session.store)\n      const res = sz.rootSubjects(sts)\n      const roots = res.roots\n      const p = {}\n      p.render = function (s2) {\n        const div = myDocument.createElement('div')\n        div.setAttribute('class', 'withinDocumentPane')\n        const plist = kb.statementsMatching(s2, undefined, undefined, subject)\n        outliner.appendPropertyTRs(div, plist, false, function (\n          _pred,\n          _inverse\n        ) {\n          return true\n        })\n        return div\n      }\n      for (let i = 0; i < roots.length; i++) {\n        const tr = myDocument.createElement('TR')\n        const root = roots[i]\n        tr.style.verticalAlign = 'top'\n        const td = outliner.outlineObjectTD(root, undefined, tr)\n        tr.appendChild(td)\n        div.appendChild(tr)\n        outliner.outlineExpand(td, root, { pane: p })\n      }\n    }\n\n    function mainRendering () {\n      const initialRoots = [] // Ordering: start with stuff about this doc\n      if (kb.holds(subject, undefined, undefined, subject)) {\n        initialRoots.push(subject)\n      }\n      // Then about the primary topic of the document if any\n      const ps = kb.any(subject, UI.ns.foaf('primaryTopic'), undefined, subject)\n      if (ps) initialRoots.push(ps)\n      div.appendChild(\n        context.session.paneRegistry\n          .byName('dataContents')\n          .statementsAsTables(sts, context, initialRoots)\n      )\n    }\n\n    const outliner = context.getOutliner(myDocument)\n    const kb = context.session.store\n    const div = myDocument.createElement('div')\n    div.setAttribute('class', 'dataContentPane')\n    // Because of smushing etc, this will not be a copy of the original source\n    // We could instead either fetch and re-parse the source,\n    // or we could keep all the pre-smushed triples.\n    const sts = kb.statementsMatching(undefined, undefined, undefined, subject) // @@ slow with current store!\n\n    // eslint-disable-next-line no-constant-condition\n    if (false) { // keep code\n      alternativeRendering()\n    } else {\n      mainRendering()\n    }\n    return div\n  }\n}\n"],"mappings":"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","ignoreList":[]}